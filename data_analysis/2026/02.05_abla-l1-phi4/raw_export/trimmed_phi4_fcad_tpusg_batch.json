{
  "data": [
    {
      "id": "f74bd75e",
      "timestamp": "2026-02-03T12:11:06.690000+00:00",
      "name": "f74b_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\nfrom PIL import Image\nimport pycoral.utils.dataset\nfrom pycoral.adapters import common\nfrom pycoral.adapters import detect\nfrom pycoral.utils.edgetpu import make_interpreter\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    label_map = [line.strip() for line in f.readlines()]\n\n# Initialize Edge TPU interpreter\ninterpreter = make_interpreter(model_path)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n_, input_height, input_width, _ = input_details[0]['shape']\n\n# Open video files\ncap = cv2.VideoCapture(input_path)\nwidth = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nheight = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (width, height))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Prepare input image\n    img = Image.fromarray(frame)\n    _, scale_metrics = detect_image.common.set_input(\n        interpreter, img, \n        common.InputSize(input_width, input_height))\n    \n    # Run inference\n    interpreter.invoke()\n\n    # Process output and draw boxes on the frame\n    objs = detect.get_objects(interpreter,\n                             score_threshold=confidence_threshold,\n                             image_scale=scale_metrics)\n    for obj in objs:\n        bbox = obj.bbox.tolist()\n        bbox[0] *= width\n        bbox[1] *= height\n        bbox[2] *= width\n        bbox[3] *= height\n\n        # Draw bounding box and label\n        cv2.rectangle(frame, (int(bbox[0]), int(bbox[1])), \n                      (int(bbox[2]), int(bbox[3])), (10, 255, 0), 2)\n        \n        class_id = obj.id\n        score = obj.score\n        label = f'{label_map[class_id]}: {score:.2f}'\n        cv2.putText(frame, label, (int(bbox[0]), int(bbox[1] - 5)), \n                    cv2.FONT_HERSHEY_SIMPLEX, 0.7, (10, 255, 0), 2)\n\n    # Write the frame with bounding boxes\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_daece509_1770120778.py\", line 45, in <module>\n    _, scale_metrics = detect_image.common.set_input(\nNameError: name 'detect_image' is not defined."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 30
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 119.782,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-14-11-06-692270_chatcmpl-08ed5475-6d19-4470-a4e8-4a049806cc8e",
          "traceId": "f74bd75e",
          "type": "GENERATION",
          "name": "f74b_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T12:11:06.692000+00:00",
          "endTime": "2026-02-03T12:11:25.587000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 18895.0,
          "completionTokens": 911,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1072,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-11-34-037422_chatcmpl-42e3225b-b43c-4339-b7b5-8fad05eb9b5d",
          "traceId": "f74bd75e",
          "type": "GENERATION",
          "name": "f74b_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T12:11:34.037000+00:00",
          "endTime": "2026-02-03T12:11:47.876000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13839.0,
          "completionTokens": 674,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 835,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-11-55-670241_chatcmpl-d35e274a-bdda-42a4-9b73-900ab142cdd4",
          "traceId": "f74bd75e",
          "type": "GENERATION",
          "name": "f74b_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T12:11:55.670000+00:00",
          "endTime": "2026-02-03T12:12:11.714000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16044.0,
          "completionTokens": 780,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 941,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-12-19-488072_chatcmpl-04c0e133-142b-44f4-8e7a-49a325913c84",
          "traceId": "f74bd75e",
          "type": "GENERATION",
          "name": "f74b_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T12:12:19.488000+00:00",
          "endTime": "2026-02-03T12:12:36.033000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16545.0,
          "completionTokens": 804,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 965,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-12-43-762673_chatcmpl-0c956a7b-afe7-4bf2-bb4b-f8893e6b1522",
          "traceId": "f74bd75e",
          "type": "GENERATION",
          "name": "f74b_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T12:12:43.762000+00:00",
          "endTime": "2026-02-03T12:12:58.144000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14382.0,
          "completionTokens": 699,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 860,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "1d6382aa-f62a-444d-baa4-f37a0687f58f",
          "traceId": "f74bd75e",
          "type": "SPAN",
          "name": "error_f7_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T12:13:06.474000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_daece509_1770120778.py\", line 45, in <module>\n    _, scale_metrics = detect_image.common.set_input(\nNameError: name 'detect_image' is not defined.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T12:13:11.906Z",
      "environment": "default",
      "createdAt": "2026-02-03T12:11:07.211Z"
    },
    {
      "id": "cb4eefb5",
      "timestamp": "2026-02-03T12:08:45.341000+00:00",
      "name": "cb4e_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\nimport numpy as np\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize TFLite interpreter with Coral Edge TPU delegate\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Get input image size\n_, input_height, input_width, _ = input_details[0]['shape']\n\ndef set_input_tensor(image):\n    \"\"\"Sets the input tensor.\"\"\"\n    image = cv2.resize(image, (input_width, input_height))\n    image = np.expand_dims(image, axis=0)\n    interpreter.set_tensor(input_details[0]['index'], image)\n\ndef get_output():\n    \"\"\"Returns the detection results.\"\"\"\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\n# Open video input and output streams\ncap = cv2.VideoCapture(input_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    \n    if not ret:\n        break\n\n    set_input_tensor(frame)\n\n    interpreter.invoke()\n\n    boxes, classes, scores = get_output()\n\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            # Get bounding box coordinates\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n\n            # Draw rectangle and label on the frame\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (255, 0, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 0, 0), 2)\n\n    out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 29
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 62.885,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-14-08-45-342453_chatcmpl-a9fec1c5-e553-41f6-8b0e-5fbddf24fcac",
          "traceId": "cb4eefb5",
          "type": "GENERATION",
          "name": "cb4e_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T12:08:45.342000+00:00",
          "endTime": "2026-02-03T12:09:01.470000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16128.0,
          "completionTokens": 784,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 945,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-09-09-655861_chatcmpl-5bf4ec40-142b-4eea-b08f-8c9dbcab1237",
          "traceId": "cb4eefb5",
          "type": "GENERATION",
          "name": "cb4e_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T12:09:09.655000+00:00",
          "endTime": "2026-02-03T12:09:26.515000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16860.0,
          "completionTokens": 817,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 978,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-09-34-291676_chatcmpl-c8028a0c-3097-4e67-8603-d0a6a3268d9e",
          "traceId": "cb4eefb5",
          "type": "GENERATION",
          "name": "cb4e_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T12:09:34.291000+00:00",
          "endTime": "2026-02-03T12:09:48.227000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13936.0,
          "completionTokens": 681,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 842,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T12:10:46.076Z",
      "environment": "default",
      "createdAt": "2026-02-03T12:08:45.864Z"
    },
    {
      "id": "3f4a7455",
      "timestamp": "2026-02-03T12:06:13.743000+00:00",
      "name": "3f4a_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\nfrom PIL import Image\nimport argparse\n\n# Constants\nMODEL_PATH = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nLABEL_PATH = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\nINPUT_PATH = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\nOUTPUT_PATH = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nCONFIDENCE_THRESHOLD = 0.5\n\n# Load labels\nwith open(LABEL_PATH, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize the TFLite interpreter\ninterpreter = Interpreter(\n    model_path=MODEL_PATH,\n    experimental_delegates=[load_delegate('libedgetpu.so.1.0')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Video capture and output setup\ncap = cv2.VideoCapture(INPUT_PATH)\nwidth, height = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH)), int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = int(cap.get(cv2.CAP_PROP_FPS))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(OUTPUT_PATH, fourcc, fps, (width, height))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    img_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\n    pil_image = Image.fromarray(img_rgb)\n\n    resized_image = pil_image.resize((input_details[0]['shape'][2], input_details[0]['shape'][1]), Image.ANTIALIAS)\n    input_data = np.expand_dims(resized_image.flatten(), axis=0)\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Retrieve output data\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    # Draw bounding boxes and labels on the frame\n    for i in range(len(scores)):\n        if scores[i] >= CONFIDENCE_THRESHOLD:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width, ymin * height, ymax * height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 1)\n\n    # Write the frame with detections to output video\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_be8b3953_1770120491.py\", line 21, in <module>\n    experimental_delegates=[load_delegate('libedgetpu.so.1.0')]\nNameError: name 'load_delegate' is not defined."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 28
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 125.479,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-14-06-13-744473_chatcmpl-05c906da-912d-419e-970b-f6c64d126139",
          "traceId": "3f4a7455",
          "type": "GENERATION",
          "name": "3f4a_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T12:06:13.744000+00:00",
          "endTime": "2026-02-03T12:06:28.731000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14987.0,
          "completionTokens": 720,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 881,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-06-36-669211_chatcmpl-09e60dd0-b9c4-4bb8-b7c9-99594117d462",
          "traceId": "3f4a7455",
          "type": "GENERATION",
          "name": "3f4a_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T12:06:36.669000+00:00",
          "endTime": "2026-02-03T12:06:51.717000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15048.0,
          "completionTokens": 734,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 895,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-06-59-421349_chatcmpl-8fb56066-5c24-49ab-9c91-152fdd66011f",
          "traceId": "3f4a7455",
          "type": "GENERATION",
          "name": "3f4a_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T12:06:59.421000+00:00",
          "endTime": "2026-02-03T12:07:18.464000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 19043.0,
          "completionTokens": 929,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1090,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-07-26-632006_chatcmpl-bc9af19c-958d-43f8-ac85-c6ee1171b1e0",
          "traceId": "3f4a7455",
          "type": "GENERATION",
          "name": "3f4a_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T12:07:26.632000+00:00",
          "endTime": "2026-02-03T12:07:48.330000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 21698.0,
          "completionTokens": 1053,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1214,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-07-56-088199_chatcmpl-0d968b3a-cb52-4b67-8f30-828c8b8eee29",
          "traceId": "3f4a7455",
          "type": "GENERATION",
          "name": "3f4a_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T12:07:56.088000+00:00",
          "endTime": "2026-02-03T12:08:11.441000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15353.0,
          "completionTokens": 744,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 905,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "9ae73284-0550-4831-9db2-d9bf45036519",
          "traceId": "3f4a7455",
          "type": "SPAN",
          "name": "error_3f_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T12:08:19.223000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_be8b3953_1770120491.py\", line 21, in <module>\n    experimental_delegates=[load_delegate('libedgetpu.so.1.0')]\nNameError: name 'load_delegate' is not defined.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T12:08:24.476Z",
      "environment": "default",
      "createdAt": "2026-02-03T12:06:14.266Z"
    },
    {
      "id": "5cc0d0d2",
      "timestamp": "2026-02-03T12:03:38.496000+00:00",
      "name": "5cc0_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport argparse\nfrom tflite_runtime.interpreter import Interpreter\n\ndef load_labels(path):\n    with open(path, 'r') as f:\n        return [line.strip() for line in f.readlines()]\n\ndef set_input_tensor(interpreter, image):\n    tensor_index = interpreter.get_input_details()[0]['index']\n    input_shape = interpreter.get_input_details()[0]['shape']\n    image = cv2.resize(image, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(image, axis=0)\n    interpreter.set_tensor(tensor_index, input_data)\n\ndef get_output(interpreter):\n    boxes = interpreter.get_tensor(interpreter.get_output_details()[0]['index'])[0]\n    classes = interpreter.get_tensor(interpreter.get_output_details()[1]['index'])[0]\n    scores = interpreter.get_tensor(interpreter.get_output_details()[2]['index'])[0]\n    return boxes, classes, scores\n\ndef draw_objects(image, boxes, class_ids, scores, labels):\n    height, width, _ = image.shape\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            left, right, top, bottom = (xmin * width), (xmax * width), (ymin * height), (ymax * height)\n            cv2.rectangle(image, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            class_id = int(class_ids[i])\n            label = f'{labels[class_id]}: {scores[i]:.2f}'\n            cv2.putText(image, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 255, 255), 2)\n    return image\n\ndef main():\n    model_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\n    label_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\n    input_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\n    output_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\n    confidence_threshold = 0.5\n\n    labels = load_labels(label_path)\n    \n    interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1')])\n    interpreter.allocate_tensors()\n    \n    cap = cv2.VideoCapture(input_path)\n    out = None\n    while cap.isOpened():\n        ret, frame = cap.read()\n        if not ret:\n            break\n\n        set_input_tensor(interpreter, frame)\n        interpreter.invoke()\n\n        boxes, classes, scores = get_output(interpreter)\n\n        frame_with_detections = draw_objects(frame, boxes, classes, scores, labels)\n\n        if out is None:\n            fourcc = cv2.VideoWriter_fourcc(*'mp4v')\n            out = cv2.VideoWriter(output_path, fourcc, 30.0, (frame.shape[1], frame.shape[0]))\n\n        out.write(frame_with_detections)\n    \n    cap.release()\n    out.release()\n\nif __name__ == '__main__':\n    main()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_50b9760b_1770120339.py\", line 71, in <module>\n    main()\n  File \"script_50b9760b_1770120339.py\", line 44, in main\n    interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1')])\nNameError: name 'load_delegate' is not defined."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 27
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 129.233,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-14-03-38-497975_chatcmpl-5a155e51-a484-4c66-847e-3b232850e352",
          "traceId": "5cc0d0d2",
          "type": "GENERATION",
          "name": "5cc0_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T12:03:38.497000+00:00",
          "endTime": "2026-02-03T12:03:54.139000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15642.0,
          "completionTokens": 757,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 918,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-04-01-910732_chatcmpl-b461dfb6-cc8e-46fb-bd50-f0d76eb7eeb9",
          "traceId": "5cc0d0d2",
          "type": "GENERATION",
          "name": "5cc0_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T12:04:01.910000+00:00",
          "endTime": "2026-02-03T12:04:16.796000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14886.0,
          "completionTokens": 727,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 888,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-04-24-598666_chatcmpl-99369129-6044-4a39-ac96-9cd29de1aef1",
          "traceId": "5cc0d0d2",
          "type": "GENERATION",
          "name": "5cc0_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T12:04:24.598000+00:00",
          "endTime": "2026-02-03T12:04:46.320000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 21722.0,
          "completionTokens": 1051,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1212,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-04-54-080195_chatcmpl-5ce31c0e-670e-46d5-9789-e1a90b39efde",
          "traceId": "5cc0d0d2",
          "type": "GENERATION",
          "name": "5cc0_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T12:04:54.080000+00:00",
          "endTime": "2026-02-03T12:05:17.671000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 23591.0,
          "completionTokens": 1135,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1296,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-05-25-434701_chatcmpl-f0173a7d-5816-4851-b952-0367d130075f",
          "traceId": "5cc0d0d2",
          "type": "GENERATION",
          "name": "5cc0_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T12:05:25.434000+00:00",
          "endTime": "2026-02-03T12:05:39.716000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14282.0,
          "completionTokens": 684,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 845,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "18cd9952-8a82-4752-b102-0eec2c8d407f",
          "traceId": "5cc0d0d2",
          "type": "SPAN",
          "name": "error_5c_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T12:05:47.730000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_50b9760b_1770120339.py\", line 71, in <module>\n    main()\n  File \"script_50b9760b_1770120339.py\", line 44, in main\n    interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1')])\nNameError: name 'load_delegate' is not defined.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T12:05:53.233Z",
      "environment": "default",
      "createdAt": "2026-02-03T12:03:39.019Z"
    },
    {
      "id": "7eff6e83",
      "timestamp": "2026-02-03T12:00:59.977000+00:00",
      "name": "7eff_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize Coral Edge TPU interpreter\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1.0')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\n\n# Open video files\ncap = cv2.VideoCapture(input_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(input_data, axis=0)\n\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence\n\n    height, width, _ = frame.shape\n\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width,\n                                          ymin * height, ymax * height)\n\n            # Draw bounding box and label\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)),\n                          (0, 255, 0), 2)\n            text = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, text, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 1)\n\n    out.write(frame)\n    cv2.imshow('Object Detection', frame)\n    \n    if cv2.waitKey(1) & 0xFF == ord('q'):\n        break\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 26
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 79.696,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-14-00-59-978863_chatcmpl-b50cb491-3876-4660-9bda-d5ca9ad5c6cb",
          "traceId": "7eff6e83",
          "type": "GENERATION",
          "name": "7eff_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T12:00:59.978000+00:00",
          "endTime": "2026-02-03T12:01:13.426000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13448.0,
          "completionTokens": 638,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 799,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-01-21-237196_chatcmpl-eb7dd977-f7c6-47b0-865b-d9f929831beb",
          "traceId": "7eff6e83",
          "type": "GENERATION",
          "name": "7eff_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T12:01:21.237000+00:00",
          "endTime": "2026-02-03T12:01:35.811000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14574.0,
          "completionTokens": 709,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 870,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-01-44-309012_chatcmpl-fcb98207-d13b-4d92-960b-e1712c1abac4",
          "traceId": "7eff6e83",
          "type": "GENERATION",
          "name": "7eff_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T12:01:44.309000+00:00",
          "endTime": "2026-02-03T12:01:58.701000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14392.0,
          "completionTokens": 703,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 864,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-14-02-06-468122_chatcmpl-643f9ec4-f2ca-4702-95ca-fb02e928d57a",
          "traceId": "7eff6e83",
          "type": "GENERATION",
          "name": "7eff_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T12:02:06.468000+00:00",
          "endTime": "2026-02-03T12:02:19.674000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13206.0,
          "completionTokens": 646,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 807,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T12:03:18.176Z",
      "environment": "default",
      "createdAt": "2026-02-03T12:01:00.500Z"
    },
    {
      "id": "0372a7e8",
      "timestamp": "2026-02-03T11:59:22.599000+00:00",
      "name": "0372_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nimport numpy as np\nimport tflite_runtime.interpreter as tflite\nfrom PIL import Image\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize TFLite interpreter with EdgeTPU delegate\ninterpreter = tflite.Interpreter(\n    model_path=model_path,\n    experimental_delegates=[\n        tflite.load_delegate('libedgetpu.so.1')\n    ]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Get input size\ninput_shape = input_details[0]['shape']\ninput_height, input_width = input_shape[1], input_shape[2]\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    img_resized = cv2.resize(frame, (input_width, input_height))\n    img_rgb = cv2.cvtColor(img_resized, cv2.COLOR_BGR2RGB)\n    pil_img = Image.fromarray(img_rgb)\n    input_data = np.expand_dims(pil_img, axis=0).astype(np.uint8)\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]   # Confidence of detected objects\n\n    # Draw bounding boxes and labels on the frame\n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * cap.get(3), xmax * cap.get(3),\n                                          ymin * cap.get(4), ymax * cap.get(4))\n            \n            # Draw rectangle and label\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            object_name = labels[int(classes[i])]\n            label = f'{object_name}: {scores[i]:.2f}'\n            label_size, base_line = cv2.getTextSize(label, cv2.FONT_HERSHEY_SIMPLEX, 0.7, 2)\n            top = max(top, label_size[1])\n            cv2.rectangle(frame, (int(left), int(top - label_size[1])), \n                          (int(left + label_size[0]), int(top + base_line)), \n                          (255, 255, 255), cv2.FILLED)\n            cv2.putText(frame, label, (int(left), int(top)), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (0, 0, 0), 2)\n\n    # Write the frame with detections\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 25
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 18.508,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-59-22-601177_chatcmpl-fb074092-72af-426f-84a2-cdf9989cf9c0",
          "traceId": "0372a7e8",
          "type": "GENERATION",
          "name": "0372_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:59:22.601000+00:00",
          "endTime": "2026-02-03T11:59:41.109000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 18508.0,
          "completionTokens": 854,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1015,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T12:00:39.295Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:59:23.120Z"
    },
    {
      "id": "3a79ad28",
      "timestamp": "2026-02-03T11:56:36.996000+00:00",
      "name": "3a79_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nimport numpy as np\nimport tflite_runtime.interpreter as tflite\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Initialize the TFLite interpreter\ninterpreter = tflite.Interpreter(model_path=model_path, experimental_delegates=[tflite.load_delegate('libedgetpu.so.1')])\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\nheight = input_details[0]['shape'][1]\nwidth = input_details[0]['shape'][2]\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Open video files\ninput_video = cv2.VideoCapture(input_path)\noutput_video = cv2.VideoWriter(output_path, cv2.VideoWriter_fourcc(*'mp4v'), 30, (int(input_video.get(cv2.CAP_PROP_FRAME_WIDTH)), int(input_video.get(cv2.CAP_PROP_FRAME_HEIGHT))))\n\nwhile input_video.isOpened():\n    ret, frame = input_video.read()\n    \n    if not ret:\n        break\n    \n    # Preprocess the image\n    frame_resized = cv2.resize(frame, (width, height))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.uint8)\n    \n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n    \n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence score\n    \n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            \n            # Draw bounding box\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            \n            # Label\n            label = f'{labels[int(classes[i])]}: {int(scores[i] * 100)}%'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 255, 255), 2)\n    \n    # Write the frame with detections\n    output_video.write(frame)\n\n# Release resources\ninput_video.release()\noutput_video.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 24
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 87.109,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-56-36-997336_chatcmpl-d335b994-de79-4c97-92d9-e21c3e88b731",
          "traceId": "3a79ad28",
          "type": "GENERATION",
          "name": "3a79_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:56:36.997000+00:00",
          "endTime": "2026-02-03T11:56:53.302000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16305.0,
          "completionTokens": 793,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 954,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-57-01-212666_chatcmpl-373598a4-5c08-4513-a0d4-d234f8a1c9b7",
          "traceId": "3a79ad28",
          "type": "GENERATION",
          "name": "3a79_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:57:01.212000+00:00",
          "endTime": "2026-02-03T11:57:18.002000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16790.0,
          "completionTokens": 820,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 981,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-57-25-758765_chatcmpl-c5b28904-25cb-456d-ad02-0179aeabc3bd",
          "traceId": "3a79ad28",
          "type": "GENERATION",
          "name": "3a79_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:57:25.758000+00:00",
          "endTime": "2026-02-03T11:57:42.379000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16621.0,
          "completionTokens": 811,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 972,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-57-50-833380_chatcmpl-ba025367-f1fb-4d86-8ceb-2913060fbdea",
          "traceId": "3a79ad28",
          "type": "GENERATION",
          "name": "3a79_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:57:50.833000+00:00",
          "endTime": "2026-02-03T11:58:04.106000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13273.0,
          "completionTokens": 650,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 811,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T11:59:02.252Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:56:37.517Z"
    },
    {
      "id": "0dc2bfbc",
      "timestamp": "2026-02-03T11:54:06.419000+00:00",
      "name": "0dc2_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nfrom tflite_runtime.interpreter import Interpreter\nfrom PIL import Image\nimport numpy as np\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\ndef load_labels(path):\n    with open(path, 'r', encoding='utf-8') as file:\n        lines = file.readlines()\n        return {i: line.strip() for i, line in enumerate(lines)}\n\n# Initialize TFLite interpreter\ninterpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1')])\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n_, input_height, input_width, _ = input_details[0]['shape']\n\n# Video capture and writer\ncap = cv2.VideoCapture(input_path)\nfps = int(cap.get(cv2.CAP_PROP_FPS))\nwidth = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nheight = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (width, height))\n\ndef set_input_tensor(interpreter, image):\n    tensor_index = input_details[0]['index']\n    input_tensor = interpreter.tensor(tensor_index)()[0]\n    input_height, input_width = input_tensor.shape[1:3]\n    image = cv2.resize(image, (input_width, input_height))\n    input_tensor[:, :] = image\n\ndef get_output(interpreter):\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n    \n    set_input_tensor(interpreter, frame)\n    interpreter.invoke()\n\n    boxes, classes, scores = get_output(interpreter)\n\n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width,\n                                          ymin * height, ymax * height)\n            \n            object_name = labels[int(classes[i])]\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{object_name}: {int(scores[i] * 100)}%'\n            label_size, base_line = cv2.getTextSize(label, cv2.FONT_HERSHEY_SIMPLEX, 0.7, 2)\n            top = max(top, label_size[1])\n            cv2.rectangle(frame, (int(left), int(top - label_size[1])), (int(left + label_size[0]), int(top + base_line)), (255, 255, 255), cv2.FILLED)\n            cv2.putText(frame, label, (int(left), int(top)), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (0, 0, 0), 2)\n\n    out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_f0964801_1770119763.py\", line 23, in <module>\n    interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1')])\nNameError: name 'load_delegate' is not defined."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 23
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 124.562,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-54-06-421219_chatcmpl-e5f2ff3e-2063-4118-b73f-d1329bebb5b4",
          "traceId": "0dc2bfbc",
          "type": "GENERATION",
          "name": "0dc2_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:54:06.421000+00:00",
          "endTime": "2026-02-03T11:54:22.198000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15777.0,
          "completionTokens": 769,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 930,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-54-30-329779_chatcmpl-635c0d4c-d9fa-4c2c-a79f-9cfb66346cf7",
          "traceId": "0dc2bfbc",
          "type": "GENERATION",
          "name": "0dc2_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:54:30.329000+00:00",
          "endTime": "2026-02-03T11:54:44.544000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14215.0,
          "completionTokens": 696,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 857,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-54-52-318819_chatcmpl-a6442e67-06f1-4b96-b46d-38bf65ab05d4",
          "traceId": "0dc2bfbc",
          "type": "GENERATION",
          "name": "0dc2_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:54:52.318000+00:00",
          "endTime": "2026-02-03T11:55:09.751000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 17433.0,
          "completionTokens": 850,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1011,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-55-17-554500_chatcmpl-40b9151b-0ea1-4aa4-b586-27be7cf1a326",
          "traceId": "0dc2bfbc",
          "type": "GENERATION",
          "name": "0dc2_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:55:17.554000+00:00",
          "endTime": "2026-02-03T11:55:36.966000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 19412.0,
          "completionTokens": 943,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1104,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-55-44-847072_chatcmpl-cdb0c2eb-1f05-4bc9-9a9b-57078381d82d",
          "traceId": "0dc2bfbc",
          "type": "GENERATION",
          "name": "0dc2_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:55:44.847000+00:00",
          "endTime": "2026-02-03T11:56:03.077000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 18230.0,
          "completionTokens": 890,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1051,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "c3b6025c-9969-493a-a8ec-4e1d445b7cd7",
          "traceId": "0dc2bfbc",
          "type": "SPAN",
          "name": "error_0d_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:56:10.983000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_f0964801_1770119763.py\", line 23, in <module>\n    interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1')])\nNameError: name 'load_delegate' is not defined.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:56:16.168Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:54:06.941Z"
    },
    {
      "id": "1b82299c",
      "timestamp": "2026-02-03T11:51:38.065000+00:00",
      "name": "1b82_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2 as cv\nimport numpy as np\nimport argparse\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\n\n# Load labels from file\ndef load_labels(path):\n    with open(path, 'r') as f:\n        return {i: line.strip() for i, line in enumerate(f.readlines())}\n\n# Initialize the interpreter for Edge TPU\ndef initialize_interpreter(model_path):\n    # Load the model and allocate tensors.\n    interpreter = Interpreter(\n        model_path=model_path,\n        experimental_delegates=[load_delegate('libedgetpu.so.1')]\n    )\n    interpreter.allocate_tensors()\n    return interpreter\n\n# Process input frame through the model\ndef detect_objects(interpreter, image, threshold):\n    input_details = interpreter.get_input_details()\n    output_details = interpreter.get_output_details()\n\n    # Pre-process: resize and normalize input image\n    height, width, _ = input_details[0]['shape']\n    resized_image = cv.resize(image, (width, height))\n    input_data = np.expand_dims(resized_image, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    \n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]   # Confidence of detected objects\n\n    # Filter out detections below the confidence threshold\n    results = []\n    for i in range(len(scores)):\n        if scores[i] >= threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': int(classes[i]),\n                'score': scores[i]\n            }\n            results.append(result)\n    \n    return results\n\n# Parse command-line arguments\ndef parse_args():\n    parser = argparse.ArgumentParser()\n    parser.add_argument('--model_path', type=str, default='/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite')\n    parser.add_argument('--label_path', type=str, default='/home/mendel/tinyml_autopilot/models/labelmap.txt')\n    parser.add_argument('--input_path', type=str, default='/home/mendel/tinyml_autopilot/data/sheeps.mp4')\n    parser.add_argument('--output_path', type=str, default='/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4')\n    parser.add_argument('--confidence_threshold', type=float, default=0.5)\n    return parser.parse_args()\n\ndef main():\n    # Parse arguments\n    args = parse_args()\n\n    # Load labels and initialize interpreter\n    labels = load_labels(args.label_path)\n    interpreter = initialize_interpreter(args.model_path)\n\n    # Open video files\n    cap = cv.VideoCapture(args.input_path)\n    if not cap.isOpened():\n        print(f\"Error: Could not open input file {args.input_path}\")\n        return\n\n    frame_width = int(cap.get(cv.CAP_PROP_FRAME_WIDTH))\n    frame_height = int(cap.get(cv.CAP_PROP_FRAME_HEIGHT))\n    fps = cap.get(cv.CAP_PROP_FPS)\n\n    # Define the codec and create VideoWriter object\n    fourcc = cv.VideoWriter_fourcc(*'mp4v')\n    out = cv.VideoWriter(args.output_path, fourcc, fps, (frame_width, frame_height))\n\n    while True:\n        ret, frame = cap.read()\n        if not ret:\n            break\n\n        # Perform detection on the current frame\n        results = detect_objects(interpreter, frame, args.confidence_threshold)\n\n        # Draw bounding boxes and labels on the frame\n        for result in results:\n            ymin, xmin, ymax, xmax = result['bounding_box']\n            (left, right, top, bottom) = (xmin * frame_width, xmax * frame_width,\n                                          ymin * frame_height, ymax * frame_height)\n            cv.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            \n            label = f\"{labels[result['class_id']]}: {result['score']:.2f}\"\n            cv.putText(frame, label, (int(left), int(top) - 10), cv.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 1)\n\n        # Write the frame with detection annotations\n        out.write(frame)\n    \n    # Release resources\n    cap.release()\n    out.release()\n\nif __name__ == '__main__':\n    main()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_7b93601e_1770119612.py\", line 114, in <module>\n    main()\n  File \"script_7b93601e_1770119612.py\", line 94, in main\n    results = detect_objects(interpreter, frame, args.confidence_threshold)\n  File \"script_7b93601e_1770119612.py\", line 28, in detect_objects\n    height, width, _ = input_details[0]['shape']\nValueError: too many values to unpack (expected 3)."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 22
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 122.282,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-51-38-066944_chatcmpl-6276537a-bfc5-4477-b250-0903846c6913",
          "traceId": "1b82299c",
          "type": "GENERATION",
          "name": "1b82_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:51:38.066000+00:00",
          "endTime": "2026-02-03T11:51:54.439000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16373.0,
          "completionTokens": 869,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1030,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-52-02-409961_chatcmpl-a85f936c-ddf5-4e6d-bbed-3ce348c97730",
          "traceId": "1b82299c",
          "type": "GENERATION",
          "name": "1b82_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:52:02.409000+00:00",
          "endTime": "2026-02-03T11:52:14.224000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 11815.0,
          "completionTokens": 636,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 797,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-52-21-956012_chatcmpl-7bcdc015-0586-4b46-bb13-e9acdb9bda54",
          "traceId": "1b82299c",
          "type": "GENERATION",
          "name": "1b82_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:52:21.956000+00:00",
          "endTime": "2026-02-03T11:52:40.116000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 18160.0,
          "completionTokens": 974,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1135,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-52-47-868374_chatcmpl-7292ea55-8701-40e4-90af-2c0f62283f78",
          "traceId": "1b82299c",
          "type": "GENERATION",
          "name": "1b82_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:52:47.868000+00:00",
          "endTime": "2026-02-03T11:53:02.191000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14323.0,
          "completionTokens": 767,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 928,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-53-09-985073_chatcmpl-5cdac57a-cfcb-4d21-a9ef-b6ff80ca1e00",
          "traceId": "1b82299c",
          "type": "GENERATION",
          "name": "1b82_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:53:09.985000+00:00",
          "endTime": "2026-02-03T11:53:32.309000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 22324.0,
          "completionTokens": 1185,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1346,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "3a72fd9c-2669-4efc-9f51-83969bbe16bb",
          "traceId": "1b82299c",
          "type": "SPAN",
          "name": "error_1b_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:53:40.348000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_7b93601e_1770119612.py\", line 114, in <module>\n    main()\n  File \"script_7b93601e_1770119612.py\", line 94, in main\n    results = detect_objects(interpreter, frame, args.confidence_threshold)\n  File \"script_7b93601e_1770119612.py\", line 28, in detect_objects\n    height, width, _ = input_details[0]['shape']\nValueError: too many values to unpack (expected 3).",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:53:45.834Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:51:38.585Z"
    },
    {
      "id": "54c8f55b",
      "timestamp": "2026-02-03T11:49:20.336000+00:00",
      "name": "54c8_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as file:\n    labels = [line.strip() for line in file.readlines()]\n\ndef load_labels(path):\n    with open(path, 'r', encoding='utf-8') as f:\n        return {i: line.strip() for i, line in enumerate(f.readlines())}\n\n# Initialize TFLite interpreter\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\nheight = input_details[0]['shape'][1]\nwidth = input_details[0]['shape'][2]\n\n# Open video\ncap = cv2.VideoCapture(input_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (width, height))\n    input_data = cv2.cvtColor(input_data, cv2.COLOR_BGR2RGB)\n    input_data = input_data.astype('float32')\n    input_data = np.expand_dims(input_data, axis=0)\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Get detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * cap.get(3), xmax * cap.get(3),\n                                          ymin * cap.get(4), ymax * cap.get(4))\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)),\n                          (0, 255, 0), 2)\n            object_name = labels[int(classes[i])]\n            label = f'{object_name}: {int(scores[i] * 100)}%'\n            label_size, base_line = cv2.getTextSize(label, cv2.FONT_HERSHEY_SIMPLEX, 0.7, 2)\n            top = max(top, label_size[1])\n            cv2.rectangle(frame, (int(left), int(top - round(1.5*label_size[1]))),\n                          (int(left + round(1.5*label_size[0])), int(top + base_line)),\n                          (255, 255, 255), cv2.FILLED)\n            cv2.putText(frame, label, (int(left), int(top + base_line)), cv2.FONT_HERSHEY_SIMPLEX,\n                        0.7, (0, 0, 0), 2)\n\n    # Write the frame with detections\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_f0876254_1770119463.py\", line 47, in <module>\n    input_data = np.expand_dims(input_data, axis=0)\nNameError: name 'np' is not defined."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 21
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 111.109,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-49-20-338154_chatcmpl-a20731e2-91c3-463b-8c52-0112fe9661b9",
          "traceId": "54c8f55b",
          "type": "GENERATION",
          "name": "54c8_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:49:20.338000+00:00",
          "endTime": "2026-02-03T11:49:34.480000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14142.0,
          "completionTokens": 751,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 912,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-49-42-168538_chatcmpl-66167b81-18e8-4b45-a465-89643c336a11",
          "traceId": "54c8f55b",
          "type": "GENERATION",
          "name": "54c8_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:49:42.168000+00:00",
          "endTime": "2026-02-03T11:49:55.756000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13588.0,
          "completionTokens": 729,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 890,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-50-03-453348_chatcmpl-de80af87-cf6d-4402-96f8-839ef3366d34",
          "traceId": "54c8f55b",
          "type": "GENERATION",
          "name": "54c8_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:50:03.453000+00:00",
          "endTime": "2026-02-03T11:50:18.489000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15036.0,
          "completionTokens": 806,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 967,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-50-26-297921_chatcmpl-9297223b-b993-42ba-b545-1f74c63b7daf",
          "traceId": "54c8f55b",
          "type": "GENERATION",
          "name": "54c8_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:50:26.297000+00:00",
          "endTime": "2026-02-03T11:50:39.270000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 12973.0,
          "completionTokens": 697,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 858,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-50-46-962437_chatcmpl-2c9bfc16-3243-455a-be65-2d4ab16240f3",
          "traceId": "54c8f55b",
          "type": "GENERATION",
          "name": "54c8_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:50:46.962000+00:00",
          "endTime": "2026-02-03T11:51:03.176000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16214.0,
          "completionTokens": 869,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1030,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "c4c18392-a1dc-4270-b314-f232058fbb3a",
          "traceId": "54c8f55b",
          "type": "SPAN",
          "name": "error_54_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:51:11.447000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_f0876254_1770119463.py\", line 47, in <module>\n    input_data = np.expand_dims(input_data, axis=0)\nNameError: name 'np' is not defined.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:51:16.994Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:49:20.860Z"
    },
    {
      "id": "9ef9ac4a",
      "timestamp": "2026-02-03T11:47:01.797000+00:00",
      "name": "9ef9_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nfrom tflite_runtime.interpreter import Interpreter\nfrom PIL import Image\nimport numpy as np\n\ndef load_labels(path):\n    with open(path, 'r') as f:\n        return [line.strip() for line in f.readlines()]\n\ndef set_input_tensor(interpreter, image):\n    tensor_index = interpreter.get_input_details()[0]['index']\n    input_tensor = interpreter.tensor(tensor_index)()[0]\n    input_tensor[:, :] = image\n\ndef get_output(interpreter, score_threshold):\n    boxes = []\n    classes = []\n    scores = []\n\n    for i in range(len(interpreter.get_output_details())):\n        detail = interpreter.get_output_details()[i]\n        output = np.squeeze(interpreter.get_tensor(detail['index']))\n\n        if 'boxes' in detail['name']:\n            boxes.append(output)\n        elif 'classes' in detail['name']:\n            classes.append(output)\n        elif 'scores' in detail['name']:\n            scores.append(output)\n\n    boxes = np.array(boxes)[0]\n    classes = np.array(classes)[0].astype(np.int32)\n    scores = np.array(scores)[0]\n\n    results = []\n    for i in range(len(scores)):\n        if scores[i] >= score_threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': classes[i],\n                'score': scores[i]\n            }\n            results.append(result)\n\n    return results\n\ndef draw_boxes(frame, results, labels):\n    for obj in results:\n        ymin, xmin, ymax, xmax = tuple(obj['bounding_box'])\n        xmin = int(xmin * frame.shape[1])\n        xmax = int(xmax * frame.shape[1])\n        ymin = int(ymin * frame.shape[0])\n        ymax = int(ymax * frame.shape[0])\n\n        cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (10, 255, 0), 2)\n        label = f\"{labels[obj['class_id']]}: {int(obj['score'] * 100)}%\"\n        cv2.putText(frame, label, (xmin, ymin - 5), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (10, 255, 0), 2)\n\ndef main():\n    model_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\n    label_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\n    input_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\n    output_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\n    confidence_threshold = 0.5\n\n    labels = load_labels(label_path)\n    interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1')])\n    interpreter.allocate_tensors()\n\n    input_details = interpreter.get_input_details()\n    output_details = interpreter.get_output_details()\n    height = input_details[0]['shape'][1]\n    width = input_details[0]['shape'][2]\n\n    cap = cv2.VideoCapture(input_path)\n    fourcc = cv2.VideoWriter_fourcc(*'mp4v')\n    out = cv2.VideoWriter(output_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\n    while cap.isOpened():\n        ret, frame = cap.read()\n        if not ret:\n            break\n\n        image = Image.fromarray(frame)\n        image_resized = image.resize((width, height))\n        set_input_tensor(interpreter, np.expand_dims(np.asarray(image_resized), axis=0))\n\n        interpreter.invoke()\n\n        results = get_output(interpreter, confidence_threshold)\n        draw_boxes(frame, results, labels)\n\n        out.write(frame)\n\n    cap.release()\n    out.release()\n\nif __name__ == '__main__':\n    main()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_f1d749d1_1770119326.py\", line 99, in <module>\n    main()\n  File \"script_f1d749d1_1770119326.py\", line 67, in main\n    interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1')])\nNameError: name 'load_delegate' is not defined."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 20
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 112.335,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-47-01-798822_chatcmpl-4fb48ffd-d06d-4ea1-a5d9-92a4a5aff87e",
          "traceId": "9ef9ac4a",
          "type": "GENERATION",
          "name": "9ef9_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:47:01.798000+00:00",
          "endTime": "2026-02-03T11:47:15.057000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13259.0,
          "completionTokens": 706,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 867,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-47-22-687570_chatcmpl-53393084-3d86-47c7-876a-ad39de0801af",
          "traceId": "9ef9ac4a",
          "type": "GENERATION",
          "name": "9ef9_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:47:22.687000+00:00",
          "endTime": "2026-02-03T11:47:35.839000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13152.0,
          "completionTokens": 705,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 866,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-47-43-677735_chatcmpl-294537b1-5f3f-48cd-ab5e-b7dc6438a3ed",
          "traceId": "9ef9ac4a",
          "type": "GENERATION",
          "name": "9ef9_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:47:43.677000+00:00",
          "endTime": "2026-02-03T11:47:58.668000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14991.0,
          "completionTokens": 800,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 961,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-48-06-897909_chatcmpl-53644192-fadd-4215-9624-4dd29e23dbed",
          "traceId": "9ef9ac4a",
          "type": "GENERATION",
          "name": "9ef9_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:48:06.897000+00:00",
          "endTime": "2026-02-03T11:48:23.549000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16652.0,
          "completionTokens": 885,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1046,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-48-31-341754_chatcmpl-e20771f9-124d-4f73-a7b5-47ac74bf34a7",
          "traceId": "9ef9ac4a",
          "type": "GENERATION",
          "name": "9ef9_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:48:31.341000+00:00",
          "endTime": "2026-02-03T11:48:46.376000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15035.0,
          "completionTokens": 806,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 967,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "c4ef4ab4-5cfa-4324-bce7-2cd373f326b9",
          "traceId": "9ef9ac4a",
          "type": "SPAN",
          "name": "error_9e_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:48:54.133000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_f1d749d1_1770119326.py\", line 99, in <module>\n    main()\n  File \"script_f1d749d1_1770119326.py\", line 67, in main\n    interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1')])\nNameError: name 'load_delegate' is not defined.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:48:59.496Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:47:02.319Z"
    },
    {
      "id": "d0bb4b79",
      "timestamp": "2026-02-03T11:44:41.544000+00:00",
      "name": "d0bb_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\nfrom google Coral's Edge TPU API: delegate_v2 import load_delegate\n\ndef load_labels(label_path):\n    with open(label_path, 'r') as file:\n        labels = [line.strip() for line in file.readlines()]\n    return labels\n\ndef set_input_tensor(interpreter, image):\n    tensor_index = interpreter.get_input_details()[0]['index']\n    input_shape = interpreter.get_input_details()[0]['shape']\n    \n    # Resize and pad the image to fit the model's expected input size\n    resized_image = cv2.resize(image, (input_shape[1], input_shape[2]))\n    input_tensor = np.expand_dims(resized_image, axis=0)\n    \n    # Copy data into tensor\n    interpreter.set_tensor(tensor_index, input_tensor)\n\ndef get_output(interpreter):\n    output_details = interpreter.get_output_details()\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]   # Confidence of detected objects\n    \n    return boxes, classes, scores\n\ndef detect_objects(interpreter, image, threshold):\n    set_input_tensor(interpreter, image)\n    interpreter.invoke()\n\n    boxes, classes, scores = get_output(interpreter)\n\n    results = []\n    for i in range(len(scores)):\n        if scores[i] >= threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': int(classes[i]),\n                'score': scores[i]\n            }\n            results.append(result)\n    \n    return results\n\ndef draw_objects_on_image(image, results, labels):\n    for obj in results:\n        ymin, xmin, ymax, xmax = obj['bounding_box']\n        label_idx = int(obj['class_id'])\n\n        # Scale the bounding box to fit the image size\n        h, w, _ = image.shape\n        xmin = int(xmin * w)\n        xmax = int(xmax * w)\n        ymin = int(ymin * h)\n        ymax = int(ymax * h)\n\n        cv2.rectangle(image, (xmin, ymin), (xmax, ymax), (0, 255, 0), 2)\n        \n        # Prepare label text\n        object_name = labels[label_idx]\n        label_text = f'{object_name}: {obj[\"score\"]:.2f}'\n        \n        # Display label\n        label_size, base_line = cv2.getTextSize(label_text, cv2.FONT_HERSHEY_SIMPLEX, 0.7, 2)\n        top = max(ymin, label_size[1])\n        cv2.rectangle(image, (xmin, top - label_size[1]), (xmin + label_size[0], top + base_line), (255, 255, 255), cv2.FILLED)\n        cv2.putText(image, label_text, (xmin, top), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (0, 0, 0), 2)\n\ndef main():\n    # Configuration parameters\n    model_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\n    label_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\n    input_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\n    output_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\n    confidence_threshold = 0.5\n\n    # Load labels\n    labels = load_labels(label_path)\n\n    # Initialize the TFLite interpreter for Edge TPU\n    interpreter = Interpreter(model_path=model_path, experimental_delegates=[load_delegate('libedgetpu.so.1.0')])\n    interpreter.allocate_tensors()\n\n    # Open video file or stream\n    cap = cv2.VideoCapture(input_path)\n    \n    if not cap.isOpened():\n        print(\"Error: Could not open input video.\")\n        return\n    \n    width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\n    height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\n    fps = int(cap.get(cv2.CAP_PROP_FPS))\n\n    # Define the codec and create VideoWriter object\n    fourcc = cv2.VideoWriter_fourcc(*'mp4v')\n    out = cv2.VideoWriter(output_path, fourcc, fps, (width, height))\n    \n    while cap.isOpened():\n        ret, frame = cap.read()\n        \n        if not ret:\n            break\n        \n        results = detect_objects(interpreter, frame, confidence_threshold)\n        draw_objects_on_image(frame, results, labels)\n\n        # Write the frame with detections to output video\n        out.write(frame)\n\n        # Display the resulting frame (optional)\n        cv2.imshow('Object Detection', frame)\n        \n        if cv2.waitKey(1) & 0xFF == ord('q'):\n            break\n\n    cap.release()\n    out.release()\n    cv2.destroyAllWindows()\n\nif __name__ == \"__main__\":\n    main()",
        "last_error": "Max retries reached with error. Last error:   File \"script_8eef2cb2_1770119191.py\", line 4\n    from google Coral's Edge TPU API: delegate_v2 import load_delegate\n                    ^\nSyntaxError: invalid syntax."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 19
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 114.353,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-44-41-545578_chatcmpl-548c78ec-9597-4e18-b960-f301407420ee",
          "traceId": "d0bb4b79",
          "type": "GENERATION",
          "name": "d0bb_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:44:41.545000+00:00",
          "endTime": "2026-02-03T11:44:58.372000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16827.0,
          "completionTokens": 889,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1050,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-45-06-153616_chatcmpl-6746cfd9-36ed-4b83-a403-020769adca9c",
          "traceId": "d0bb4b79",
          "type": "GENERATION",
          "name": "d0bb_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:45:06.153000+00:00",
          "endTime": "2026-02-03T11:45:19.572000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13419.0,
          "completionTokens": 723,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 884,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-45-27-299005_chatcmpl-4e156f0c-457b-4f03-a960-c8c77d2a0a33",
          "traceId": "d0bb4b79",
          "type": "GENERATION",
          "name": "d0bb_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:45:27.299000+00:00",
          "endTime": "2026-02-03T11:45:41.703000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14404.0,
          "completionTokens": 774,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 935,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-45-50-118002_chatcmpl-150d372b-5dad-4430-8b5f-7d675c2fe4b4",
          "traceId": "d0bb4b79",
          "type": "GENERATION",
          "name": "d0bb_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:45:50.118000+00:00",
          "endTime": "2026-02-03T11:46:03.913000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13795.0,
          "completionTokens": 742,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 903,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-46-11-620274_chatcmpl-67fc1f21-25f0-4055-a38e-d1002bc1dd32",
          "traceId": "d0bb4b79",
          "type": "GENERATION",
          "name": "d0bb_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:46:11.620000+00:00",
          "endTime": "2026-02-03T11:46:31.957000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 20337.0,
          "completionTokens": 1072,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1233,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "be9a4dbb-3dd3-491a-b575-b52c805eb195",
          "traceId": "d0bb4b79",
          "type": "SPAN",
          "name": "error_d0_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:46:35.898000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error:   File \"script_8eef2cb2_1770119191.py\", line 4\n    from google Coral's Edge TPU API: delegate_v2 import load_delegate\n                    ^\nSyntaxError: invalid syntax.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:46:41.199Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:44:42.064Z"
    },
    {
      "id": "ba53810e",
      "timestamp": "2026-02-03T11:42:38.235000+00:00",
      "name": "ba53_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize TFLite interpreter with EdgeTPU support\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\n)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Video capture\ncap = cv2.VideoCapture(input_path)\n\n# Video writer setup\nret, frame = cap.read()\nheight, width, _ = frame.shape\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 30.0, (width, height))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the frame\n    input_frame = cv2.resize(frame, (input_details[0]['shape'][2], input_details[0]['shape'][1]))\n    input_frame = np.expand_dims(input_frame, axis=0).astype(np.float32)\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_frame)\n    interpreter.invoke()\n\n    # Process output\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width, ymin * height, ymax * height)\n            \n            # Draw bounding box and label\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            object_name = labels[int(classes[i])]\n            label = f'{object_name}: {int(scores[i] * 100)}%'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 255, 255), 2)\n\n    # Write the frame with detections\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()\n\ndef load_delegate(path):\n    from tflite_runtime.interpreter import load_delegate\n    return path",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_ca5015d8_1770119048.py\", line 19, in <module>\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\nNameError: name 'load_delegate' is not defined."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 18
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 97.77,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-42-38-237222_chatcmpl-c67ba851-a9ff-4efe-a59d-d010ba2700b1",
          "traceId": "ba53810e",
          "type": "GENERATION",
          "name": "ba53_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:42:38.237000+00:00",
          "endTime": "2026-02-03T11:42:48.556000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10319.0,
          "completionTokens": 531,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 692,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-42-56-410038_chatcmpl-8a60c120-0124-4970-a98d-55269ac5b5e2",
          "traceId": "ba53810e",
          "type": "GENERATION",
          "name": "ba53_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:42:56.410000+00:00",
          "endTime": "2026-02-03T11:43:09.896000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13486.0,
          "completionTokens": 716,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 877,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-43-13-836542_chatcmpl-cdc8fa18-ce1b-4edc-88e1-437b23c9a195",
          "traceId": "ba53810e",
          "type": "GENERATION",
          "name": "ba53_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:43:13.836000+00:00",
          "endTime": "2026-02-03T11:43:25.414000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 11578.0,
          "completionTokens": 625,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 786,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-43-33-776991_chatcmpl-081b35ee-8761-42b2-aa3a-8d43f1352078",
          "traceId": "ba53810e",
          "type": "GENERATION",
          "name": "ba53_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:43:33.776000+00:00",
          "endTime": "2026-02-03T11:43:46.760000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 12984.0,
          "completionTokens": 700,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 861,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-43-54-526161_chatcmpl-94fe6283-c66a-48ec-8107-715e1cd6ffcd",
          "traceId": "ba53810e",
          "type": "GENERATION",
          "name": "ba53_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:43:54.526000+00:00",
          "endTime": "2026-02-03T11:44:08.230000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13704.0,
          "completionTokens": 735,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 896,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "36bbf68f-8a71-4ede-bdca-0605e387c7cc",
          "traceId": "ba53810e",
          "type": "SPAN",
          "name": "error_ba_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:44:16.007000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_ca5015d8_1770119048.py\", line 19, in <module>\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\nNameError: name 'load_delegate' is not defined.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:44:21.402Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:42:38.758Z"
    },
    {
      "id": "46d9e1e4",
      "timestamp": "2026-02-03T11:40:14.548000+00:00",
      "name": "46d9_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tflite_runtime.interpreter as tflite\n\ndef load_labels(label_path):\n    with open(label_path, 'r', encoding='utf-8') as f:\n        return {i: line.strip() for i, line in enumerate(f.readlines())}\n\ndef set_input_tensor(interpreter, image):\n    tensor_index = interpreter.get_input_details()[0]['index']\n    input_shape = interpreter.get_input_details()[0]['shape']\n    input_image = cv2.resize(image, (input_shape[1], input_shape[2]))\n    input_image = cv2.cvtColor(input_image, cv2.COLOR_BGR2RGB)\n    input_image = np.expand_dims(input_image, axis=0).astype(np.float32)\n    interpreter.set_tensor(tensor_index, input_image)\n\ndef get_output(interpreter):\n    boxes = interpreter.get_tensor(\n        interpreter.get_output_details()[0]['index'])[0]  # Bounding box coordinates\n    classes = interpreter.get_tensor(\n        interpreter.get_output_details()[1]['index'])[0]  # Class index\n    scores = interpreter.get_tensor(\n        interpreter.get_output_details()[2]['index'])[0]  # Confidence score\n    return boxes, classes, scores\n\ndef draw_detections(image, boxes, class_ids, scores, labels, threshold):\n    for i in range(len(scores)):\n        if scores[i] >= threshold:\n            ymin, xmin, ymax, xmax = tuple(boxes[i])\n            xmin = int(xmin * image.shape[1])\n            xmax = int(xmax * image.shape[1])\n            ymin = int(ymin * image.shape[0])\n            ymax = int(ymax * image.shape[0])\n\n            cv2.rectangle(image, (xmin, ymin), (xmax, ymax), (10, 255, 0), 2)\n            label = f\"{labels[int(class_ids[i])]}: {int(scores[i] * 100)}%\"\n            cv2.putText(image, label, (xmin, ymin - 15), cv2.FONT_HERSHEY_SIMPLEX,\n                        0.5, (10, 255, 0), 2)\n\ndef main():\n    model_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\n    label_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\n    input_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\n    output_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\n    confidence_threshold = 0.5\n\n    labels = load_labels(label_path)\n\n    interpreter = tflite.Interpreter(model_path=model_path, experimental_delegates=[tflite.load_delegate('libedgetpu.so.1.0')])\n    interpreter.allocate_tensors()\n\n    cap = cv2.VideoCapture(input_path)\n    out = None\n    while cap.isOpened():\n        ret, frame = cap.read()\n        if not ret:\n            break\n\n        set_input_tensor(interpreter, frame)\n        interpreter.invoke()\n        boxes, class_ids, scores = get_output(interpreter)\n\n        draw_detections(frame, boxes, class_ids, scores, labels, confidence_threshold)\n\n        if out is None:\n            fourcc = cv2.VideoWriter_fourcc(*'mp4v')\n            out = cv2.VideoWriter(output_path, fourcc, 30.0, (frame.shape[1], frame.shape[0]))\n\n        out.write(frame)\n        cv2.imshow('Object detector', frame)\n\n        if cv2.waitKey(1) & 0xFF == ord('q'):\n            break\n\n    cap.release()\n    if out:\n        out.release()\n    cv2.destroyAllWindows()\n\nif __name__ == '__main__':\n    main()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_90ab3bf2_1770118923.py\", line 81, in <module>\n    main()\n  File \"script_90ab3bf2_1770118923.py\", line 59, in main\n    set_input_tensor(interpreter, frame)\n  File \"script_90ab3bf2_1770118923.py\", line 15, in set_input_tensor\n    interpreter.set_tensor(tensor_index, input_image)\n  File \"/home/mendel/tinyml_autopilot/tinyml-env/lib/python3.7/site-packages/tflite_runtime/interpreter.py\", line 572, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor ."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 17
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 117.134,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-40-14-549881_chatcmpl-84d36372-1ca9-40e6-9ad3-abdf4882cf05",
          "traceId": "46d9e1e4",
          "type": "GENERATION",
          "name": "46d9_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:40:14.549000+00:00",
          "endTime": "2026-02-03T11:40:29.928000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15379.0,
          "completionTokens": 787,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 948,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-40-38-084409_chatcmpl-bc3d20e6-a772-4bd3-9e9a-b534588b37e5",
          "traceId": "46d9e1e4",
          "type": "GENERATION",
          "name": "46d9_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:40:38.084000+00:00",
          "endTime": "2026-02-03T11:40:51.133000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13049.0,
          "completionTokens": 677,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 838,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-40-59-782717_chatcmpl-5c750526-5003-457c-92c6-4812b676439f",
          "traceId": "46d9e1e4",
          "type": "GENERATION",
          "name": "46d9_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:40:59.782000+00:00",
          "endTime": "2026-02-03T11:41:16.390000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16608.0,
          "completionTokens": 861,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1022,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-41-24-210348_chatcmpl-9ef7abce-a093-461f-a8b2-e16ee7e932e1",
          "traceId": "46d9e1e4",
          "type": "GENERATION",
          "name": "46d9_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:41:24.210000+00:00",
          "endTime": "2026-02-03T11:41:40.666000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16456.0,
          "completionTokens": 854,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1015,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-41-48-597224_chatcmpl-929d24c3-3073-4bb1-a66f-312fe783062e",
          "traceId": "46d9e1e4",
          "type": "GENERATION",
          "name": "46d9_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:41:48.597000+00:00",
          "endTime": "2026-02-03T11:42:03.602000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15005.0,
          "completionTokens": 782,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 943,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "6f411896-2b50-4f79-a2f4-ed89cbb34938",
          "traceId": "46d9e1e4",
          "type": "SPAN",
          "name": "error_46_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:42:11.683000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_90ab3bf2_1770118923.py\", line 81, in <module>\n    main()\n  File \"script_90ab3bf2_1770118923.py\", line 59, in main\n    set_input_tensor(interpreter, frame)\n  File \"script_90ab3bf2_1770118923.py\", line 15, in set_input_tensor\n    interpreter.set_tensor(tensor_index, input_image)\n  File \"/home/mendel/tinyml_autopilot/tinyml-env/lib/python3.7/site-packages/tflite_runtime/interpreter.py\", line 572, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor .",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:42:17.247Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:40:15.067Z"
    },
    {
      "id": "05de57ce",
      "timestamp": "2026-02-03T11:38:22.803000+00:00",
      "name": "05de_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\n\ndef load_labels(path):\n    with open(path, 'r') as file:\n        lines = file.readlines()\n    return [line.strip() for line in lines]\n\ndef set_input_tensor(interpreter, image):\n    tensor_index = interpreter.get_input_details()[0]['index']\n    input_shape = interpreter.get_input_details()[0]['shape']\n    image = cv2.resize(image, (input_shape[1], input_shape[2]))\n    image = np.expand_dims(image, axis=0)\n    interpreter.tensor(tensor_index)()[...] = image\n\ndef get_output(interpreter):\n    boxes = interpreter.get_tensor(\n        interpreter.get_output_details()[0]['index'])[0]\n    classes = interpreter.get_tensor(\n        interpreter.get_output_details()[1]['index'])[0]\n    scores = interpreter.get_tensor(\n        interpreter.get_output_details()[2]['index'])[0]\n    count = int(interpreter.get_tensor(\n        interpreter.get_output_details()[3]['index'])[0])\n    return boxes, classes, scores, count\n\ndef detect_objects(video_path, output_path, model_path, label_path, confidence_threshold):\n    # Load labels\n    labels = load_labels(label_path)\n    \n    # Initialize TFLite interpreter with EdgeTPU delegate\n    interpreter = Interpreter(\n        model_path=model_path,\n        experimental_delegates=[load_delegate('libedgetpu.so.1.0')]\n    )\n    interpreter.allocate_tensors()\n    \n    input_size = tuple(interpreter.get_input_details()[0]['shape'][1:3])\n    \n    # Open video file\n    cap = cv2.VideoCapture(video_path)\n    width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\n    height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\n    fps = cap.get(cv2.CAP_PROP_FPS)\n    \n    # Define the codec and create VideoWriter object\n    fourcc = cv2.VideoWriter_fourcc(*'mp4v')\n    out = cv2.VideoWriter(output_path, fourcc, fps, (width, height))\n    \n    while cap.isOpened():\n        ret, frame = cap.read()\n        if not ret:\n            break\n        \n        # Set the input tensor\n        set_input_tensor(interpreter, frame)\n        \n        # Run inference\n        interpreter.invoke()\n        \n        # Get output tensors\n        boxes, classes, scores, count = get_output(interpreter)\n        \n        for i in range(count):\n            if scores[i] >= confidence_threshold:\n                ymin, xmin, ymax, xmax = boxes[i]\n                (left, right, top, bottom) = (xmin * width, xmax * width,\n                                              ymin * height, ymax * height)\n                \n                # Draw bounding box and label on the frame\n                cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n                label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n                cv2.putText(frame, label, (int(left), int(top) - 10), \n                            cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 1)\n        \n        # Write the frame with detections\n        out.write(frame)\n    \n    cap.release()\n    out.release()\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Run object detection\ndetect_objects(input_path, output_path, model_path, label_path, confidence_threshold)"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 16
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 33.487,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-38-22-803816_chatcmpl-b2d9d86c-c51b-487b-a1aa-f44d74a5f7bb",
          "traceId": "05de57ce",
          "type": "GENERATION",
          "name": "05de_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:38:22.803000+00:00",
          "endTime": "2026-02-03T11:38:35.753000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 12950.0,
          "completionTokens": 677,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 838,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-38-39-720497_chatcmpl-d298c5bd-6d05-4189-9247-8e30d0ed5310",
          "traceId": "05de57ce",
          "type": "GENERATION",
          "name": "05de_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:38:39.720000+00:00",
          "endTime": "2026-02-03T11:38:56.290000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16570.0,
          "completionTokens": 878,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1039,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T11:39:54.025Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:38:23.322Z"
    },
    {
      "id": "a5b64fe0",
      "timestamp": "2026-02-03T11:35:47.400000+00:00",
      "name": "a5b6_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize the TFLite interpreter with EdgeTPU delegate\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\n)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\ninput_index = input_details[0]['index']\noutput_indices = [detail['index'] for detail in output_details]\n\ndef preprocess(frame):\n    frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\n    frame_resized = cv2.resize(frame_rgb, (input_shape[1], input_shape[2]))\n    return np.expand_dims(frame_resized, axis=0)\n\n# Open video files\ncap = cv2.VideoCapture(input_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the frame\n    input_data = preprocess(frame)\n\n    # Run inference\n    interpreter.set_tensor(input_index, input_data)\n    interpreter.invoke()\n\n    # Extract output data\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    # Draw boxes for detections above the threshold\n    h, w, _ = frame.shape\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * w, xmax * w, ymin * h, ymax * h)\n\n            # Draw rectangle and label on the frame\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 1)\n\n    # Write the frame with detections\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 15
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 77.346,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-35-47-401217_chatcmpl-66a2c04e-2e2c-40f2-873d-1d2272569c73",
          "traceId": "a5b64fe0",
          "type": "GENERATION",
          "name": "a5b6_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:35:47.401000+00:00",
          "endTime": "2026-02-03T11:35:58.398000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10997.0,
          "completionTokens": 575,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 736,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-36-06-971555_chatcmpl-f9c36420-f508-451f-a87d-edbe8b8018d3",
          "traceId": "a5b64fe0",
          "type": "GENERATION",
          "name": "a5b6_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:36:06.971000+00:00",
          "endTime": "2026-02-03T11:36:21.391000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14420.0,
          "completionTokens": 752,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 913,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-36-29-570204_chatcmpl-76edc3c3-f42c-4296-add0-3a180bb01db5",
          "traceId": "a5b64fe0",
          "type": "GENERATION",
          "name": "a5b6_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:36:29.570000+00:00",
          "endTime": "2026-02-03T11:36:43.739000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14169.0,
          "completionTokens": 746,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 907,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-36-51-488451_chatcmpl-329740ce-f1a3-4d09-bb68-3d83c80e2345",
          "traceId": "a5b64fe0",
          "type": "GENERATION",
          "name": "a5b6_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:36:51.488000+00:00",
          "endTime": "2026-02-03T11:37:04.747000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13259.0,
          "completionTokens": 710,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 871,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T11:38:02.629Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:35:47.918Z"
    },
    {
      "id": "f6b8fa0c",
      "timestamp": "2026-02-03T11:33:35.061000+00:00",
      "name": "f6b8_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize the Coral Edge TPU interpreter\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\nheight, width, channel = input_shape\n\ndef preprocess_frame(frame):\n    frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\n    frame_resized = cv2.resize(frame_rgb, (width, height))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.uint8)\n    return input_data\n\n# Open video files\ncap = cv2.VideoCapture(input_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the frame\n    input_data = preprocess_frame(frame)\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]   # Confidence of detected objects\n\n    # Loop over all detections and draw detection box if confidence is above the threshold\n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n\n            # Draw bounding box and label on the frame\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            object_name = labels[int(classes[i])]\n            label = f\"{object_name}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n    # Write the frame with detections to output video\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_c26ff56f_1770118513.py\", line 28, in <module>\n    height, width, channel = input_shape\nValueError: too many values to unpack (expected 3)."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 14
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 106.142,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-33-35-061908_chatcmpl-7f19ccc0-51ed-4058-ba26-8d586922ae58",
          "traceId": "f6b8fa0c",
          "type": "GENERATION",
          "name": "f6b8_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:33:35.061000+00:00",
          "endTime": "2026-02-03T11:33:53.306000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 18245.0,
          "completionTokens": 944,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1105,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-33-57-323115_chatcmpl-434bb124-d45a-4461-9441-f4630fbf61c9",
          "traceId": "f6b8fa0c",
          "type": "GENERATION",
          "name": "f6b8_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:33:57.323000+00:00",
          "endTime": "2026-02-03T11:34:14.567000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 17244.0,
          "completionTokens": 920,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1081,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-34-18-648509_chatcmpl-77ad2ea9-1433-4c66-ae1c-83a526bd2342",
          "traceId": "f6b8fa0c",
          "type": "GENERATION",
          "name": "f6b8_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:34:18.648000+00:00",
          "endTime": "2026-02-03T11:34:32.623000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13975.0,
          "completionTokens": 750,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 911,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-34-40-463180_chatcmpl-99199ae5-e2a7-4512-9dcc-3a152270a741",
          "traceId": "f6b8fa0c",
          "type": "GENERATION",
          "name": "f6b8_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:34:40.463000+00:00",
          "endTime": "2026-02-03T11:34:54.942000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14479.0,
          "completionTokens": 776,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 937,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-34-58-974162_chatcmpl-47fe3cc3-cd62-4e2c-b501-d07710bf2c78",
          "traceId": "f6b8fa0c",
          "type": "GENERATION",
          "name": "f6b8_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:34:58.974000+00:00",
          "endTime": "2026-02-03T11:35:13.358000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14384.0,
          "completionTokens": 769,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 930,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "ca18c596-0c59-43e2-b4a1-9c8451f19c5f",
          "traceId": "f6b8fa0c",
          "type": "SPAN",
          "name": "error_f6_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:35:21.203000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_c26ff56f_1770118513.py\", line 28, in <module>\n    height, width, channel = input_shape\nValueError: too many values to unpack (expected 3).",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:35:26.765Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:33:35.579Z"
    },
    {
      "id": "b165a5bb",
      "timestamp": "2026-02-03T11:30:33.487000+00:00",
      "name": "b165_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\nimport numpy as np\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize TFLite interpreter with Edge TPU delegate\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1.0')]\n)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\nheight, width, channels = input_shape[1], input_shape[2], input_shape[3]\n\n# Open video capture\ncap = cv2.VideoCapture(input_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the frame\n    input_data = cv2.resize(frame, (width, height))\n    input_data = np.expand_dims(input_data, axis=0)\n\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence score\n\n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            \n            # Draw bounding box\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (255, 0, 0), 2)\n            \n            # Label the object\n            label = f\"{labels[int(classes[i])]}: {int(scores[i]*100)}%\"\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 0, 0), 1)\n\n    # Write the frame with detections\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 13
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 104.456,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-30-33-488976_chatcmpl-cd316635-59cc-464a-99f3-9bab8dbe9724",
          "traceId": "b165a5bb",
          "type": "GENERATION",
          "name": "b165_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:30:33.488000+00:00",
          "endTime": "2026-02-03T11:30:50.789000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 17301.0,
          "completionTokens": 920,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1081,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-30-59-061464_chatcmpl-0a70bd32-3d13-43b5-a770-2b0895046534",
          "traceId": "b165a5bb",
          "type": "GENERATION",
          "name": "b165_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:30:59.061000+00:00",
          "endTime": "2026-02-03T11:31:13.887000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14826.0,
          "completionTokens": 792,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 953,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-31-17-920249_chatcmpl-0f476693-2351-41ee-ac2a-e24d07727b66",
          "traceId": "b165a5bb",
          "type": "GENERATION",
          "name": "b165_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:31:17.920000+00:00",
          "endTime": "2026-02-03T11:31:32.478000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14558.0,
          "completionTokens": 779,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 940,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-31-40-029905_chatcmpl-31940133-d3e2-4bb5-81b9-c54c91fbdef0",
          "traceId": "b165a5bb",
          "type": "GENERATION",
          "name": "b165_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:31:40.029000+00:00",
          "endTime": "2026-02-03T11:31:56.890000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16861.0,
          "completionTokens": 903,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1064,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-32-04-658856_chatcmpl-12f4db4a-5744-4e36-b7f9-9c7682f86507",
          "traceId": "b165a5bb",
          "type": "GENERATION",
          "name": "b165_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:32:04.658000+00:00",
          "endTime": "2026-02-03T11:32:17.944000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13286.0,
          "completionTokens": 713,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 874,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T11:33:15.796Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:30:34.012Z"
    },
    {
      "id": "33528ce8",
      "timestamp": "2026-02-03T11:28:19.941000+00:00",
      "name": "3352_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nfrom tflite_runtime.interpreter import Interpreter\nimport numpy as np\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load label map\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize the TFLite interpreter with EdgeTPU delegate\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n_, input_height, input_width, _ = input_details[0]['shape']\noutput_height = output_details[0]['shape'][1]\noutput_width = output_details[0]['shape'][2]\n\n# Video capture and writer setup\ncap = cv2.VideoCapture(input_path)\nfps = int(cap.get(cv2.CAP_PROP_FPS))\nwidth = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nheight = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (width, height))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the input image\n    img_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\n    resized_img = cv2.resize(img_rgb, (input_width, input_height))\n    input_data = np.expand_dims(resized_img, axis=0)\n\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]\n\n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            left, right, top, bottom = int(xmin * width), int(xmax * width), int(ymin * height), int(ymax * height)\n            \n            # Draw bounding box and label\n            cv2.rectangle(frame, (left, top), (right, bottom), (0, 255, 0), 2)\n            label = f\"{labels[int(classes[i])]}: {int(scores[i] * 100)}%\"\n            cv2.putText(frame, label, (left, top - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n    # Write the frame with detections\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_8dcbddaa_1770118199.py\", line 19, in <module>\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\nNameError: name 'load_delegate' is not defined."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 12
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 107.479,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-28-19-942709_chatcmpl-c50cdb80-835b-4517-8b03-f969d2d05976",
          "traceId": "33528ce8",
          "type": "GENERATION",
          "name": "3352_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:28:19.942000+00:00",
          "endTime": "2026-02-03T11:28:33.687000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13745.0,
          "completionTokens": 732,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 893,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-28-37-713757_chatcmpl-9129beed-5ede-499e-8e10-47be0651b9fc",
          "traceId": "33528ce8",
          "type": "GENERATION",
          "name": "3352_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:28:37.713000+00:00",
          "endTime": "2026-02-03T11:28:51.728000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14015.0,
          "completionTokens": 752,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 913,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-28-59-567235_chatcmpl-d2a43833-b8db-4ed8-a765-a7f2ecf0114e",
          "traceId": "33528ce8",
          "type": "GENERATION",
          "name": "3352_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:28:59.567000+00:00",
          "endTime": "2026-02-03T11:29:15.501000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15934.0,
          "completionTokens": 853,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1014,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-29-23-302767_chatcmpl-8e074283-789b-4d99-8292-de387af69e25",
          "traceId": "33528ce8",
          "type": "GENERATION",
          "name": "3352_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:29:23.302000+00:00",
          "endTime": "2026-02-03T11:29:38.588000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15286.0,
          "completionTokens": 816,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 977,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-29-46-425383_chatcmpl-769d3c9c-4910-40d0-9fc5-c674bc74fec3",
          "traceId": "33528ce8",
          "type": "GENERATION",
          "name": "3352_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:29:46.425000+00:00",
          "endTime": "2026-02-03T11:29:59.568000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13143.0,
          "completionTokens": 703,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 864,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "3136d326-4d6e-4a40-8575-a4a9707ab422",
          "traceId": "33528ce8",
          "type": "SPAN",
          "name": "error_33_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:30:07.421000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_8dcbddaa_1770118199.py\", line 19, in <module>\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\nNameError: name 'load_delegate' is not defined.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:30:12.635Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:28:20.463Z"
    },
    {
      "id": "542e83dd",
      "timestamp": "2026-02-03T11:26:06.656000+00:00",
      "name": "542e_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nfrom tflite_runtime.interpreter import Interpreter\nfrom PIL import Image\nimport numpy as np\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize TFLite interpreter for EdgeTPU\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1.0')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n_, input_height, input_width, _ = input_details[0]['shape']\n\n# Initialize video capture and writer\ncap = cv2.VideoCapture(input_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    img_rgb = Image.fromarray(cv2.cvtColor(frame, cv2.COLOR_BGR2RGB))\n    img_resized = img_rgb.resize((input_width, input_height), Image.ANTIALIAS)\n    input_data = np.expand_dims(img_resized, axis=0)\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Get detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    # Filter out low confidence detections\n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n    # Write the frame with detections\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()\n\ndef load_delegate(path):\n    from tflite_runtime.interpreter import load_delegate\n    return load_delegate(path)",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_e4d2b4cb_1770118066.py\", line 20, in <module>\n    experimental_delegates=[load_delegate('libedgetpu.so.1.0')]\nNameError: name 'load_delegate' is not defined."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 11
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 107.602,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-26-06-658088_chatcmpl-73493f8c-e6dd-4402-a8d2-df7460835a32",
          "traceId": "542e83dd",
          "type": "GENERATION",
          "name": "542e_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:26:06.658000+00:00",
          "endTime": "2026-02-03T11:26:19.664000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13006.0,
          "completionTokens": 673,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 834,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-26-27-411074_chatcmpl-149b7f8c-8a60-4039-b3c3-7086a0dabe58",
          "traceId": "542e83dd",
          "type": "GENERATION",
          "name": "542e_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:26:27.411000+00:00",
          "endTime": "2026-02-03T11:26:44.796000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 17385.0,
          "completionTokens": 906,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1067,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-26-53-171769_chatcmpl-485ec180-7d19-4316-94ce-5edb731bf65d",
          "traceId": "542e83dd",
          "type": "GENERATION",
          "name": "542e_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:26:53.171000+00:00",
          "endTime": "2026-02-03T11:27:07.701000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14530.0,
          "completionTokens": 772,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 933,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-27-11-776544_chatcmpl-ecd13205-68b7-4f5d-ba28-4f5e6b30a43f",
          "traceId": "542e83dd",
          "type": "GENERATION",
          "name": "542e_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:27:11.776000+00:00",
          "endTime": "2026-02-03T11:27:24.157000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 12381.0,
          "completionTokens": 662,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 823,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-27-32-483333_chatcmpl-5ac3105f-cc97-4810-a7cf-8fddf3276e61",
          "traceId": "542e83dd",
          "type": "GENERATION",
          "name": "542e_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:27:32.483000+00:00",
          "endTime": "2026-02-03T11:27:46.515000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14032.0,
          "completionTokens": 749,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 910,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "98f9c6f5-1597-4f1f-a100-4f180e2a0105",
          "traceId": "542e83dd",
          "type": "SPAN",
          "name": "error_54_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:27:54.260000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_e4d2b4cb_1770118066.py\", line 20, in <module>\n    experimental_delegates=[load_delegate('libedgetpu.so.1.0')]\nNameError: name 'load_delegate' is not defined.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:27:59.852Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:26:07.177Z"
    },
    {
      "id": "804dc9a6",
      "timestamp": "2026-02-03T11:23:44.130000+00:00",
      "name": "804d_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nfrom tflite_runtime.interpreter import Interpreter\nfrom edgetpu.basic.edgetpu_utils import make_interpreter\n\ndef load_labels(path):\n    with open(path, 'r') as file:\n        lines = file.readlines()\n        labels = {}\n        for line in lines:\n            pair = line.strip().split(maxsplit=1)\n            if len(pair) == 2 and pair[0].isdigit():\n                labels[int(pair[0])] = pair[1]\n    return labels\n\ndef set_input_tensor(interpreter, image):\n    tensor_index = interpreter.get_input_details()[0]['index']\n    input_tensor = interpreter.tensor(tensor_index)()[0]\n    input_tensor[:, :] = image\n\ndef get_output_tensor(interpreter, index):\n    output_detail = interpreter.get_output_details()[index]\n    tensor = np.squeeze(interpreter.get_tensor(output_detail['index']))\n    return tensor\n\ndef detect_objects(interpreter, image, threshold):\n    set_input_tensor(interpreter, image)\n    interpreter.invoke()\n\n    boxes = get_output_tensor(interpreter, 0)\n    classes = get_output_tensor(interpreter, 1)\n    scores = get_output_tensor(interpreter, 2)\n    count = int(get_output_tensor(interpreter, 3))\n\n    results = []\n    for i in range(count):\n        if scores[i] >= threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': classes[i],\n                'score': scores[i]\n            }\n            results.append(result)\n    return results\n\ndef draw_objects(image, results, labels):\n    for obj in results:\n        bbox = obj['bounding_box']\n        class_id = int(obj['class_id'])\n        score = obj['score']\n\n        left, top, right, bottom = bbox\n        left, top, right, bottom = int(left * image.shape[1]), int(top * image.shape[0]), \\\n                                   int(right * image.shape[1]), int(bottom * image.shape[0])\n\n        cv2.rectangle(image, (left, top), (right, bottom), (255, 0, 0), 2)\n        text = f'{labels[class_id]}: {score:.2f}'\n        cv2.putText(image, text, (left, top - 5), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 0, 0), 1)\n\ndef main():\n    import numpy as np\n\n    model_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\n    label_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\n    input_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\n    output_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\n    confidence_threshold = 0.5\n\n    labels = load_labels(label_path)\n\n    interpreter = make_interpreter(model_path)\n    interpreter.allocate_tensors()\n\n    input_details = interpreter.get_input_details()\n    input_shape = input_details[0]['shape']\n    height, width, _ = input_shape\n\n    cap = cv2.VideoCapture(input_path)\n    fourcc = cv2.VideoWriter_fourcc(*'mp4v')\n    out = cv2.VideoWriter(output_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\n    while cap.isOpened():\n        ret, frame = cap.read()\n        if not ret:\n            break\n\n        image = cv2.resize(frame, (width, height))\n        results = detect_objects(interpreter, image, confidence_threshold)\n        draw_objects(frame, results, labels)\n\n        out.write(frame)\n\n    cap.release()\n    out.release()\n\nif __name__ == '__main__':\n    main()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_26ee83c6_1770117932.py\", line 3, in <module>\n    from edgetpu.basic.edgetpu_utils import make_interpreter\nImportError: cannot import name 'make_interpreter' from 'edgetpu.basic.edgetpu_utils' (/home/mendel/.local/lib/python3.7/site-packages/edgetpu/basic/edgetpu_utils.py)."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 10
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 116.757,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-23-44-131715_chatcmpl-2254395d-32da-42f9-8ad3-fa7cb68b0b54",
          "traceId": "804dc9a6",
          "type": "GENERATION",
          "name": "804d_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:23:44.131000+00:00",
          "endTime": "2026-02-03T11:23:58.458000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14327.0,
          "completionTokens": 778,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 939,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-24-06-419959_chatcmpl-3f221306-292d-456f-8139-d2c9a6b5aa2a",
          "traceId": "804dc9a6",
          "type": "GENERATION",
          "name": "804d_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:24:06.419000+00:00",
          "endTime": "2026-02-03T11:24:21.755000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15336.0,
          "completionTokens": 839,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1000,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-24-29-581006_chatcmpl-3ec27d41-8aaa-470d-9480-0c2930b87096",
          "traceId": "804dc9a6",
          "type": "GENERATION",
          "name": "804d_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:24:29.581000+00:00",
          "endTime": "2026-02-03T11:24:43.354000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13773.0,
          "completionTokens": 722,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 883,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-24-51-956456_chatcmpl-30897694-8199-431e-842b-5b5874ebbc96",
          "traceId": "804dc9a6",
          "type": "GENERATION",
          "name": "804d_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:24:51.956000+00:00",
          "endTime": "2026-02-03T11:25:08.323000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16367.0,
          "completionTokens": 858,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1019,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-25-16-096879_chatcmpl-eecbae0b-e0fc-4a75-bb91-10b6cec18b12",
          "traceId": "804dc9a6",
          "type": "GENERATION",
          "name": "804d_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:25:16.096000+00:00",
          "endTime": "2026-02-03T11:25:32.991000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16895.0,
          "completionTokens": 889,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1050,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "7df1835d-252e-4456-9870-17145330fbbe",
          "traceId": "804dc9a6",
          "type": "SPAN",
          "name": "error_80_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:25:40.888000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_26ee83c6_1770117932.py\", line 3, in <module>\n    from edgetpu.basic.edgetpu_utils import make_interpreter\nImportError: cannot import name 'make_interpreter' from 'edgetpu.basic.edgetpu_utils' (/home/mendel/.local/lib/python3.7/site-packages/edgetpu/basic/edgetpu_utils.py).",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:25:46.367Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:23:44.651Z"
    },
    {
      "id": "9e04164c",
      "timestamp": "2026-02-03T11:21:27.834000+00:00",
      "name": "9e04_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nfrom tflite_runtime.interpreter import Interpreter\nfrom PIL import Image\nimport numpy as np\nimport os\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize Coral Edge TPU interpreter\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\nheight, width = input_details[0]['shape'][1:3]\nvideo_capture = cv2.VideoCapture(input_path)\n\n# Check if video opened successfully\nif not video_capture.isOpened():\n    raise ValueError(\"Error opening video stream or file\")\n\nframe_width = int(video_capture.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(video_capture.get(cv2.CAP_PROP_FRAME_HEIGHT))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nvideo_writer = cv2.VideoWriter(output_path, fourcc, 30.0, (frame_width, frame_height))\n\nwhile video_capture.isOpened():\n    ret, frame = video_capture.read()\n    if not ret:\n        break\n\n    # Preprocess the frame\n    image_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)\n    image_resized = cv2.resize(image_rgb, (width, height))\n    input_data = np.expand_dims(image_resized, axis=0)\n\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]   # Confidence of detected objects\n\n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame_width, xmax * frame_width,\n                                          ymin * frame_height, ymax * frame_height)\n\n            # Draw bounding box\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {int(scores[i]*100)}%'\n            cv2.putText(frame, label, (int(left), int(top-10)), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n    # Write the frame with detections\n    video_writer.write(frame)\n\nvideo_capture.release()\nvideo_writer.release()\n\n# Utility function to load the Edge TPU delegate\ndef load_delegate(path):\n    from tflite_runtime.interpreter import load_delegate\n    return load_delegate(path)",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_232e2b22_1770117790.py\", line 21, in <module>\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\nNameError: name 'load_delegate' is not defined."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 9
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 110.112,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-21-27-835507_chatcmpl-171f2192-079e-404c-8c3d-040fa2a6a64b",
          "traceId": "9e04164c",
          "type": "GENERATION",
          "name": "9e04_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:21:27.835000+00:00",
          "endTime": "2026-02-03T11:21:41.546000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13711.0,
          "completionTokens": 745,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 906,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-21-49-364023_chatcmpl-10ae63da-0455-4827-8c7e-fb736d3fa3f6",
          "traceId": "9e04164c",
          "type": "GENERATION",
          "name": "9e04_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:21:49.364000+00:00",
          "endTime": "2026-02-03T11:22:04.468000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15104.0,
          "completionTokens": 823,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 984,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-22-12-269679_chatcmpl-59c8dfb8-efbc-464b-8a8c-7ca0316a3906",
          "traceId": "9e04164c",
          "type": "GENERATION",
          "name": "9e04_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:22:12.269000+00:00",
          "endTime": "2026-02-03T11:22:26.309000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14040.0,
          "completionTokens": 749,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 910,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-22-34-065028_chatcmpl-51d00eff-4c1e-4dc8-bf63-95e1adb882ed",
          "traceId": "9e04164c",
          "type": "GENERATION",
          "name": "9e04_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:22:34.065000+00:00",
          "endTime": "2026-02-03T11:22:46.917000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 12852.0,
          "completionTokens": 684,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 845,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-22-54-704662_chatcmpl-d5fecd22-356f-4c36-b034-2a5cdfe36851",
          "traceId": "9e04164c",
          "type": "GENERATION",
          "name": "9e04_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:22:54.704000+00:00",
          "endTime": "2026-02-03T11:23:10.070000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15366.0,
          "completionTokens": 826,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 987,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "e97f0110-06e3-406b-93f3-1cf6a861c5f0",
          "traceId": "9e04164c",
          "type": "SPAN",
          "name": "error_9e_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:23:17.947000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_232e2b22_1770117790.py\", line 21, in <module>\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\nNameError: name 'load_delegate' is not defined.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:23:23.560Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:21:28.356Z"
    },
    {
      "id": "1eace78b",
      "timestamp": "2026-02-03T11:19:17.291000+00:00",
      "name": "1eac_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\nfrom PIL import Image\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize the TFLite interpreter with Edge TPU delegate\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[\n        '/usr/lib/python3/dist-packages/tflite_runtime/delegates/__init__.py/edgetpu'\n    ]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Get input size\ninput_shape = input_details[0]['shape']\n\n# Open video files\ncap = cv2.VideoCapture(input_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the input image\n    img = Image.fromarray(frame)\n    img_resized = img.resize((input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(img_resized, axis=0)\n\n    # Set model input and invoke\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    height, width, _ = frame.shape\n\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            left, right, top, bottom = (xmin * width, xmax * width,\n                                        ymin * height, ymax * height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label_index = int(classes[i])\n            label_text = f\"{labels[label_index]}: {scores[i]:.2f}\"\n            cv2.putText(frame, label_text, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 255, 0), 2)\n\n    # Write the frame with detections to output video\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_8aca7c7c_1770117654.py\", line 21, in <module>\n    '/usr/lib/python3/dist-packages/tflite_runtime/delegates/__init__.py/edgetpu'\n  File \"/home/mendel/tinyml_autopilot/tinyml-env/lib/python3.7/site-packages/tflite_runtime/interpreter.py\", line 391, in __init__\n    delegate._get_native_delegate_pointer())  # pylint: disable=protected-access\nAttributeError: 'str' object has no attribute '_get_native_delegate_pointer'."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 8
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 104.88,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-19-17-292593_chatcmpl-4d160364-7cc0-431d-ba17-cbd2dc5a54b3",
          "traceId": "1eace78b",
          "type": "GENERATION",
          "name": "1eac_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:19:17.292000+00:00",
          "endTime": "2026-02-03T11:19:35.431000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 18139.0,
          "completionTokens": 858,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1019,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-19-43-708643_chatcmpl-587bd8e0-3fc3-4995-a8fb-54a92894ebdf",
          "traceId": "1eace78b",
          "type": "GENERATION",
          "name": "1eac_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:19:43.708000+00:00",
          "endTime": "2026-02-03T11:19:55.071000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 11363.0,
          "completionTokens": 549,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 710,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-19-55-077734_chatcmpl-bf9f9b70-bca7-4334-a847-736d4e99ef20",
          "traceId": "1eace78b",
          "type": "GENERATION",
          "name": "1eac_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:19:55.077000+00:00",
          "endTime": "2026-02-03T11:20:11.982000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16905.0,
          "completionTokens": 850,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1011,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-20-19-762915_chatcmpl-26e0e45d-8dfe-4034-a995-e63175305827",
          "traceId": "1eace78b",
          "type": "GENERATION",
          "name": "1eac_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:20:19.762000+00:00",
          "endTime": "2026-02-03T11:20:30.709000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10947.0,
          "completionTokens": 546,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 707,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-20-39-113996_chatcmpl-12cc5971-d402-4fb2-bbc6-e8c4866c0364",
          "traceId": "1eace78b",
          "type": "GENERATION",
          "name": "1eac_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:20:39.113000+00:00",
          "endTime": "2026-02-03T11:20:54.354000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15241.0,
          "completionTokens": 786,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 947,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "99dbf707-c7c2-4f89-b0d4-f45db204bf00",
          "traceId": "1eace78b",
          "type": "SPAN",
          "name": "error_1e_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:21:02.172000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_8aca7c7c_1770117654.py\", line 21, in <module>\n    '/usr/lib/python3/dist-packages/tflite_runtime/delegates/__init__.py/edgetpu'\n  File \"/home/mendel/tinyml_autopilot/tinyml-env/lib/python3.7/site-packages/tflite_runtime/interpreter.py\", line 391, in __init__\n    delegate._get_native_delegate_pointer())  # pylint: disable=protected-access\nAttributeError: 'str' object has no attribute '_get_native_delegate_pointer'.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:21:07.457Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:19:17.813Z"
    },
    {
      "id": "85c04775",
      "timestamp": "2026-02-03T11:16:51.986000+00:00",
      "name": "85c0_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nimport numpy as np\nimport time\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as file:\n    labels = [line.strip() for line in file.readlines()]\n\n# Initialize TFLite interpreter with EdgeTPU delegate\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\nheight, width = input_details[0]['shape'][1], input_details[0]['shape'][2]\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (width, height))\n    input_data = np.expand_dims(input_data, axis=0).astype(np.uint8)\n\n    # Perform inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    start_time = time.time()\n    interpreter.invoke()\n    elapsed_ms = (time.time() - start_time) * 1000\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0] # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0] # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0] # Confidence of detected objects\n\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n\n            # Draw bounding box\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (255, 0, 0), 2)\n\n            # Draw label\n            object_name = labels[int(classes[i])]\n            label = f\"{object_name}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 0, 0), 1)\n\n    # Write frame to output video\n    out.write(frame)\n    print(f\"Inference time: {elapsed_ms:.2f} ms\")\n\n    # Display the resulting frame\n    cv2.imshow('frame', frame)\n    if cv2.waitKey(1) & 0xFF == ord('q'):\n        break\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 7
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 66.366,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-16-51-987828_chatcmpl-34be60ad-2c6b-44e6-9c71-93910469223d",
          "traceId": "85c04775",
          "type": "GENERATION",
          "name": "85c0_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:16:51.987000+00:00",
          "endTime": "2026-02-03T11:17:08.355000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16368.0,
          "completionTokens": 793,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 954,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-17-16-514780_chatcmpl-47d36327-a3ca-47cd-8a4c-db63376c3b57",
          "traceId": "85c04775",
          "type": "GENERATION",
          "name": "85c0_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:17:16.514000+00:00",
          "endTime": "2026-02-03T11:17:34.375000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 17861.0,
          "completionTokens": 864,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1025,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-17-42-135087_chatcmpl-77e756a2-5174-4287-ad63-b3931d8d8c8e",
          "traceId": "85c04775",
          "type": "GENERATION",
          "name": "85c0_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:17:42.135000+00:00",
          "endTime": "2026-02-03T11:17:58.353000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16218.0,
          "completionTokens": 775,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 936,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T11:18:56.682Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:16:52.507Z"
    },
    {
      "id": "3496ca6d",
      "timestamp": "2026-02-03T11:15:16.562000+00:00",
      "name": "3496_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\ndef load_labels(path):\n    with open(path, 'r') as f:\n        return {i: line.strip() for i, line in enumerate(f.readlines())}\n\n# Initialize the TFLite interpreter\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1.0')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\nheight, width = input_shape[1], input_shape[2]\n\n# Open video files\nvideo_in = cv2.VideoCapture(input_path)\nfps = int(video_in.get(cv2.CAP_PROP_FPS))\nframe_width = int(video_in.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(video_in.get(cv2.CAP_PROP_FRAME_HEIGHT))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nvideo_out = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\nwhile video_in.isOpened():\n    ret, frame = video_in.read()\n    if not ret:\n        break\n\n    # Preprocess the frame\n    input_frame = cv2.resize(frame, (width, height))\n    input_frame = np.expand_dims(input_frame, axis=0)\n\n    # Perform inference\n    interpreter.set_tensor(input_details[0]['index'], input_frame)\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame_width, xmax * frame_width,\n                                          ymin * frame_height, ymax * frame_height)\n\n            # Draw bounding box and label on the image\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            object_name = labels[int(classes[i])]\n            label = f'{object_name}: {int(scores[i] * 100)}%'\n            label_size, base_line = cv2.getTextSize(label, cv2.FONT_HERSHEY_SIMPLEX, 0.7, 2)\n            top = max(top, label_size[1])\n            cv2.rectangle(frame, (int(left), int(top - label_size[1])), (int(left + label_size[0]), int(top + base_line)), (255, 255, 255), cv2.FILLED)\n            cv2.putText(frame, label, (int(left), int(top)), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (0, 0, 0), 2)\n\n    # Write the frame with detections to the output video\n    video_out.write(frame)\n\n# Release resources\nvideo_in.release()\nvideo_out.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 6
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 16.853,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-15-16-563724_chatcmpl-25f0d002-398c-49e2-88ff-d3cbb338be42",
          "traceId": "3496ca6d",
          "type": "GENERATION",
          "name": "3496_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:15:16.563000+00:00",
          "endTime": "2026-02-03T11:15:33.416000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16853.0,
          "completionTokens": 815,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 976,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T11:16:31.259Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:15:17.085Z"
    },
    {
      "id": "d9a39b6f",
      "timestamp": "2026-02-03T11:12:52.972000+00:00",
      "name": "d9a3_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels from the label map file\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize the TFLite interpreter with EdgeTPU delegate\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\n)\ninterpreter.allocate_tensors()\n\n# Get input and output details from the model\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\ninput_shape = input_details[0]['shape']\ninput_size = input_shape[1:3]\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\n\n# Define codec and create VideoWriter object to save output video\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 30.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the frame\n    img_resized = cv2.resize(frame, input_size)\n    input_data = np.expand_dims(img_resized, axis=0)\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]   # Confidence of detected objects\n\n    height, width, _ = frame.shape\n\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            left, right, top, bottom = (xmin * width), (xmax * width), (ymin * height), (ymax * height)\n\n            # Draw bounding box and label on the frame\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f\"{labels[int(classes[i])]}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 1)\n\n    # Write the frame with detections\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_6b491a5d_1770117281.py\", line 44, in <module>\n    img_resized = cv2.resize(frame, input_size)\nSystemError: new style getargs format but argument is not a tuple."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 5
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 117.041,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-12-52-973997_chatcmpl-c46327c0-9ee5-4959-8612-169b89cec181",
          "traceId": "d9a39b6f",
          "type": "GENERATION",
          "name": "d9a3_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:12:52.973000+00:00",
          "endTime": "2026-02-03T11:13:09.264000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16291.0,
          "completionTokens": 786,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 947,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-13-16-992973_chatcmpl-f8588ad6-90b9-430c-9233-625a64f7fdba",
          "traceId": "d9a39b6f",
          "type": "GENERATION",
          "name": "d9a3_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:13:16.992000+00:00",
          "endTime": "2026-02-03T11:13:30.737000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13745.0,
          "completionTokens": 670,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 831,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-13-39-158396_chatcmpl-9033964f-da2a-45fa-bb7a-178287341861",
          "traceId": "d9a39b6f",
          "type": "GENERATION",
          "name": "d9a3_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:13:39.158000+00:00",
          "endTime": "2026-02-03T11:13:53.132000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13974.0,
          "completionTokens": 682,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 843,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-14-01-433144_chatcmpl-5bf5be0c-5eae-4771-bfd9-ce40261d7f67",
          "traceId": "d9a39b6f",
          "type": "GENERATION",
          "name": "d9a3_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:14:01.433000+00:00",
          "endTime": "2026-02-03T11:14:18.279000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16846.0,
          "completionTokens": 818,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 979,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-14-26-712688_chatcmpl-88b14d45-4825-412c-b006-92af584f683e",
          "traceId": "d9a39b6f",
          "type": "GENERATION",
          "name": "d9a3_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:14:26.712000+00:00",
          "endTime": "2026-02-03T11:14:41.747000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15035.0,
          "completionTokens": 733,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 894,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "8a71bbe2-b041-41c3-8383-c182bcac250c",
          "traceId": "d9a39b6f",
          "type": "SPAN",
          "name": "error_d9_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:14:50.014000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_6b491a5d_1770117281.py\", line 44, in <module>\n    img_resized = cv2.resize(frame, input_size)\nSystemError: new style getargs format but argument is not a tuple.",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:14:55.225Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:12:53.496Z"
    },
    {
      "id": "c31864d2",
      "timestamp": "2026-02-03T11:10:54.304000+00:00",
      "name": "c318_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\nimport numpy as np\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels from label file\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize the TFLite interpreter with Edge TPU delegate\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\nheight, width = input_details[0]['shape'][1:3]\n\n# Open video files\nvideo_in = cv2.VideoCapture(input_path)\nfps = int(video_in.get(cv2.CAP_PROP_FPS))\nframe_width = int(video_in.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(video_in.get(cv2.CAP_PROP_FRAME_HEIGHT))\n\nvideo_out = cv2.VideoWriter(output_path, cv2.VideoWriter_fourcc(*'mp4v'), fps, (frame_width, frame_height))\n\ndef get_output(interpreter):\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]   # Confidence of detected objects\n\n    return boxes, classes, scores\n\nwhile video_in.isOpened():\n    ret, frame = video_in.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (width, height))\n    input_data = np.expand_dims(input_data, axis=0)\n\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    boxes, classes, scores = get_output(interpreter)\n\n    # Draw bounding boxes on the frame\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame_width, xmax * frame_width,\n                                          ymin * frame_height, ymax * frame_height)\n\n            # Draw a rectangle and label on the image\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            object_name = labels[int(classes[i])]\n            label = f'{object_name}: {int(scores[i]*100)}%'\n            label_size, base_line = cv2.getTextSize(label, cv2.FONT_HERSHEY_SIMPLEX, 0.7, 2)\n            top = max(top, label_size[1])\n            cv2.rectangle(frame, (int(left), int(top - round(1.5*label_size[1]))),\n                          (int(left + round(1.5*label_size[0])), int(top + base_line)), \n                          (255, 255, 255), cv2.FILLED)\n            cv2.putText(frame, label, (int(left), int(top + base_line)),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.7, (0, 0, 0), 2)\n\n    # Write the frame with bounding boxes\n    video_out.write(frame)\n\nvideo_in.release()\nvideo_out.release()"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 4
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 40.208,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-10-54-306539_chatcmpl-7a174945-15bf-48de-b4d9-42ba6b449f72",
          "traceId": "c31864d2",
          "type": "GENERATION",
          "name": "c318_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:10:54.306000+00:00",
          "endTime": "2026-02-03T11:11:09.118000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14812.0,
          "completionTokens": 701,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 862,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-11-16-857213_chatcmpl-d0900c60-a2ad-4a0f-8813-bc71d5279d18",
          "traceId": "c31864d2",
          "type": "GENERATION",
          "name": "c318_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:11:16.857000+00:00",
          "endTime": "2026-02-03T11:11:34.514000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 17657.0,
          "completionTokens": 855,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1016,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T11:12:32.502Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:10:54.830Z"
    },
    {
      "id": "f2854505",
      "timestamp": "2026-02-03T11:08:29.920000+00:00",
      "name": "f285_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nfrom edgetpu.basic.edgetpu_utils import make_interpreter\nfrom tflite_runtime.interpreter import Interpreter\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize Edge TPU interpreter\ninterpreter = make_interpreter(model_path)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\nheight, width = input_details[0]['shape'][1], input_details[0]['shape'][2]\n\n# Video capture and writer setup\ncap = cv2.VideoCapture(input_path)\nfps = int(cap.get(cv2.CAP_PROP_FPS))\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\n\nout = cv2.VideoWriter(output_path, cv2.VideoWriter_fourcc(*'mp4v'), fps, (frame_width, frame_height))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_frame = cv2.resize(frame, (width, height))\n    input_frame = np.expand_dims(input_frame, axis=0)\n\n    interpreter.set_tensor(input_details[0]['index'], input_frame)\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame_width, xmax * frame_width,\n                                          ymin * frame_height, ymax * frame_height)\n            object_name = labels[int(classes[i])]\n\n            # Draw bounding box and label on the image\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label_text = f'{object_name}: {scores[i]:.2f}'\n            cv2.putText(frame, label_text, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\n    # Write the frame with detections\n    out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_8bbd405e_1770117020.py\", line 3, in <module>\n    from edgetpu.basic.edgetpu_utils import make_interpreter\nImportError: cannot import name 'make_interpreter' from 'edgetpu.basic.edgetpu_utils' (/home/mendel/.local/lib/python3.7/site-packages/edgetpu/basic/edgetpu_utils.py)."
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 3
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 118.408,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-08-29-921439_chatcmpl-650ffec4-7c20-462c-bc90-d4be78cc2423",
          "traceId": "f2854505",
          "type": "GENERATION",
          "name": "f285_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:08:29.921000+00:00",
          "endTime": "2026-02-03T11:08:49.537000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 19616.0,
          "completionTokens": 941,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1102,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-08-57-316239_chatcmpl-5c6d4b08-3dce-44c2-b2b0-6714d7249299",
          "traceId": "f2854505",
          "type": "GENERATION",
          "name": "f285_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:08:57.316000+00:00",
          "endTime": "2026-02-03T11:09:15.079000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 17763.0,
          "completionTokens": 862,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1023,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-09-22-921265_chatcmpl-72acb75e-d232-48ac-9350-50f8cb94a2a9",
          "traceId": "f2854505",
          "type": "GENERATION",
          "name": "f285_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:09:22.921000+00:00",
          "endTime": "2026-02-03T11:09:39.976000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 17055.0,
          "completionTokens": 826,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 987,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-09-47-875194_chatcmpl-6fc83db4-6956-434f-8521-278fbc68e5fa",
          "traceId": "f2854505",
          "type": "GENERATION",
          "name": "f285_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:09:47.875000+00:00",
          "endTime": "2026-02-03T11:10:03.141000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15266.0,
          "completionTokens": 744,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 905,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-10-07-168241_chatcmpl-793839d3-7e94-4b0f-855b-77f0a26c5b2f",
          "traceId": "f2854505",
          "type": "GENERATION",
          "name": "f285_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:10:07.168000+00:00",
          "endTime": "2026-02-03T11:10:20.564000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 13396.0,
          "completionTokens": 653,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 814,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "dabd3b6f-5f63-4a6a-a013-adb446c9b4c5",
          "traceId": "f2854505",
          "type": "SPAN",
          "name": "error_f2_tpusg_failure_signal_tpu_sketch_generator",
          "startTime": "2026-02-03T11:10:28.329000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed: Max retries reached with error. Last error: Traceback (most recent call last):\n  File \"script_8bbd405e_1770117020.py\", line 3, in <module>\n    from edgetpu.basic.edgetpu_utils import make_interpreter\nImportError: cannot import name 'make_interpreter' from 'edgetpu.basic.edgetpu_utils' (/home/mendel/.local/lib/python3.7/site-packages/edgetpu/basic/edgetpu_utils.py).",
          "calculatedTotalCost": 0.0,
          "completionTokens": 0,
          "costDetails": {},
          "promptTokens": 0,
          "environment": "default",
          "totalTokens": 0,
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "updatedAt": "2026-02-03T11:10:33.686Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:08:30.445Z"
    },
    {
      "id": "75f054df",
      "timestamp": "2026-02-03T11:06:06.376000+00:00",
      "name": "75f0_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nimport numpy as np\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize the Edge TPU interpreter\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1')]\n)\ninterpreter.allocate_tensors()\n\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\nheight, width = input_details[0]['shape'][1:3]\n\n# Open video files\ncap = cv2.VideoCapture(input_path)\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, 20.0, (int(cap.get(3)), int(cap.get(4))))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_frame = cv2.resize(frame, (width, height))\n    input_frame = np.expand_dims(input_frame, axis=0).astype(np.uint8)\n\n    interpreter.set_tensor(input_details[0]['index'], input_frame)\n    interpreter.invoke()\n\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n\n            # Draw a bounding box around the object\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (255, 0, 0), 2)\n\n            # Draw label and confidence score on top of the bounding box\n            label = f'{labels[int(classes[i])]}: {int(scores[i] * 100)}%'\n            cv2.putText(frame, label, (int(left), int(top - 5)), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (255, 255, 255), 2)\n\n    # Write the frame with detection boxes\n    out.write(frame)\n    cv2.imshow('Object Detection', frame)\n\n    if cv2.waitKey(1) & 0xFF == ord('q'):\n        break\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 2
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 63.648,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-06-06-377984_chatcmpl-7df5a87e-f678-44eb-a043-9bd9d490611d",
          "traceId": "75f054df",
          "type": "GENERATION",
          "name": "75f0_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:06:06.377000+00:00",
          "endTime": "2026-02-03T11:06:21.544000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 15167.0,
          "completionTokens": 735,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 896,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-06-29-339417_chatcmpl-8584d98c-be5b-4207-8faf-a8aa5c97edb4",
          "traceId": "75f054df",
          "type": "GENERATION",
          "name": "75f0_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:06:29.339000+00:00",
          "endTime": "2026-02-03T11:06:47.370000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 18031.0,
          "completionTokens": 874,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1035,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-06-55-116520_chatcmpl-91938c71-1c28-459b-9b70-f7b347cf9b51",
          "traceId": "75f054df",
          "type": "GENERATION",
          "name": "75f0_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:06:55.116000+00:00",
          "endTime": "2026-02-03T11:07:10.025000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14909.0,
          "completionTokens": 724,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 885,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T11:08:09.055Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:06:06.901Z"
    },
    {
      "id": "e868e984",
      "timestamp": "2026-02-03T11:02:28.759000+00:00",
      "name": "e868_tpu_sketch_generator",
      "input": null,
      "output": {
        "status": "success",
        "sketch": "import cv2\nfrom tflite_runtime.interpreter import Interpreter\nfrom tflite_runtime.interpreter import load_delegate\nimport numpy as np\n\n# Configuration parameters\nmodel_path = '/home/mendel/tinyml_autopilot/models/edgetpu_detect.tflite'\nlabel_path = '/home/mendel/tinyml_autopilot/models/labelmap.txt'\ninput_path = '/home/mendel/tinyml_autopilot/data/sheeps.mp4'\noutput_path = '/home/mendel/tinyml_autopilot/results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Initialize TFLite interpreter with EdgeTPU delegate\ninterpreter = Interpreter(\n    model_path=model_path,\n    experimental_delegates=[load_delegate('libedgetpu.so.1.0')]\n)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\ninput_shape = input_details[0]['shape']\nheight, width = input_shape[1], input_shape[2]\n\n# Video capture and writer setup\ncap = cv2.VideoCapture(input_path)\nfps = int(cap.get(cv2.CAP_PROP_FPS))\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\n\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the frame\n    input_frame = cv2.resize(frame, (width, height))\n    input_frame = cv2.cvtColor(input_frame, cv2.COLOR_BGR2RGB)\n    input_frame = np.expand_dims(input_frame, axis=0).astype(np.uint8)\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_frame)\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    # Loop over all detections and draw detection box if confidence is above the threshold\n    for i in range(len(scores)):\n        if scores[i] >= confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame_width, xmax * frame_width,\n                                          ymin * frame_height, ymax * frame_height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label = f'{labels[int(classes[i])]}: {int(scores[i] * 100)}%'\n            label_size, base_line = cv2.getTextSize(label, cv2.FONT_HERSHEY_SIMPLEX, 0.7, 2)\n            top = max(top, label_size[1])\n            cv2.rectangle(frame, (int(left), int(top - round(1.5*label_size[1]))),\n                          (int(left + round(1.5 * label_size[0])), int(top + base_line)),\n                          (255, 255, 255), cv2.FILLED)\n            cv2.putText(frame, label, (int(left), int(top)), cv2.FONT_HERSHEY_SIMPLEX,\n                        0.7, (0, 0, 0), 2)\n\n    # Write the frame with detections\n    out.write(frame)\n\n# Release resources\ncap.release()\nout.release()\ncv2.destroyAllWindows()"
      },
      "session_id": "phi4_fcad_tpusg_batch",
      "metadata": {
        "num_run": 1
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "tpu_sketch_generator"
      ],
      "latency": 138.624,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-13-02-28-760810_chatcmpl-160e25f8-291e-4525-8645-c1b5e4c7e5cc",
          "traceId": "e868e984",
          "type": "GENERATION",
          "name": "e868_tpusg_gen_attempt#1",
          "startTime": "2026-02-03T11:02:28.760000+00:00",
          "endTime": "2026-02-03T11:03:18.098000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 49338.0,
          "completionTokens": 854,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1015,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-03-18-106637_chatcmpl-56a159bb-691a-4e29-bb06-d2c4ab8807e8",
          "traceId": "e868e984",
          "type": "GENERATION",
          "name": "e868_tpusg_gen_attempt#2",
          "startTime": "2026-02-03T11:03:18.106000+00:00",
          "endTime": "2026-02-03T11:03:33.048000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 14942.0,
          "completionTokens": 817,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 978,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-03-41-167147_chatcmpl-d12bf84c-eea2-4bc1-8d3e-94a617ae5d63",
          "traceId": "e868e984",
          "type": "GENERATION",
          "name": "e868_tpusg_gen_attempt#3",
          "startTime": "2026-02-03T11:03:41.167000+00:00",
          "endTime": "2026-02-03T11:03:53.946000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 12779.0,
          "completionTokens": 697,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 858,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-04-01-721255_chatcmpl-063703f7-4816-425c-ab9e-10c2d8f60151",
          "traceId": "e868e984",
          "type": "GENERATION",
          "name": "e868_tpusg_gen_attempt#4",
          "startTime": "2026-02-03T11:04:01.721000+00:00",
          "endTime": "2026-02-03T11:04:22.530000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 20809.0,
          "completionTokens": 1133,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 1294,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-13-04-30-837624_chatcmpl-eb6097f1-9e43-4d3b-859e-c76b18d739c6",
          "traceId": "e868e984",
          "type": "GENERATION",
          "name": "e868_tpusg_gen_attempt#5",
          "startTime": "2026-02-03T11:04:30.837000+00:00",
          "endTime": "2026-02-03T11:04:47.384000+00:00",
          "model": "phi4:latest",
          "modelParameters": {},
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16547.0,
          "completionTokens": 819,
          "costDetails": {},
          "promptTokens": 161,
          "environment": "default",
          "totalTokens": 980,
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        }
      ],
      "updatedAt": "2026-02-03T11:05:45.533Z",
      "environment": "default",
      "createdAt": "2026-02-03T11:02:29.286Z"
    }
  ],
  "meta": {
    "total_items": 30
  }
}