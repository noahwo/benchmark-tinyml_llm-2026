{
  "data": [
    {
      "id": "9ec97a25",
      "timestamp": "2026-02-24T13:31:54.067000+00:00",
      "name": "9ec9_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    height, width, _ = frame.shape\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width,\n                                          ymin * height, ymax * height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label = f\"{labels[int(classes[i])]}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 15:33:28.451663: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:33:28.455149: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:33:28.466933: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:33:28.486111: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:33:28.491641: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:33:28.505542: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:33:29.330350: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224153328_psg_phi4:latest/tmp_20260224153328_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224153328_psg_phi4:latest/tmp_20260224153328_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9caa_psg_batch",
      "metadata": {
        "num_run": 11
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 97.153,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-15-31-54-068385_chatcmpl-8743ce80-d301-4a75-99bf-f8866e8511ef",
          "traceId": "9ec97a25",
          "type": "GENERATION",
          "name": "9ec9_psg_gen_attempt#1",
          "startTime": "2026-02-24T13:31:54.068000+00:00",
          "endTime": "2026-02-24T13:32:10.536000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16468.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-32-13-601057_chatcmpl-35b0b692-ad38-4bbb-b161-3450c595bcef",
          "traceId": "9ec97a25",
          "type": "GENERATION",
          "name": "9ec9_psg_gen_attempt#2",
          "startTime": "2026-02-24T13:32:13.601000+00:00",
          "endTime": "2026-02-24T13:32:29.906000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16305.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-32-33-011022_chatcmpl-7f7d4790-c38a-4874-9294-0bd45a3d5187",
          "traceId": "9ec97a25",
          "type": "GENERATION",
          "name": "9ec9_psg_gen_attempt#3",
          "startTime": "2026-02-24T13:32:33.011000+00:00",
          "endTime": "2026-02-24T13:32:49.357000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16346.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-32-52-477791_chatcmpl-261f26e3-5649-49cf-9ba5-6434d0414437",
          "traceId": "9ec97a25",
          "type": "GENERATION",
          "name": "9ec9_psg_gen_attempt#4",
          "startTime": "2026-02-24T13:32:52.477000+00:00",
          "endTime": "2026-02-24T13:33:08.777000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16300.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-33-11-823305_chatcmpl-afd029b8-8927-42fc-a675-c5fde7df5178",
          "traceId": "9ec97a25",
          "type": "GENERATION",
          "name": "9ec9_psg_gen_attempt#5",
          "startTime": "2026-02-24T13:33:11.823000+00:00",
          "endTime": "2026-02-24T13:33:28.119000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16296.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "4d0f787d-8aaf-4d10-8c67-0ea2285bf742",
          "traceId": "9ec97a25",
          "type": "SPAN",
          "name": "error_9e_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T13:33:31.221000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 15:33:28.451663: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:33:28.455149: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:33:28.466933: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:33:28.486111: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:33:28.491641: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:33:28.505542: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:33:29.330350: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224153328_psg_phi4:latest/tmp_20260224153328_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224153328_psg_phi4:latest/tmp_20260224153328_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T13:31:54.581Z",
      "updatedAt": "2026-02-24T13:33:36.771Z"
    },
    {
      "id": "cf87be65",
      "timestamp": "2026-02-24T13:29:50.664000+00:00",
      "name": "cf87_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef get_output(interpreter, score_threshold):\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    results = []\n    for i in range(len(scores)):\n        if scores[i] >= score_threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': classes[i],\n                'score': scores[i]\n            }\n            results.append(result)\n    return results\n\ndef draw_boxes(frame, results):\n    for obj in results:\n        ymin, xmin, ymax, xmax = obj['bounding_box']\n        xmin = int(xmin * frame.shape[1])\n        xmax = int(xmax * frame.shape[1])\n        ymin = int(ymin * frame.shape[0])\n        ymax = int(ymax * frame.shape[0])\n\n        cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (10, 255, 0), 2)\n        label = f\"{labels[int(obj['class_id'])]}: {int(obj['score'] * 100)}%\"\n        cv2.putText(frame, label, (xmin, ymin - 5), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (10, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (input_details[0]['shape'][2], input_details[0]['shape'][1]))\n    input_data = np.expand_dims(input_data, axis=0)\n    input_data = (np.float32(input_data) - 127.5) / 127.5\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Get results\n    results = get_output(interpreter, confidence_threshold)\n\n    # Draw boxes on the frame\n    draw_boxes(frame, results)\n\n    # Write the frame with detections\n    out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 15:31:25.692126: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:31:25.695504: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:31:25.706879: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:31:25.725241: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:31:25.730945: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:31:25.744041: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:31:26.531978: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224153125_psg_phi4:latest/tmp_20260224153125_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9caa_psg_batch",
      "metadata": {
        "num_run": 10
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 97.726,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-15-29-50-665699_chatcmpl-7c8535a9-170a-432a-b23e-d222bed69a7e",
          "traceId": "cf87be65",
          "type": "GENERATION",
          "name": "cf87_psg_gen_attempt#1",
          "startTime": "2026-02-24T13:29:50.665000+00:00",
          "endTime": "2026-02-24T13:30:06.998000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16333.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-30-10-133623_chatcmpl-3f70afb0-86c9-4743-84b5-0de924a1dbcb",
          "traceId": "cf87be65",
          "type": "GENERATION",
          "name": "cf87_psg_gen_attempt#2",
          "startTime": "2026-02-24T13:30:10.133000+00:00",
          "endTime": "2026-02-24T13:30:26.454000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16321.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-30-29-483109_chatcmpl-b9f3774c-2bf3-485c-8755-d382d7230eb8",
          "traceId": "cf87be65",
          "type": "GENERATION",
          "name": "cf87_psg_gen_attempt#3",
          "startTime": "2026-02-24T13:30:29.483000+00:00",
          "endTime": "2026-02-24T13:30:45.860000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16377.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-30-48-934581_chatcmpl-318db8d9-9db1-4f50-adc2-961d11d47e9d",
          "traceId": "cf87be65",
          "type": "GENERATION",
          "name": "cf87_psg_gen_attempt#4",
          "startTime": "2026-02-24T13:30:48.934000+00:00",
          "endTime": "2026-02-24T13:31:05.246000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16312.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-31-08-985817_chatcmpl-a5ab9f79-4aff-45b4-83cd-c8391062ac07",
          "traceId": "cf87be65",
          "type": "GENERATION",
          "name": "cf87_psg_gen_attempt#5",
          "startTime": "2026-02-24T13:31:08.985000+00:00",
          "endTime": "2026-02-24T13:31:25.367000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16382.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "3331bbf4-7314-48eb-88b7-9dae8070faa4",
          "traceId": "cf87be65",
          "type": "SPAN",
          "name": "error_cf_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T13:31:28.391000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 15:31:25.692126: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:31:25.695504: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:31:25.706879: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:31:25.725241: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:31:25.730945: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:31:25.744041: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:31:26.531978: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224153125_psg_phi4:latest/tmp_20260224153125_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T13:29:51.181Z",
      "updatedAt": "2026-02-24T13:31:33.816Z"
    },
    {
      "id": "ce248550",
      "timestamp": "2026-02-24T13:27:42.108000+00:00",
      "name": "ce24_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    height, width, _ = frame.shape\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width,\n                                          ymin * height, ymax * height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label = f\"{labels[int(classes[i])]}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 15:29:21.637006: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:29:21.640503: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:29:21.652137: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:29:21.670658: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:29:21.676348: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:29:21.689461: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:29:22.496154: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152921_psg_phi4:latest/tmp_20260224152921_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152921_psg_phi4:latest/tmp_20260224152921_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9caa_psg_batch",
      "metadata": {
        "num_run": 9
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 102.318,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-15-27-42-109222_chatcmpl-694e9ff6-441a-4d5e-bf14-0ed0d944b691",
          "traceId": "ce248550",
          "type": "GENERATION",
          "name": "ce24_psg_gen_attempt#1",
          "startTime": "2026-02-24T13:27:42.109000+00:00",
          "endTime": "2026-02-24T13:27:58.551000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16442.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-28-04-031519_chatcmpl-dbf7ce44-2c86-4bec-8b1c-68984e2cd718",
          "traceId": "ce248550",
          "type": "GENERATION",
          "name": "ce24_psg_gen_attempt#2",
          "startTime": "2026-02-24T13:28:04.031000+00:00",
          "endTime": "2026-02-24T13:28:20.373000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16342.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-28-23-454389_chatcmpl-d32d6407-3d8c-4d11-a23a-c20314a4c288",
          "traceId": "ce248550",
          "type": "GENERATION",
          "name": "ce24_psg_gen_attempt#3",
          "startTime": "2026-02-24T13:28:23.454000+00:00",
          "endTime": "2026-02-24T13:28:39.821000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16367.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-28-43-167055_chatcmpl-b3889337-04f9-47f2-a8ab-eba819fc07a0",
          "traceId": "ce248550",
          "type": "GENERATION",
          "name": "ce24_psg_gen_attempt#4",
          "startTime": "2026-02-24T13:28:43.167000+00:00",
          "endTime": "2026-02-24T13:28:59.527000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16360.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-29-04-971998_chatcmpl-a64f55b3-bb3b-4da3-ab7c-8d33de9a5686",
          "traceId": "ce248550",
          "type": "GENERATION",
          "name": "ce24_psg_gen_attempt#5",
          "startTime": "2026-02-24T13:29:04.971000+00:00",
          "endTime": "2026-02-24T13:29:21.305000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16334.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "fa8b1dd7-a9dd-434f-9e6f-d535480f5497",
          "traceId": "ce248550",
          "type": "SPAN",
          "name": "error_ce_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T13:29:24.427000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 15:29:21.637006: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:29:21.640503: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:29:21.652137: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:29:21.670658: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:29:21.676348: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:29:21.689461: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:29:22.496154: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152921_psg_phi4:latest/tmp_20260224152921_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152921_psg_phi4:latest/tmp_20260224152921_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T13:27:42.623Z",
      "updatedAt": "2026-02-24T13:29:29.857Z"
    },
    {
      "id": "f0f324e5",
      "timestamp": "2026-02-24T13:25:38.604000+00:00",
      "name": "f0f3_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    height, width, _ = frame.shape\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width,\n                                          ymin * height, ymax * height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label = f\"{labels[int(classes[i])]}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 15:27:13.367868: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:27:13.371312: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:27:13.382679: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:27:13.400855: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:27:13.406451: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:27:13.419485: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:27:14.236736: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152713_psg_phi4:latest/tmp_20260224152713_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152713_psg_phi4:latest/tmp_20260224152713_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9caa_psg_batch",
      "metadata": {
        "num_run": 8
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 97.589,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-15-25-38-605741_chatcmpl-82defa01-83e6-48b2-a3e8-07289e3e1b14",
          "traceId": "f0f324e5",
          "type": "GENERATION",
          "name": "f0f3_psg_gen_attempt#1",
          "startTime": "2026-02-24T13:25:38.605000+00:00",
          "endTime": "2026-02-24T13:25:55.295000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16690.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-25-58-836949_chatcmpl-06d71e61-352d-43d8-8024-ef3b4a56ab41",
          "traceId": "f0f324e5",
          "type": "GENERATION",
          "name": "f0f3_psg_gen_attempt#2",
          "startTime": "2026-02-24T13:25:58.836000+00:00",
          "endTime": "2026-02-24T13:26:15.193000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16357.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-26-18-260332_chatcmpl-fbf7faa8-199d-4822-af5f-d28394e0e57e",
          "traceId": "f0f324e5",
          "type": "GENERATION",
          "name": "f0f3_psg_gen_attempt#3",
          "startTime": "2026-02-24T13:26:18.260000+00:00",
          "endTime": "2026-02-24T13:26:34.570000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16310.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-26-37-653623_chatcmpl-b96d9669-1284-4c06-8917-5da2919d8b40",
          "traceId": "f0f324e5",
          "type": "GENERATION",
          "name": "f0f3_psg_gen_attempt#4",
          "startTime": "2026-02-24T13:26:37.653000+00:00",
          "endTime": "2026-02-24T13:26:53.695000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16042.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-26-56-761357_chatcmpl-e4194bb2-b27c-463b-9811-7733fc4a3463",
          "traceId": "f0f324e5",
          "type": "GENERATION",
          "name": "f0f3_psg_gen_attempt#5",
          "startTime": "2026-02-24T13:26:56.761000+00:00",
          "endTime": "2026-02-24T13:27:13.040000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16279.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "56e781f7-534b-4b57-967e-003199ab6410",
          "traceId": "f0f324e5",
          "type": "SPAN",
          "name": "error_f0_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T13:27:16.194000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 15:27:13.367868: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:27:13.371312: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:27:13.382679: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:27:13.400855: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:27:13.406451: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:27:13.419485: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:27:14.236736: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152713_psg_phi4:latest/tmp_20260224152713_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152713_psg_phi4:latest/tmp_20260224152713_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T13:25:39.121Z",
      "updatedAt": "2026-02-24T13:27:21.799Z"
    },
    {
      "id": "0ac2fb97",
      "timestamp": "2026-02-24T13:23:35.231000+00:00",
      "name": "0ac2_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    height, width, _ = frame.shape\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width,\n                                          ymin * height, ymax * height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label = f\"{labels[int(classes[i])]}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 15:25:09.726510: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:25:09.729931: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:25:09.741222: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:25:09.759494: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:25:09.764902: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:25:09.778027: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:25:10.569753: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152509_psg_phi4:latest/tmp_20260224152509_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152509_psg_phi4:latest/tmp_20260224152509_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9caa_psg_batch",
      "metadata": {
        "num_run": 7
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 97.214,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-15-23-35-232743_chatcmpl-c67cf8e8-e661-4399-8b3f-dbe7173eb6b6",
          "traceId": "0ac2fb97",
          "type": "GENERATION",
          "name": "0ac2_psg_gen_attempt#1",
          "startTime": "2026-02-24T13:23:35.232000+00:00",
          "endTime": "2026-02-24T13:23:51.544000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16312.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-23-54-693542_chatcmpl-831007b3-a998-47a9-8c1a-f40f10208e2f",
          "traceId": "0ac2fb97",
          "type": "GENERATION",
          "name": "0ac2_psg_gen_attempt#2",
          "startTime": "2026-02-24T13:23:54.693000+00:00",
          "endTime": "2026-02-24T13:24:10.955000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16262.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-24-14-101442_chatcmpl-03d5c7d1-05a3-4d33-b51b-0317a430771b",
          "traceId": "0ac2fb97",
          "type": "GENERATION",
          "name": "0ac2_psg_gen_attempt#3",
          "startTime": "2026-02-24T13:24:14.101000+00:00",
          "endTime": "2026-02-24T13:24:30.445000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16344.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-24-33-614329_chatcmpl-4eba9f0d-4bb2-4ffc-9add-7c9fa29f433f",
          "traceId": "0ac2fb97",
          "type": "GENERATION",
          "name": "0ac2_psg_gen_attempt#4",
          "startTime": "2026-02-24T13:24:33.614000+00:00",
          "endTime": "2026-02-24T13:24:49.971000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16357.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-24-53-067027_chatcmpl-be4fc5b5-f865-46fb-a635-36430c7cbe08",
          "traceId": "0ac2fb97",
          "type": "GENERATION",
          "name": "0ac2_psg_gen_attempt#5",
          "startTime": "2026-02-24T13:24:53.067000+00:00",
          "endTime": "2026-02-24T13:25:09.401000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16334.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "58a33fb9-4d24-4e29-8f48-90099d92562e",
          "traceId": "0ac2fb97",
          "type": "SPAN",
          "name": "error_0a_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T13:25:12.446000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 15:25:09.726510: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:25:09.729931: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:25:09.741222: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:25:09.759494: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:25:09.764902: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:25:09.778027: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:25:10.569753: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152509_psg_phi4:latest/tmp_20260224152509_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152509_psg_phi4:latest/tmp_20260224152509_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T13:23:35.749Z",
      "updatedAt": "2026-02-24T13:25:17.944Z"
    },
    {
      "id": "e50c323e",
      "timestamp": "2026-02-24T13:21:31.749000+00:00",
      "name": "e50c_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    height, width, _ = frame.shape\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width,\n                                          ymin * height, ymax * height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label = f\"{labels[int(classes[i])]}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 15:23:06.289103: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:23:06.292544: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:23:06.304074: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:23:06.322470: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:23:06.328051: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:23:06.341031: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:23:07.147190: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152305_psg_phi4:latest/tmp_20260224152305_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152305_psg_phi4:latest/tmp_20260224152305_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9caa_psg_batch",
      "metadata": {
        "num_run": 6
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 97.277,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-15-21-31-750274_chatcmpl-74fa1c85-087f-427e-80b7-05aadf786eb9",
          "traceId": "e50c323e",
          "type": "GENERATION",
          "name": "e50c_psg_gen_attempt#1",
          "startTime": "2026-02-24T13:21:31.750000+00:00",
          "endTime": "2026-02-24T13:21:48.289000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16539.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-21-51-345544_chatcmpl-a1dcbefa-adf7-4c33-9585-4b633ee3bfd4",
          "traceId": "e50c323e",
          "type": "GENERATION",
          "name": "e50c_psg_gen_attempt#2",
          "startTime": "2026-02-24T13:21:51.345000+00:00",
          "endTime": "2026-02-24T13:22:07.861000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16516.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-22-10-937654_chatcmpl-1498e7f4-c5f3-4089-b63c-27f13954d46a",
          "traceId": "e50c323e",
          "type": "GENERATION",
          "name": "e50c_psg_gen_attempt#3",
          "startTime": "2026-02-24T13:22:10.937000+00:00",
          "endTime": "2026-02-24T13:22:27.231000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16294.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-22-30-298138_chatcmpl-a8cbd08a-155a-4fd1-bc4a-4df2ccba6721",
          "traceId": "e50c323e",
          "type": "GENERATION",
          "name": "e50c_psg_gen_attempt#4",
          "startTime": "2026-02-24T13:22:30.298000+00:00",
          "endTime": "2026-02-24T13:22:46.679000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16381.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-22-49-724734_chatcmpl-4a21ede1-976d-4917-bb39-d551335184e5",
          "traceId": "e50c323e",
          "type": "GENERATION",
          "name": "e50c_psg_gen_attempt#5",
          "startTime": "2026-02-24T13:22:49.724000+00:00",
          "endTime": "2026-02-24T13:23:05.964000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16240.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "63a85948-da7a-483d-b81c-c6208f47f114",
          "traceId": "e50c323e",
          "type": "SPAN",
          "name": "error_e5_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T13:23:09.027000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 15:23:06.289103: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:23:06.292544: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:23:06.304074: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:23:06.322470: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:23:06.328051: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:23:06.341031: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:23:07.147190: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152305_psg_phi4:latest/tmp_20260224152305_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152305_psg_phi4:latest/tmp_20260224152305_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T13:21:32.266Z",
      "updatedAt": "2026-02-24T13:23:14.493Z"
    },
    {
      "id": "901597c7",
      "timestamp": "2026-02-24T13:19:25.265000+00:00",
      "name": "9015_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    height, width, _ = frame.shape\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width,\n                                          ymin * height, ymax * height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label = f\"{labels[int(classes[i])]}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 15:21:03.012241: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:21:03.015956: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:21:03.027453: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:21:03.046306: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:21:03.052241: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:21:03.066282: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:21:03.889042: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152102_psg_phi4:latest/tmp_20260224152102_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152102_psg_phi4:latest/tmp_20260224152102_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9caa_psg_batch",
      "metadata": {
        "num_run": 5
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 100.607,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-15-19-25-266406_chatcmpl-7ae20969-a5ac-47f1-bcf3-e32df7115197",
          "traceId": "901597c7",
          "type": "GENERATION",
          "name": "9015_psg_gen_attempt#1",
          "startTime": "2026-02-24T13:19:25.266000+00:00",
          "endTime": "2026-02-24T13:19:41.888000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16622.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-19-44-916986_chatcmpl-8650fa08-cf36-42cc-9891-77c72f69a920",
          "traceId": "901597c7",
          "type": "GENERATION",
          "name": "9015_psg_gen_attempt#2",
          "startTime": "2026-02-24T13:19:44.916000+00:00",
          "endTime": "2026-02-24T13:20:01.302000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16386.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-20-04-358487_chatcmpl-14e21e39-1a43-4c40-8538-b9187019e05d",
          "traceId": "901597c7",
          "type": "GENERATION",
          "name": "9015_psg_gen_attempt#3",
          "startTime": "2026-02-24T13:20:04.358000+00:00",
          "endTime": "2026-02-24T13:20:20.671000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16313.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-20-26-599724_chatcmpl-5a5caf79-11a4-4127-9bd0-175f13f98295",
          "traceId": "901597c7",
          "type": "GENERATION",
          "name": "9015_psg_gen_attempt#4",
          "startTime": "2026-02-24T13:20:26.599000+00:00",
          "endTime": "2026-02-24T13:20:43.360000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16761.0,
          "promptTokens": 180,
          "completionTokens": 807,
          "costDetails": {},
          "totalTokens": 987,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-20-46-497201_chatcmpl-1b2a0354-d695-422c-896b-05257f31e032",
          "traceId": "901597c7",
          "type": "GENERATION",
          "name": "9015_psg_gen_attempt#5",
          "startTime": "2026-02-24T13:20:46.497000+00:00",
          "endTime": "2026-02-24T13:21:02.678000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16181.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "a45d3de2-565e-4c6a-9d1d-9063e4e811d5",
          "traceId": "901597c7",
          "type": "SPAN",
          "name": "error_90_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T13:21:05.873000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 15:21:03.012241: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:21:03.015956: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:21:03.027453: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:21:03.046306: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:21:03.052241: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:21:03.066282: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:21:03.889042: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152102_psg_phi4:latest/tmp_20260224152102_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224152102_psg_phi4:latest/tmp_20260224152102_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T13:19:25.783Z",
      "updatedAt": "2026-02-24T13:21:11.449Z"
    },
    {
      "id": "65626434",
      "timestamp": "2026-02-24T13:17:20.459000+00:00",
      "name": "6562_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef get_output(interpreter, score_threshold):\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    results = []\n    for i in range(len(scores)):\n        if scores[i] >= score_threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': classes[i],\n                'score': scores[i]\n            }\n            results.append(result)\n    return results\n\ndef draw_boxes(frame, results):\n    for obj in results:\n        ymin, xmin, ymax, xmax = obj['bounding_box']\n        xmin = int(xmin * frame.shape[1])\n        xmax = int(xmax * frame.shape[1])\n        ymin = int(ymin * frame.shape[0])\n        ymax = int(ymax * frame.shape[0])\n\n        cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (10, 255, 0), 2)\n        label = f\"{labels[int(obj['class_id'])]}: {int(obj['score'] * 100)}%\"\n        cv2.putText(frame, label, (xmin, ymin - 5), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (10, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (input_details[0]['shape'][2], input_details[0]['shape'][1]))\n    input_data = np.expand_dims(input_data, axis=0)\n    input_data = (np.float32(input_data) - 127.5) / 127.5\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Get results\n    results = get_output(interpreter, confidence_threshold)\n\n    # Draw boxes on the frame\n    draw_boxes(frame, results)\n\n    # Write the frame with detections\n    out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 15:18:55.932073: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:18:55.935700: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:18:55.947279: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:18:55.966014: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:18:55.971922: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:18:55.985733: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:18:56.813837: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151855_psg_phi4:latest/tmp_20260224151855_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9caa_psg_batch",
      "metadata": {
        "num_run": 4
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 98.574,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-15-17-20-460515_chatcmpl-e19e3ea2-1c5b-44cc-bb8f-f86fc3c19ed4",
          "traceId": "65626434",
          "type": "GENERATION",
          "name": "6562_psg_gen_attempt#1",
          "startTime": "2026-02-24T13:17:20.460000+00:00",
          "endTime": "2026-02-24T13:17:36.891000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16431.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-17-40-053280_chatcmpl-95324cf6-c6a4-4009-ba39-4421bdb6141f",
          "traceId": "65626434",
          "type": "GENERATION",
          "name": "6562_psg_gen_attempt#2",
          "startTime": "2026-02-24T13:17:40.053000+00:00",
          "endTime": "2026-02-24T13:17:56.407000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16354.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-18-00-166215_chatcmpl-02cab3cf-3919-4507-a86a-6449e13dc999",
          "traceId": "65626434",
          "type": "GENERATION",
          "name": "6562_psg_gen_attempt#3",
          "startTime": "2026-02-24T13:18:00.166000+00:00",
          "endTime": "2026-02-24T13:18:16.460000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16294.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-18-19-620339_chatcmpl-57660043-131f-4266-a3b9-75a3be433ab0",
          "traceId": "65626434",
          "type": "GENERATION",
          "name": "6562_psg_gen_attempt#4",
          "startTime": "2026-02-24T13:18:19.620000+00:00",
          "endTime": "2026-02-24T13:18:36.047000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16427.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-18-39-242221_chatcmpl-adbb09bb-dba7-4274-98d2-b08da9d1785f",
          "traceId": "65626434",
          "type": "GENERATION",
          "name": "6562_psg_gen_attempt#5",
          "startTime": "2026-02-24T13:18:39.242000+00:00",
          "endTime": "2026-02-24T13:18:55.585000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16343.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "f8e432b7-889a-49d8-857b-8c751e70c879",
          "traceId": "65626434",
          "type": "SPAN",
          "name": "error_65_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T13:18:59.034000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 15:18:55.932073: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:18:55.935700: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:18:55.947279: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:18:55.966014: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:18:55.971922: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:18:55.985733: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:18:56.813837: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151855_psg_phi4:latest/tmp_20260224151855_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T13:17:20.978Z",
      "updatedAt": "2026-02-24T13:19:04.182Z"
    },
    {
      "id": "d9772ac1",
      "timestamp": "2026-02-24T13:15:12.940000+00:00",
      "name": "d977_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    height, width, _ = frame.shape\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width,\n                                          ymin * height, ymax * height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label = f\"{labels[int(classes[i])]}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 15:16:51.911734: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:16:51.915247: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:16:51.927224: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:16:51.946364: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:16:51.952280: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:16:51.965777: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:16:52.814397: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151651_psg_phi4:latest/tmp_20260224151651_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151651_psg_phi4:latest/tmp_20260224151651_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9caa_psg_batch",
      "metadata": {
        "num_run": 3
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 101.781,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-15-15-12-941114_chatcmpl-c91d9ac2-b0e8-4c2a-9c44-a25a55b4ffe6",
          "traceId": "d9772ac1",
          "type": "GENERATION",
          "name": "d977_psg_gen_attempt#1",
          "startTime": "2026-02-24T13:15:12.941000+00:00",
          "endTime": "2026-02-24T13:15:29.567000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16626.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-15-35-892307_chatcmpl-34d83a09-49b8-4194-808c-1ff5949e4817",
          "traceId": "d9772ac1",
          "type": "GENERATION",
          "name": "d977_psg_gen_attempt#2",
          "startTime": "2026-02-24T13:15:35.892000+00:00",
          "endTime": "2026-02-24T13:15:52.161000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16269.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-15-55-402205_chatcmpl-4d0e7039-185e-402f-9496-4702c4a96548",
          "traceId": "d9772ac1",
          "type": "GENERATION",
          "name": "d977_psg_gen_attempt#3",
          "startTime": "2026-02-24T13:15:55.402000+00:00",
          "endTime": "2026-02-24T13:16:12.233000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16831.0,
          "promptTokens": 180,
          "completionTokens": 807,
          "costDetails": {},
          "totalTokens": 987,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-16-15-406811_chatcmpl-4abd3974-2de0-4846-be8f-63040c0f0300",
          "traceId": "d9772ac1",
          "type": "GENERATION",
          "name": "d977_psg_gen_attempt#4",
          "startTime": "2026-02-24T13:16:15.406000+00:00",
          "endTime": "2026-02-24T13:16:31.905000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16499.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-16-35-180468_chatcmpl-238be7e3-5c48-4a66-99ee-e6c19efb311e",
          "traceId": "d9772ac1",
          "type": "GENERATION",
          "name": "d977_psg_gen_attempt#5",
          "startTime": "2026-02-24T13:16:35.180000+00:00",
          "endTime": "2026-02-24T13:16:51.574000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16394.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "fa39a3f1-e10d-4e99-9670-0aeb7e7c0dd7",
          "traceId": "d9772ac1",
          "type": "SPAN",
          "name": "error_d9_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T13:16:54.722000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 15:16:51.911734: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:16:51.915247: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:16:51.927224: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:16:51.946364: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:16:51.952280: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:16:51.965777: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:16:52.814397: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151651_psg_phi4:latest/tmp_20260224151651_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151651_psg_phi4:latest/tmp_20260224151651_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T13:15:13.459Z",
      "updatedAt": "2026-02-24T13:17:00.128Z"
    },
    {
      "id": "930503bb",
      "timestamp": "2026-02-24T13:13:01.144000+00:00",
      "name": "9305_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    height, width, _ = frame.shape\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width,\n                                          ymin * height, ymax * height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label = f\"{labels[int(classes[i])]}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 15:14:42.858698: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:14:42.862859: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:14:42.875480: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:14:42.894967: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:14:42.900942: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:14:42.916503: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:14:43.836067: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151442_psg_phi4:latest/tmp_20260224151442_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151442_psg_phi4:latest/tmp_20260224151442_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9caa_psg_batch",
      "metadata": {
        "num_run": 2
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 105.505,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-15-13-01-145226_chatcmpl-360e5d14-7de1-4313-90d1-8feec29912d1",
          "traceId": "930503bb",
          "type": "GENERATION",
          "name": "9305_psg_gen_attempt#1",
          "startTime": "2026-02-24T13:13:01.145000+00:00",
          "endTime": "2026-02-24T13:13:17.559000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16414.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-13-22-102633_chatcmpl-23219241-8286-41ba-b70f-93d09fda2767",
          "traceId": "930503bb",
          "type": "GENERATION",
          "name": "9305_psg_gen_attempt#2",
          "startTime": "2026-02-24T13:13:22.102000+00:00",
          "endTime": "2026-02-24T13:13:38.253000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16151.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-13-42-924514_chatcmpl-fe17343d-8dc8-4327-86fe-a10c94fb4af1",
          "traceId": "930503bb",
          "type": "GENERATION",
          "name": "9305_psg_gen_attempt#3",
          "startTime": "2026-02-24T13:13:42.924000+00:00",
          "endTime": "2026-02-24T13:13:59.369000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16445.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-14-03-699251_chatcmpl-79589732-df6e-402e-955a-87aaece27f1c",
          "traceId": "930503bb",
          "type": "GENERATION",
          "name": "9305_psg_gen_attempt#4",
          "startTime": "2026-02-24T13:14:03.699000+00:00",
          "endTime": "2026-02-24T13:14:20.185000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16486.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-14-26-161796_chatcmpl-a990f74b-60c3-460a-bb1d-d5e03285ac72",
          "traceId": "930503bb",
          "type": "GENERATION",
          "name": "9305_psg_gen_attempt#5",
          "startTime": "2026-02-24T13:14:26.161000+00:00",
          "endTime": "2026-02-24T13:14:42.454000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16293.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "7107054b-acf9-4016-99e4-5c098759d3f3",
          "traceId": "930503bb",
          "type": "SPAN",
          "name": "error_93_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T13:14:46.650000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 15:14:42.858698: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:14:42.862859: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:14:42.875480: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:14:42.894967: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:14:42.900942: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:14:42.916503: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:14:43.836067: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151442_psg_phi4:latest/tmp_20260224151442_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151442_psg_phi4:latest/tmp_20260224151442_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T13:13:01.664Z",
      "updatedAt": "2026-02-24T13:14:51.861Z"
    },
    {
      "id": "6fac9b0e",
      "timestamp": "2026-02-24T13:10:22.730000+00:00",
      "name": "6fac_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    height, width, _ = frame.shape\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * width, xmax * width,\n                                          ymin * height, ymax * height)\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n\n            label = f\"{labels[int(classes[i])]}: {scores[i]:.2f}\"\n            cv2.putText(frame, label, (int(left), int(top) - 10),\n                        cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 15:12:31.250446: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:12:31.253918: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:12:31.265352: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:12:31.284280: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:12:31.290060: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:12:31.303369: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:12:32.525957: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151230_psg_phi4:latest/tmp_20260224151230_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151230_psg_phi4:latest/tmp_20260224151230_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9caa_psg_batch",
      "metadata": {
        "num_run": 1
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 132.103,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-15-10-22-731511_chatcmpl-f9e4d94e-99a2-42dc-a627-290602f54484",
          "traceId": "6fac9b0e",
          "type": "GENERATION",
          "name": "6fac_psg_gen_attempt#1",
          "startTime": "2026-02-24T13:10:22.731000+00:00",
          "endTime": "2026-02-24T13:11:04.085000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 41354.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-11-12-934368_chatcmpl-de50bfc0-3674-46be-8774-6b4b68715b0c",
          "traceId": "6fac9b0e",
          "type": "GENERATION",
          "name": "6fac_psg_gen_attempt#2",
          "startTime": "2026-02-24T13:11:12.934000+00:00",
          "endTime": "2026-02-24T13:11:29.298000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16364.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-11-32-736186_chatcmpl-5f75f550-1321-499c-8301-b29f1e7a3671",
          "traceId": "6fac9b0e",
          "type": "GENERATION",
          "name": "6fac_psg_gen_attempt#3",
          "startTime": "2026-02-24T13:11:32.736000+00:00",
          "endTime": "2026-02-24T13:11:49.045000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16309.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-11-55-136294_chatcmpl-317a158d-5858-4fce-8b56-27ed5fb8c50d",
          "traceId": "6fac9b0e",
          "type": "GENERATION",
          "name": "6fac_psg_gen_attempt#4",
          "startTime": "2026-02-24T13:11:55.136000+00:00",
          "endTime": "2026-02-24T13:12:11.504000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16368.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-15-12-14-630659_chatcmpl-054fa125-8135-4723-a010-c50c8085a639",
          "traceId": "6fac9b0e",
          "type": "GENERATION",
          "name": "6fac_psg_gen_attempt#5",
          "startTime": "2026-02-24T13:12:14.630000+00:00",
          "endTime": "2026-02-24T13:12:30.916000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 16286.0,
          "promptTokens": 180,
          "completionTokens": 787,
          "costDetails": {},
          "totalTokens": 967,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "5044ccdf-0d2f-4f5e-9c01-3581bb3806ee",
          "traceId": "6fac9b0e",
          "type": "SPAN",
          "name": "error_6f_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T13:12:34.834000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 15:12:31.250446: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:12:31.253918: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 15:12:31.265352: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 15:12:31.284280: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 15:12:31.290060: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 15:12:31.303369: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 15:12:32.525957: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151230_psg_phi4:latest/tmp_20260224151230_psg_phi4:latest.py\", line 71, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224151230_psg_phi4:latest/tmp_20260224151230_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T13:10:23.251Z",
      "updatedAt": "2026-02-24T13:12:39.991Z"
    }
  ],
  "meta": {
    "total_items": 11
  }
}