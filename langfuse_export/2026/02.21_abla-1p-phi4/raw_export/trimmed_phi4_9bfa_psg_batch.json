{
  "data": [
    {
      "id": "0889301c",
      "timestamp": "2026-02-24T02:24:54.683000+00:00",
      "name": "0889_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:25:59.532130: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:25:59.535607: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:25:59.547175: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:25:59.565656: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:25:59.571255: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:25:59.584557: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:26:00.595991: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042559_psg_phi4:latest/tmp_20260224042559_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042559_psg_phi4:latest/tmp_20260224042559_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 30
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 68.719,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-24-54-684216_chatcmpl-370e2f3c-aa18-4846-ab1d-1c0f162fda0b",
          "traceId": "0889301c",
          "type": "GENERATION",
          "name": "0889_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:24:54.684000+00:00",
          "endTime": "2026-02-24T02:25:05.157000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10473.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-25-08-281116_chatcmpl-92cb2cd9-fe13-42c2-b6e0-be26f060fdcb",
          "traceId": "0889301c",
          "type": "GENERATION",
          "name": "0889_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:25:08.281000+00:00",
          "endTime": "2026-02-24T02:25:18.563000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10282.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-25-21-642685_chatcmpl-f5ee1b57-1546-4ece-83d1-1382e16e6794",
          "traceId": "0889301c",
          "type": "GENERATION",
          "name": "0889_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:25:21.642000+00:00",
          "endTime": "2026-02-24T02:25:31.937000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10295.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-25-35-504956_chatcmpl-d3115c33-10c0-4f24-b51a-3332edb42ba6",
          "traceId": "0889301c",
          "type": "GENERATION",
          "name": "0889_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:25:35.504000+00:00",
          "endTime": "2026-02-24T02:25:45.784000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10280.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-25-48-837914_chatcmpl-82bc0b19-4ce7-4826-909e-15c1fa066827",
          "traceId": "0889301c",
          "type": "GENERATION",
          "name": "0889_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:25:48.837000+00:00",
          "endTime": "2026-02-24T02:25:59.139000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10302.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "cbd0e2e7-4952-4a2d-853a-3195926992dc",
          "traceId": "0889301c",
          "type": "SPAN",
          "name": "error_08_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:26:03.403000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:25:59.532130: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:25:59.535607: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:25:59.547175: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:25:59.565656: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:25:59.571255: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:25:59.584557: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:26:00.595991: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042559_psg_phi4:latest/tmp_20260224042559_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042559_psg_phi4:latest/tmp_20260224042559_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:24:55.200Z",
      "updatedAt": "2026-02-24T02:26:08.906Z"
    },
    {
      "id": "b7235e47",
      "timestamp": "2026-02-24T02:23:20.313000+00:00",
      "name": "b723_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:24:26.072419: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:24:26.075798: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:24:26.087118: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:24:26.105274: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:24:26.110794: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:24:26.123692: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:24:26.928415: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042425_psg_phi4:latest/tmp_20260224042425_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042425_psg_phi4:latest/tmp_20260224042425_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 29
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 68.46,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-23-20-314796_chatcmpl-13c4b71f-650e-4efa-9ca2-6432edcdae63",
          "traceId": "b7235e47",
          "type": "GENERATION",
          "name": "b723_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:23:20.314000+00:00",
          "endTime": "2026-02-24T02:23:30.466000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10152.0,
          "promptTokens": 180,
          "completionTokens": 776,
          "costDetails": {},
          "totalTokens": 956,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-23-33-567474_chatcmpl-e4cde0a3-c7c9-414e-8139-8fe9e9f64686",
          "traceId": "b7235e47",
          "type": "GENERATION",
          "name": "b723_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:23:33.567000+00:00",
          "endTime": "2026-02-24T02:23:43.857000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10290.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-23-46-871972_chatcmpl-3335e234-63c3-4b30-87eb-80a2a98a9cd8",
          "traceId": "b7235e47",
          "type": "GENERATION",
          "name": "b723_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:23:46.871000+00:00",
          "endTime": "2026-02-24T02:23:57.162000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10291.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-24-02-388305_chatcmpl-b3d208bf-bc81-4f80-9df0-e607d7056ae0",
          "traceId": "b7235e47",
          "type": "GENERATION",
          "name": "b723_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:24:02.388000+00:00",
          "endTime": "2026-02-24T02:24:12.474000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10086.0,
          "promptTokens": 180,
          "completionTokens": 776,
          "costDetails": {},
          "totalTokens": 956,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-24-15-448233_chatcmpl-020c9be6-9f73-4fe9-8ee8-f9869127af34",
          "traceId": "b7235e47",
          "type": "GENERATION",
          "name": "b723_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:24:15.448000+00:00",
          "endTime": "2026-02-24T02:24:25.723000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10275.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "1c8ab566-4da3-40e1-8f9b-5ffb0a6a01b5",
          "traceId": "b7235e47",
          "type": "SPAN",
          "name": "error_b7_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:24:28.774000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:24:26.072419: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:24:26.075798: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:24:26.087118: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:24:26.105274: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:24:26.110794: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:24:26.123692: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:24:26.928415: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042425_psg_phi4:latest/tmp_20260224042425_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042425_psg_phi4:latest/tmp_20260224042425_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:23:20.829Z",
      "updatedAt": "2026-02-24T02:24:33.958Z"
    },
    {
      "id": "87458113",
      "timestamp": "2026-02-24T02:21:46.751000+00:00",
      "name": "8745_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef get_output(interpreter, score_threshold):\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    results = []\n    for i in range(len(scores)):\n        if scores[i] >= score_threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': classes[i],\n                'score': scores[i]\n            }\n            results.append(result)\n    return results\n\ndef draw_boxes(frame, results):\n    for obj in results:\n        ymin, xmin, ymax, xmax = obj['bounding_box']\n        xmin = int(xmin * frame.shape[1])\n        xmax = int(xmax * frame.shape[1])\n        ymin = int(ymin * frame.shape[0])\n        ymax = int(ymax * frame.shape[0])\n\n        cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (10, 255, 0), 2)\n        label = f\"{labels[int(obj['class_id'])]}: {int(obj['score'] * 100)}%\"\n        cv2.putText(frame, label, (xmin, ymin - 5), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (10, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (input_details[0]['shape'][2], input_details[0]['shape'][1]))\n    input_data = np.expand_dims(input_data, axis=0)\n    input_data = (np.float32(input_data) - 127.5) / 127.5\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Get results\n    results = get_output(interpreter, confidence_threshold)\n\n    # Draw boxes on the frame\n    draw_boxes(frame, results)\n\n    # Write the frame with detections\n    out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:22:51.718711: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:22:51.722414: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:22:51.734512: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:22:51.753821: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:22:51.759864: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:22:51.773704: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:22:52.600695: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042251_psg_phi4:latest/tmp_20260224042251_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 28
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 67.818,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-21-46-753062_chatcmpl-7c213715-553d-4fc1-96b3-8b6ad887bae2",
          "traceId": "87458113",
          "type": "GENERATION",
          "name": "8745_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:21:46.753000+00:00",
          "endTime": "2026-02-24T02:21:57.144000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10391.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-22-01-122524_chatcmpl-68e00805-8e52-4406-b19b-9de63b661d84",
          "traceId": "87458113",
          "type": "GENERATION",
          "name": "8745_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:22:01.122000+00:00",
          "endTime": "2026-02-24T02:22:11.422000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10300.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-22-14-441268_chatcmpl-1124c6b9-c276-4fe1-ac83-42dff9ab4d69",
          "traceId": "87458113",
          "type": "GENERATION",
          "name": "8745_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:22:14.441000+00:00",
          "endTime": "2026-02-24T02:22:24.719000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10278.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-22-27-710553_chatcmpl-d4a4dda4-e3d2-450c-988f-61e6587319e0",
          "traceId": "87458113",
          "type": "GENERATION",
          "name": "8745_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:22:27.710000+00:00",
          "endTime": "2026-02-24T02:22:37.976000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10266.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-22-41-065687_chatcmpl-7fec022d-63f9-4556-a0a0-c9d17fa688be",
          "traceId": "87458113",
          "type": "GENERATION",
          "name": "8745_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:22:41.065000+00:00",
          "endTime": "2026-02-24T02:22:51.381000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10316.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "c81a0874-5df9-4db2-97de-a8c177a3e10a",
          "traceId": "87458113",
          "type": "SPAN",
          "name": "error_87_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:22:54.571000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:22:51.718711: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:22:51.722414: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:22:51.734512: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:22:51.753821: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:22:51.759864: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:22:51.773704: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:22:52.600695: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042251_psg_phi4:latest/tmp_20260224042251_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:21:47.269Z",
      "updatedAt": "2026-02-24T02:22:59.917Z"
    },
    {
      "id": "6448eb08",
      "timestamp": "2026-02-24T02:20:13.378000+00:00",
      "name": "6448_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:21:18.458418: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:21:18.461934: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:21:18.473412: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:21:18.491733: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:21:18.497240: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:21:18.510064: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:21:19.311803: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042118_psg_phi4:latest/tmp_20260224042118_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042118_psg_phi4:latest/tmp_20260224042118_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 27
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 67.759,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-20-13-379159_chatcmpl-1a7a660f-07d4-4f1b-9eeb-f4d4d9fdf1cd",
          "traceId": "6448eb08",
          "type": "GENERATION",
          "name": "6448_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:20:13.379000+00:00",
          "endTime": "2026-02-24T02:20:23.736000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10357.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-20-26-807481_chatcmpl-64365682-2a86-4f2f-9cb7-702e1965c612",
          "traceId": "6448eb08",
          "type": "GENERATION",
          "name": "6448_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:20:26.807000+00:00",
          "endTime": "2026-02-24T02:20:37.074000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10267.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-20-40-145759_chatcmpl-01f182b3-d237-4381-ab36-ebe3fc79ff24",
          "traceId": "6448eb08",
          "type": "GENERATION",
          "name": "6448_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:20:40.145000+00:00",
          "endTime": "2026-02-24T02:20:50.452000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10307.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-20-53-417023_chatcmpl-e4a22bc7-e410-40cc-bdc5-e6969908d0d3",
          "traceId": "6448eb08",
          "type": "GENERATION",
          "name": "6448_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:20:53.417000+00:00",
          "endTime": "2026-02-24T02:21:03.738000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10321.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-21-07-777060_chatcmpl-59745e3e-7aa1-4397-b10c-6434f5790f28",
          "traceId": "6448eb08",
          "type": "GENERATION",
          "name": "6448_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:21:07.777000+00:00",
          "endTime": "2026-02-24T02:21:18.129000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10352.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "98d30a82-a392-4c9e-a699-28c4315c7cbc",
          "traceId": "6448eb08",
          "type": "SPAN",
          "name": "error_64_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:21:21.138000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:21:18.458418: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:21:18.461934: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:21:18.473412: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:21:18.491733: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:21:18.497240: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:21:18.510064: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:21:19.311803: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042118_psg_phi4:latest/tmp_20260224042118_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224042118_psg_phi4:latest/tmp_20260224042118_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:20:13.892Z",
      "updatedAt": "2026-02-24T02:21:26.585Z"
    },
    {
      "id": "3e45357d",
      "timestamp": "2026-02-24T02:18:37.803000+00:00",
      "name": "3e45_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:19:44.114157: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:19:44.117879: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:19:44.129748: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:19:44.149412: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:19:44.155444: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:19:44.169483: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:19:44.987735: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041943_psg_phi4:latest/tmp_20260224041943_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041943_psg_phi4:latest/tmp_20260224041943_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 26
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 69.107,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-18-37-804933_chatcmpl-e4a1ca09-79b6-48cc-b265-c608fa2d9d86",
          "traceId": "3e45357d",
          "type": "GENERATION",
          "name": "3e45_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:18:37.804000+00:00",
          "endTime": "2026-02-24T02:18:48.185000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10381.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-18-51-377367_chatcmpl-126d08cb-5a2a-4d0b-a4c1-d1539c698a2e",
          "traceId": "3e45357d",
          "type": "GENERATION",
          "name": "3e45_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:18:51.377000+00:00",
          "endTime": "2026-02-24T02:19:01.674000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10297.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-19-06-850291_chatcmpl-747b50fe-6155-456a-82d4-cf4afe02e485",
          "traceId": "3e45357d",
          "type": "GENERATION",
          "name": "3e45_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:19:06.850000+00:00",
          "endTime": "2026-02-24T02:19:16.935000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10085.0,
          "promptTokens": 180,
          "completionTokens": 776,
          "costDetails": {},
          "totalTokens": 956,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-19-20-068119_chatcmpl-36ee0456-ea9d-4cf6-9b2b-55addc591513",
          "traceId": "3e45357d",
          "type": "GENERATION",
          "name": "3e45_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:19:20.068000+00:00",
          "endTime": "2026-02-24T02:19:30.361000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10293.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-19-33-480206_chatcmpl-4f1cadcc-3f71-4bef-a4f5-3031b2f4bfdf",
          "traceId": "3e45357d",
          "type": "GENERATION",
          "name": "3e45_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:19:33.480000+00:00",
          "endTime": "2026-02-24T02:19:43.772000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10292.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "c8287de9-9f1a-43d4-ad54-3eb0fd63bf5d",
          "traceId": "3e45357d",
          "type": "SPAN",
          "name": "error_3e_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:19:46.911000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:19:44.114157: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:19:44.117879: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:19:44.129748: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:19:44.149412: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:19:44.155444: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:19:44.169483: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:19:44.987735: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041943_psg_phi4:latest/tmp_20260224041943_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041943_psg_phi4:latest/tmp_20260224041943_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:18:38.316Z",
      "updatedAt": "2026-02-24T02:19:52.539Z"
    },
    {
      "id": "daf77951",
      "timestamp": "2026-02-24T02:17:04.419000+00:00",
      "name": "daf7_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:18:08.849777: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:18:08.853341: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:18:08.864917: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:18:08.883338: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:18:08.888899: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:18:08.902014: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:18:09.703518: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041808_psg_phi4:latest/tmp_20260224041808_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041808_psg_phi4:latest/tmp_20260224041808_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 25
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 67.2,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-17-04-421961_chatcmpl-112b0b98-c789-473d-a492-481a24ab6257",
          "traceId": "daf77951",
          "type": "GENERATION",
          "name": "daf7_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:17:04.421000+00:00",
          "endTime": "2026-02-24T02:17:15.004000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10583.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-17-18-157075_chatcmpl-57241508-2d67-498b-ae69-570b04a6d588",
          "traceId": "daf77951",
          "type": "GENERATION",
          "name": "daf7_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:17:18.157000+00:00",
          "endTime": "2026-02-24T02:17:28.484000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10327.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-17-31-574226_chatcmpl-1245bc08-3230-4279-a5f7-c8ae29531f58",
          "traceId": "daf77951",
          "type": "GENERATION",
          "name": "daf7_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:17:31.574000+00:00",
          "endTime": "2026-02-24T02:17:41.653000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10079.0,
          "promptTokens": 180,
          "completionTokens": 776,
          "costDetails": {},
          "totalTokens": 956,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-17-44-712208_chatcmpl-399fb095-7424-484b-b317-c1f59bbd288e",
          "traceId": "daf77951",
          "type": "GENERATION",
          "name": "daf7_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:17:44.712000+00:00",
          "endTime": "2026-02-24T02:17:55.013000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10301.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-17-58-218085_chatcmpl-c1dd41d7-b3ea-4e63-b4ac-b20f8721786f",
          "traceId": "daf77951",
          "type": "GENERATION",
          "name": "daf7_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:17:58.218000+00:00",
          "endTime": "2026-02-24T02:18:08.514000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10296.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "eba8c6aa-3042-41a1-b36e-ded4b52d8626",
          "traceId": "daf77951",
          "type": "SPAN",
          "name": "error_da_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:18:11.621000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:18:08.849777: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:18:08.853341: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:18:08.864917: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:18:08.883338: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:18:08.888899: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:18:08.902014: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:18:09.703518: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041808_psg_phi4:latest/tmp_20260224041808_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041808_psg_phi4:latest/tmp_20260224041808_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:17:04.934Z",
      "updatedAt": "2026-02-24T02:18:17.088Z"
    },
    {
      "id": "399431c5",
      "timestamp": "2026-02-24T02:15:30.013000+00:00",
      "name": "3994_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef get_output(interpreter, score_threshold):\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    results = []\n    for i in range(len(scores)):\n        if scores[i] >= score_threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': classes[i],\n                'score': scores[i]\n            }\n            results.append(result)\n    return results\n\ndef draw_boxes(frame, results):\n    for obj in results:\n        ymin, xmin, ymax, xmax = obj['bounding_box']\n        xmin = int(xmin * frame.shape[1])\n        xmax = int(xmax * frame.shape[1])\n        ymin = int(ymin * frame.shape[0])\n        ymax = int(ymax * frame.shape[0])\n\n        cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (10, 255, 0), 2)\n        label = f\"{labels[int(obj['class_id'])]}: {int(obj['score'] * 100)}%\"\n        cv2.putText(frame, label, (xmin, ymin - 5), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (10, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (input_details[0]['shape'][2], input_details[0]['shape'][1]))\n    input_data = np.expand_dims(input_data, axis=0)\n    input_data = (np.float32(input_data) - 127.5) / 127.5\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Get results\n    results = get_output(interpreter, confidence_threshold)\n\n    # Draw boxes on the frame\n    draw_boxes(frame, results)\n\n    # Write the frame with detections\n    out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:16:34.699926: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:16:34.703500: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:16:34.715327: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:16:34.733763: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:16:34.739226: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:16:34.752639: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:16:35.552862: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041634_psg_phi4:latest/tmp_20260224041634_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 24
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 67.475,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-15-30-014942_chatcmpl-0e5657fc-6f6a-4269-8adc-59bd3ca56522",
          "traceId": "399431c5",
          "type": "GENERATION",
          "name": "3994_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:15:30.014000+00:00",
          "endTime": "2026-02-24T02:15:40.520000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10506.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-15-43-639473_chatcmpl-36d5b4df-d1e0-4fa3-83a0-8fb8157f0038",
          "traceId": "399431c5",
          "type": "GENERATION",
          "name": "3994_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:15:43.639000+00:00",
          "endTime": "2026-02-24T02:15:54.188000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10549.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-15-57-273335_chatcmpl-18e245bb-d636-4155-828c-c8f6fcaa9272",
          "traceId": "399431c5",
          "type": "GENERATION",
          "name": "3994_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:15:57.273000+00:00",
          "endTime": "2026-02-24T02:16:07.577000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10304.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-16-10-690593_chatcmpl-80a3aab4-3c01-42d0-ad36-717e98f7c364",
          "traceId": "399431c5",
          "type": "GENERATION",
          "name": "3994_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:16:10.690000+00:00",
          "endTime": "2026-02-24T02:16:20.968000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10278.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-16-24-093450_chatcmpl-7850577f-c300-4a82-a980-49a2ec317789",
          "traceId": "399431c5",
          "type": "GENERATION",
          "name": "3994_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:16:24.093000+00:00",
          "endTime": "2026-02-24T02:16:34.362000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10269.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "2b5371ab-318c-42c4-9eb3-fc7dff966c0d",
          "traceId": "399431c5",
          "type": "SPAN",
          "name": "error_39_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:16:37.489000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:16:34.699926: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:16:34.703500: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:16:34.715327: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:16:34.733763: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:16:34.739226: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:16:34.752639: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:16:35.552862: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041634_psg_phi4:latest/tmp_20260224041634_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:15:30.527Z",
      "updatedAt": "2026-02-24T02:16:42.751Z"
    },
    {
      "id": "47eadade",
      "timestamp": "2026-02-24T02:13:53.496000+00:00",
      "name": "47ea_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef get_output(interpreter, score_threshold):\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    results = []\n    for i in range(len(scores)):\n        if scores[i] >= score_threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': classes[i],\n                'score': scores[i]\n            }\n            results.append(result)\n    return results\n\ndef draw_boxes(frame, results):\n    for obj in results:\n        ymin, xmin, ymax, xmax = obj['bounding_box']\n        xmin = int(xmin * frame.shape[1])\n        xmax = int(xmax * frame.shape[1])\n        ymin = int(ymin * frame.shape[0])\n        ymax = int(ymax * frame.shape[0])\n\n        cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (10, 255, 0), 2)\n        label = f\"{labels[int(obj['class_id'])]}: {int(obj['score'] * 100)}%\"\n        cv2.putText(frame, label, (xmin, ymin - 5), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (10, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (input_details[0]['shape'][2], input_details[0]['shape'][1]))\n    input_data = np.expand_dims(input_data, axis=0)\n    input_data = (np.float32(input_data) - 127.5) / 127.5\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Get results\n    results = get_output(interpreter, confidence_threshold)\n\n    # Draw boxes on the frame\n    draw_boxes(frame, results)\n\n    # Write the frame with detections\n    out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:14:59.428624: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:14:59.441808: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:14:59.489482: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:14:59.572959: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:14:59.592982: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:14:59.633727: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:15:01.129686: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041458_psg_phi4:latest/tmp_20260224041458_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 23
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 70.543,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-13-53-497909_chatcmpl-a61a90e6-e0ea-45ab-adf6-44c16719c0d8",
          "traceId": "47eadade",
          "type": "GENERATION",
          "name": "47ea_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:13:53.497000+00:00",
          "endTime": "2026-02-24T02:14:03.859000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10362.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-14-08-083416_chatcmpl-e04d886a-c364-4787-b444-236ac92d7fec",
          "traceId": "47eadade",
          "type": "GENERATION",
          "name": "47ea_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:14:08.083000+00:00",
          "endTime": "2026-02-24T02:14:18.393000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10310.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-14-21-530086_chatcmpl-6438b147-3d91-4e26-ae49-c3d4e1503703",
          "traceId": "47eadade",
          "type": "GENERATION",
          "name": "47ea_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:14:21.530000+00:00",
          "endTime": "2026-02-24T02:14:31.856000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10326.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-14-34-934427_chatcmpl-4428eb69-49fb-4018-9f88-ca51a6bdada3",
          "traceId": "47eadade",
          "type": "GENERATION",
          "name": "47ea_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:14:34.934000+00:00",
          "endTime": "2026-02-24T02:14:45.267000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10333.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-14-48-406695_chatcmpl-279f2914-9cbb-460c-8c2b-4c7d423f3096",
          "traceId": "47eadade",
          "type": "GENERATION",
          "name": "47ea_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:14:48.406000+00:00",
          "endTime": "2026-02-24T02:14:58.717000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10311.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "66fa912c-0c53-4312-96ee-b41ddee97c7f",
          "traceId": "47eadade",
          "type": "SPAN",
          "name": "error_47_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:15:04.040000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:14:59.428624: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:14:59.441808: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:14:59.489482: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:14:59.572959: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:14:59.592982: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:14:59.633727: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:15:01.129686: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041458_psg_phi4:latest/tmp_20260224041458_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:13:54.009Z",
      "updatedAt": "2026-02-24T02:15:09.222Z"
    },
    {
      "id": "9a9e0355",
      "timestamp": "2026-02-24T02:12:18.073000+00:00",
      "name": "9a9e_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:13:24.953982: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:13:24.957566: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:13:24.969090: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:13:24.987360: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:13:24.992909: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:13:25.006185: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:13:25.832216: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041324_psg_phi4:latest/tmp_20260224041324_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041324_psg_phi4:latest/tmp_20260224041324_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 22
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 69.743,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-12-18-073661_chatcmpl-57acac0c-8117-42ce-b51d-e6ee28c22787",
          "traceId": "9a9e0355",
          "type": "GENERATION",
          "name": "9a9e_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:12:18.073000+00:00",
          "endTime": "2026-02-24T02:12:28.430000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10357.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-12-31-575411_chatcmpl-6ab6e012-2cf6-40f6-800e-1974aea00132",
          "traceId": "9a9e0355",
          "type": "GENERATION",
          "name": "9a9e_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:12:31.575000+00:00",
          "endTime": "2026-02-24T02:12:41.849000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10274.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-12-45-816816_chatcmpl-281c7315-40b4-4119-9777-91eadadafe0a",
          "traceId": "9a9e0355",
          "type": "GENERATION",
          "name": "9a9e_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:12:45.816000+00:00",
          "endTime": "2026-02-24T02:12:56.095000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10279.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-13-00-193131_chatcmpl-41881c06-ba1a-493f-be92-94397df78be5",
          "traceId": "9a9e0355",
          "type": "GENERATION",
          "name": "9a9e_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:13:00.193000+00:00",
          "endTime": "2026-02-24T02:13:10.597000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10404.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-13-14-256723_chatcmpl-7756540f-82a4-43cb-9f4a-51ab4f8d38e3",
          "traceId": "9a9e0355",
          "type": "GENERATION",
          "name": "9a9e_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:13:14.256000+00:00",
          "endTime": "2026-02-24T02:13:24.615000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10359.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "5d02c3d7-6c9e-4d0f-9f7a-21f0a6a809d0",
          "traceId": "9a9e0355",
          "type": "SPAN",
          "name": "error_9a_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:13:27.816000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:13:24.953982: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:13:24.957566: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:13:24.969090: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:13:24.987360: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:13:24.992909: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:13:25.006185: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:13:25.832216: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041324_psg_phi4:latest/tmp_20260224041324_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041324_psg_phi4:latest/tmp_20260224041324_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:12:18.586Z",
      "updatedAt": "2026-02-24T02:13:33.259Z"
    },
    {
      "id": "2834d357",
      "timestamp": "2026-02-24T02:10:44.711000+00:00",
      "name": "2834_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:11:49.559050: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:11:49.562459: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:11:49.573834: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:11:49.592305: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:11:49.597913: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:11:49.611299: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:11:50.426575: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041149_psg_phi4:latest/tmp_20260224041149_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041149_psg_phi4:latest/tmp_20260224041149_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 21
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 67.589,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-10-44-712812_chatcmpl-3243b562-52f9-492b-a573-c6a8b9898b57",
          "traceId": "2834d357",
          "type": "GENERATION",
          "name": "2834_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:10:44.712000+00:00",
          "endTime": "2026-02-24T02:10:55.223000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10511.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-10-58-466735_chatcmpl-b8841a68-23ba-404e-843d-c7f65ff77707",
          "traceId": "2834d357",
          "type": "GENERATION",
          "name": "2834_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:10:58.466000+00:00",
          "endTime": "2026-02-24T02:11:09.036000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10570.0,
          "promptTokens": 180,
          "completionTokens": 813,
          "costDetails": {},
          "totalTokens": 993,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-11-11-999499_chatcmpl-c0d90f00-f411-464b-bae9-2b7fa4193d9b",
          "traceId": "2834d357",
          "type": "GENERATION",
          "name": "2834_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:11:11.999000+00:00",
          "endTime": "2026-02-24T02:11:22.291000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10292.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-11-25-583268_chatcmpl-da5de05a-c6c3-44cc-a8c2-802afca0a0fd",
          "traceId": "2834d357",
          "type": "GENERATION",
          "name": "2834_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:11:25.583000+00:00",
          "endTime": "2026-02-24T02:11:35.877000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10294.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-11-38-929111_chatcmpl-2d4e4933-9668-4631-afd5-31db39abb983",
          "traceId": "2834d357",
          "type": "GENERATION",
          "name": "2834_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:11:38.929000+00:00",
          "endTime": "2026-02-24T02:11:49.230000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10301.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "7e10ce48-c7e2-4dd1-bee8-9e95774428c6",
          "traceId": "2834d357",
          "type": "SPAN",
          "name": "error_28_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:11:52.301000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:11:49.559050: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:11:49.562459: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:11:49.573834: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:11:49.592305: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:11:49.597913: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:11:49.611299: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:11:50.426575: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041149_psg_phi4:latest/tmp_20260224041149_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041149_psg_phi4:latest/tmp_20260224041149_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:10:45.226Z",
      "updatedAt": "2026-02-24T02:11:57.921Z"
    },
    {
      "id": "8f44aa05",
      "timestamp": "2026-02-24T02:09:10.241000+00:00",
      "name": "8f44_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:10:15.687465: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:10:15.690826: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:10:15.702217: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:10:15.720598: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:10:15.726220: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:10:15.739085: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:10:16.544601: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041015_psg_phi4:latest/tmp_20260224041015_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041015_psg_phi4:latest/tmp_20260224041015_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 20
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 68.147,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-09-10-243150_chatcmpl-c700565e-4903-4751-9ff3-b342cc4912ab",
          "traceId": "8f44aa05",
          "type": "GENERATION",
          "name": "8f44_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:09:10.243000+00:00",
          "endTime": "2026-02-24T02:09:20.587000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10344.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-09-23-541301_chatcmpl-eb95c26e-77ec-4a71-af25-85ebfd9683b4",
          "traceId": "8f44aa05",
          "type": "GENERATION",
          "name": "8f44_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:09:23.541000+00:00",
          "endTime": "2026-02-24T02:09:33.846000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10305.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-09-36-840155_chatcmpl-dcd2c056-82fb-41ce-8f65-7cc3dcca9464",
          "traceId": "8f44aa05",
          "type": "GENERATION",
          "name": "8f44_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:09:36.840000+00:00",
          "endTime": "2026-02-24T02:09:47.172000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10332.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-09-50-121869_chatcmpl-51a88a6e-4b4c-45f4-a445-a6f78b8927df",
          "traceId": "8f44aa05",
          "type": "GENERATION",
          "name": "8f44_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:09:50.121000+00:00",
          "endTime": "2026-02-24T02:10:00.508000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10387.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-10-05-069203_chatcmpl-855732e2-bced-4c90-b9f5-907842dfa3dc",
          "traceId": "8f44aa05",
          "type": "GENERATION",
          "name": "8f44_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:10:05.069000+00:00",
          "endTime": "2026-02-24T02:10:15.362000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10293.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "7da991f7-d416-44a6-924a-c02563ee3492",
          "traceId": "8f44aa05",
          "type": "SPAN",
          "name": "error_8f_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:10:18.390000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:10:15.687465: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:10:15.690826: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:10:15.702217: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:10:15.720598: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:10:15.726220: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:10:15.739085: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:10:16.544601: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041015_psg_phi4:latest/tmp_20260224041015_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224041015_psg_phi4:latest/tmp_20260224041015_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:09:10.753Z",
      "updatedAt": "2026-02-24T02:10:23.980Z"
    },
    {
      "id": "897e50f7",
      "timestamp": "2026-02-24T02:07:36.840000+00:00",
      "name": "897e_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef get_output(interpreter, score_threshold):\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    results = []\n    for i in range(len(scores)):\n        if scores[i] >= score_threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': classes[i],\n                'score': scores[i]\n            }\n            results.append(result)\n    return results\n\ndef draw_boxes(frame, results):\n    for obj in results:\n        ymin, xmin, ymax, xmax = obj['bounding_box']\n        xmin = int(xmin * frame.shape[1])\n        xmax = int(xmax * frame.shape[1])\n        ymin = int(ymin * frame.shape[0])\n        ymax = int(ymax * frame.shape[0])\n\n        cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (10, 255, 0), 2)\n        label = f\"{labels[int(obj['class_id'])]}: {int(obj['score'] * 100)}%\"\n        cv2.putText(frame, label, (xmin, ymin - 5), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (10, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (input_details[0]['shape'][2], input_details[0]['shape'][1]))\n    input_data = np.expand_dims(input_data, axis=0)\n    input_data = (np.float32(input_data) - 127.5) / 127.5\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Get results\n    results = get_output(interpreter, confidence_threshold)\n\n    # Draw boxes on the frame\n    draw_boxes(frame, results)\n\n    # Write the frame with detections\n    out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:08:42.072750: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:08:42.076298: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:08:42.087947: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:08:42.107449: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:08:42.113189: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:08:42.126325: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:08:42.932815: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040841_psg_phi4:latest/tmp_20260224040841_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 19
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 67.924,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-07-36-840603_chatcmpl-01c43b62-e52f-4e64-ac64-df32579ff17c",
          "traceId": "897e50f7",
          "type": "GENERATION",
          "name": "897e_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:07:36.840000+00:00",
          "endTime": "2026-02-24T02:07:47.206000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10366.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-07-50-190643_chatcmpl-05a2997c-a937-46b3-a6fc-42498df3c6ca",
          "traceId": "897e50f7",
          "type": "GENERATION",
          "name": "897e_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:07:50.190000+00:00",
          "endTime": "2026-02-24T02:08:00.487000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10297.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-08-04-734003_chatcmpl-9ded6542-bb0e-440a-a407-2e3dd4c3d2ec",
          "traceId": "897e50f7",
          "type": "GENERATION",
          "name": "897e_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:08:04.734000+00:00",
          "endTime": "2026-02-24T02:08:15.050000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10316.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-08-18-095556_chatcmpl-2a0683c5-ebc0-4718-b796-1033287bc07b",
          "traceId": "897e50f7",
          "type": "GENERATION",
          "name": "897e_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:08:18.095000+00:00",
          "endTime": "2026-02-24T02:08:28.413000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10318.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-08-31-460593_chatcmpl-9ddf74c1-6b84-4942-b4c4-fff7966d3cf2",
          "traceId": "897e50f7",
          "type": "GENERATION",
          "name": "897e_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:08:31.460000+00:00",
          "endTime": "2026-02-24T02:08:41.733000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10273.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "841ced62-9e52-4ee0-b247-cb3d45cb8122",
          "traceId": "897e50f7",
          "type": "SPAN",
          "name": "error_89_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:08:44.764000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:08:42.072750: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:08:42.076298: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:08:42.087947: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:08:42.107449: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:08:42.113189: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:08:42.126325: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:08:42.932815: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040841_psg_phi4:latest/tmp_20260224040841_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:07:37.353Z",
      "updatedAt": "2026-02-24T02:08:50.035Z"
    },
    {
      "id": "6887f3c5",
      "timestamp": "2026-02-24T02:06:04.456000+00:00",
      "name": "6887_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:07:08.518735: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:07:08.522169: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:07:08.533488: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:07:08.551538: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:07:08.557014: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:07:08.569877: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:07:09.363011: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040708_psg_phi4:latest/tmp_20260224040708_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040708_psg_phi4:latest/tmp_20260224040708_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 18
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 66.785,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-06-04-457848_chatcmpl-a1a18ffd-c204-4b1f-8258-5d71f15fbb5f",
          "traceId": "6887f3c5",
          "type": "GENERATION",
          "name": "6887_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:06:04.457000+00:00",
          "endTime": "2026-02-24T02:06:14.702000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10245.0,
          "promptTokens": 180,
          "completionTokens": 776,
          "costDetails": {},
          "totalTokens": 956,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-06-17-779669_chatcmpl-230f7d35-27fc-4409-963e-117c27322836",
          "traceId": "6887f3c5",
          "type": "GENERATION",
          "name": "6887_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:06:17.779000+00:00",
          "endTime": "2026-02-24T02:06:28.076000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10297.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-06-31-132741_chatcmpl-205cda8c-ee7a-4952-b5e5-cb3a27a69704",
          "traceId": "6887f3c5",
          "type": "GENERATION",
          "name": "6887_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:06:31.132000+00:00",
          "endTime": "2026-02-24T02:06:41.426000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10294.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-06-44-533103_chatcmpl-1ddaa7db-d4a0-4797-8205-1bed8bcf321f",
          "traceId": "6887f3c5",
          "type": "GENERATION",
          "name": "6887_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:06:44.533000+00:00",
          "endTime": "2026-02-24T02:06:54.798000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10265.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-06-57-896701_chatcmpl-1d6a7589-3786-40f1-a1b6-aeaef3cad6a9",
          "traceId": "6887f3c5",
          "type": "GENERATION",
          "name": "6887_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:06:57.896000+00:00",
          "endTime": "2026-02-24T02:07:08.197000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10301.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "8b116a07-f979-454a-9619-60059165704a",
          "traceId": "6887f3c5",
          "type": "SPAN",
          "name": "error_68_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:07:11.242000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:07:08.518735: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:07:08.522169: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:07:08.533488: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:07:08.551538: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:07:08.557014: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:07:08.569877: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:07:09.363011: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040708_psg_phi4:latest/tmp_20260224040708_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040708_psg_phi4:latest/tmp_20260224040708_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:06:04.969Z",
      "updatedAt": "2026-02-24T02:07:16.697Z"
    },
    {
      "id": "e7175b9b",
      "timestamp": "2026-02-24T02:04:32.008000+00:00",
      "name": "e717_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:05:35.029593: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:05:35.033078: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:05:35.045016: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:05:35.064126: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:05:35.069748: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:05:35.083103: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:05:35.899755: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040534_psg_phi4:latest/tmp_20260224040534_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040534_psg_phi4:latest/tmp_20260224040534_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 17
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 65.805,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-04-32-010030_chatcmpl-1a02839e-980a-4dcf-b546-3373747aeacb",
          "traceId": "e7175b9b",
          "type": "GENERATION",
          "name": "e717_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:04:32.010000+00:00",
          "endTime": "2026-02-24T02:04:42.414000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10404.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-04-45-371796_chatcmpl-f531d064-4584-4028-bd03-b2211173228e",
          "traceId": "e7175b9b",
          "type": "GENERATION",
          "name": "e717_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:04:45.371000+00:00",
          "endTime": "2026-02-24T02:04:55.653000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10282.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-04-59-109524_chatcmpl-89294e43-9ce6-432b-b80b-ccd51870691a",
          "traceId": "e7175b9b",
          "type": "GENERATION",
          "name": "e717_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:04:59.109000+00:00",
          "endTime": "2026-02-24T02:05:09.415000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10306.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-05-12-394187_chatcmpl-4fa2edbc-18cd-4ba6-9d26-95e6d0fbb18d",
          "traceId": "e7175b9b",
          "type": "GENERATION",
          "name": "e717_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:05:12.394000+00:00",
          "endTime": "2026-02-24T02:05:21.393000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 8999.0,
          "promptTokens": 180,
          "completionTokens": 691,
          "costDetails": {},
          "totalTokens": 871,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-05-24-409530_chatcmpl-98cf7bff-f0f3-4654-a74c-668e94bb2695",
          "traceId": "e7175b9b",
          "type": "GENERATION",
          "name": "e717_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:05:24.409000+00:00",
          "endTime": "2026-02-24T02:05:34.701000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10292.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "e465967f-3a5c-454c-b65c-2fcddc8b2d08",
          "traceId": "e7175b9b",
          "type": "SPAN",
          "name": "error_e7_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:05:37.815000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:05:35.029593: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:05:35.033078: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:05:35.045016: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:05:35.064126: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:05:35.069748: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:05:35.083103: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:05:35.899755: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040534_psg_phi4:latest/tmp_20260224040534_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040534_psg_phi4:latest/tmp_20260224040534_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:04:32.520Z",
      "updatedAt": "2026-02-24T02:05:43.169Z"
    },
    {
      "id": "6b6b982a",
      "timestamp": "2026-02-24T02:02:57.569000+00:00",
      "name": "6b6b_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:04:01.664582: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:04:01.667991: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:04:01.679617: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:04:01.698075: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:04:01.703834: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:04:01.717024: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:04:02.860911: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040401_psg_phi4:latest/tmp_20260224040401_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040401_psg_phi4:latest/tmp_20260224040401_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 16
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 68.144,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-02-57-570968_chatcmpl-c309216d-a8b2-40d5-a7c2-be68e87abff1",
          "traceId": "6b6b982a",
          "type": "GENERATION",
          "name": "6b6b_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:02:57.570000+00:00",
          "endTime": "2026-02-24T02:03:07.918000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10348.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-03-10-910029_chatcmpl-459f2883-cfc8-4348-bdba-d20b0cd48783",
          "traceId": "6b6b982a",
          "type": "GENERATION",
          "name": "6b6b_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:03:10.910000+00:00",
          "endTime": "2026-02-24T02:03:21.222000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10312.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-03-24-194620_chatcmpl-d424953b-a5cb-470b-999a-5f9992e97fa9",
          "traceId": "6b6b982a",
          "type": "GENERATION",
          "name": "6b6b_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:03:24.194000+00:00",
          "endTime": "2026-02-24T02:03:34.486000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10292.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-03-37-638742_chatcmpl-e9c60cbc-bf2d-453d-bca2-cc936f99cb02",
          "traceId": "6b6b982a",
          "type": "GENERATION",
          "name": "6b6b_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:03:37.638000+00:00",
          "endTime": "2026-02-24T02:03:47.935000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10297.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-03-50-948786_chatcmpl-c00e4a4d-d51e-4bb2-982b-b90066afa131",
          "traceId": "6b6b982a",
          "type": "GENERATION",
          "name": "6b6b_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:03:50.948000+00:00",
          "endTime": "2026-02-24T02:04:01.277000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10329.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "6590504e-d51e-4e05-971c-98b923afb4f7",
          "traceId": "6b6b982a",
          "type": "SPAN",
          "name": "error_6b_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:04:05.714000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:04:01.664582: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:04:01.667991: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:04:01.679617: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:04:01.698075: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:04:01.703834: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:04:01.717024: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:04:02.860911: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040401_psg_phi4:latest/tmp_20260224040401_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040401_psg_phi4:latest/tmp_20260224040401_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:02:58.088Z",
      "updatedAt": "2026-02-24T02:04:11.234Z"
    },
    {
      "id": "bc8a8cb2",
      "timestamp": "2026-02-24T02:01:22.209000+00:00",
      "name": "bc8a_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef get_output(interpreter, score_threshold):\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    results = []\n    for i in range(len(scores)):\n        if scores[i] >= score_threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': classes[i],\n                'score': scores[i]\n            }\n            results.append(result)\n    return results\n\ndef draw_boxes(frame, results):\n    for obj in results:\n        ymin, xmin, ymax, xmax = obj['bounding_box']\n        xmin = int(xmin * frame.shape[1])\n        xmax = int(xmax * frame.shape[1])\n        ymin = int(ymin * frame.shape[0])\n        ymax = int(ymax * frame.shape[0])\n\n        cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (10, 255, 0), 2)\n        label = f\"{labels[int(obj['class_id'])]}: {int(obj['score'] * 100)}%\"\n        cv2.putText(frame, label, (xmin, ymin - 5), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (10, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (input_details[0]['shape'][2], input_details[0]['shape'][1]))\n    input_data = np.expand_dims(input_data, axis=0)\n    input_data = (np.float32(input_data) - 127.5) / 127.5\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Get results\n    results = get_output(interpreter, confidence_threshold)\n\n    # Draw boxes on the frame\n    draw_boxes(frame, results)\n\n    # Write the frame with detections\n    out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:02:28.869523: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:02:28.872868: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:02:28.884108: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:02:28.902581: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:02:28.908304: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:02:28.921168: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:02:29.718784: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040228_psg_phi4:latest/tmp_20260224040228_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 15
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 69.365,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-04-01-22-210214_chatcmpl-47208fb3-82d7-4762-a2fe-0dd2fe62795e",
          "traceId": "bc8a8cb2",
          "type": "GENERATION",
          "name": "bc8a_psg_gen_attempt#1",
          "startTime": "2026-02-24T02:01:22.210000+00:00",
          "endTime": "2026-02-24T02:01:32.568000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10358.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-01-35-702466_chatcmpl-9e8b22bb-b389-4a3d-9176-180da724e65b",
          "traceId": "bc8a8cb2",
          "type": "GENERATION",
          "name": "bc8a_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:01:35.702000+00:00",
          "endTime": "2026-02-24T02:01:46.006000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10304.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-01-49-154967_chatcmpl-283229f4-9bb4-4ad8-bf90-6cd141f1730c",
          "traceId": "bc8a8cb2",
          "type": "GENERATION",
          "name": "bc8a_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:01:49.154000+00:00",
          "endTime": "2026-02-24T02:01:59.614000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10460.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-02-05-026260_chatcmpl-28fa6186-8b82-4c8c-846a-7ff969e0dfe9",
          "traceId": "bc8a8cb2",
          "type": "GENERATION",
          "name": "bc8a_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:02:05.026000+00:00",
          "endTime": "2026-02-24T02:02:15.232000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10206.0,
          "promptTokens": 180,
          "completionTokens": 776,
          "costDetails": {},
          "totalTokens": 956,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-02-18-262795_chatcmpl-6210cdec-95c5-4b22-a148-3e5ef417eb13",
          "traceId": "bc8a8cb2",
          "type": "GENERATION",
          "name": "bc8a_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:02:18.262000+00:00",
          "endTime": "2026-02-24T02:02:28.549000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10287.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "511e0272-8db5-46d8-887e-7cb23d300825",
          "traceId": "bc8a8cb2",
          "type": "SPAN",
          "name": "error_bc_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:02:31.575000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:02:28.869523: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:02:28.872868: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:02:28.884108: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:02:28.902581: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:02:28.908304: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:02:28.921168: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:02:29.718784: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040228_psg_phi4:latest/tmp_20260224040228_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T02:01:22.727Z",
      "updatedAt": "2026-02-24T02:02:36.890Z"
    },
    {
      "id": "7ac01876",
      "timestamp": "2026-02-24T01:59:47.461000+00:00",
      "name": "7ac0_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef get_output(interpreter, score_threshold):\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    results = []\n    for i in range(len(scores)):\n        if scores[i] >= score_threshold:\n            result = {\n                'bounding_box': boxes[i],\n                'class_id': classes[i],\n                'score': scores[i]\n            }\n            results.append(result)\n    return results\n\ndef draw_boxes(frame, results):\n    for obj in results:\n        ymin, xmin, ymax, xmax = obj['bounding_box']\n        xmin = int(xmin * frame.shape[1])\n        xmax = int(xmax * frame.shape[1])\n        ymin = int(ymin * frame.shape[0])\n        ymax = int(ymax * frame.shape[0])\n\n        cv2.rectangle(frame, (xmin, ymin), (xmax, ymax), (10, 255, 0), 2)\n        label = f\"{labels[int(obj['class_id'])]}: {int(obj['score'] * 100)}%\"\n        cv2.putText(frame, label, (xmin, ymin - 5), cv2.FONT_HERSHEY_SIMPLEX, 0.7, (10, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    # Preprocess the image\n    input_data = cv2.resize(frame, (input_details[0]['shape'][2], input_details[0]['shape'][1]))\n    input_data = np.expand_dims(input_data, axis=0)\n    input_data = (np.float32(input_data) - 127.5) / 127.5\n\n    # Run inference\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n    interpreter.invoke()\n\n    # Get results\n    results = get_output(interpreter, confidence_threshold)\n\n    # Draw boxes on the frame\n    draw_boxes(frame, results)\n\n    # Write the frame with detections\n    out.write(frame)\n\ncap.release()\nout.release()\ncv2.destroyAllWindows()",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 04:00:53.286938: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:00:53.290363: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:00:53.301689: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:00:53.319914: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:00:53.325415: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:00:53.338538: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:00:54.141659: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040052_psg_phi4:latest/tmp_20260224040052_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 14
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 68.602,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-03-59-47-462367_chatcmpl-74924fbf-b003-4ecd-b46e-a117b91e93b5",
          "traceId": "7ac01876",
          "type": "GENERATION",
          "name": "7ac0_psg_gen_attempt#1",
          "startTime": "2026-02-24T01:59:47.462000+00:00",
          "endTime": "2026-02-24T01:59:57.853000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10391.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-00-02-227393_chatcmpl-1ace3f41-f272-4f9c-8ff9-96edbe8f71c5",
          "traceId": "7ac01876",
          "type": "GENERATION",
          "name": "7ac0_psg_gen_attempt#2",
          "startTime": "2026-02-24T02:00:02.227000+00:00",
          "endTime": "2026-02-24T02:00:12.505000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10278.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-00-15-669662_chatcmpl-bfb47d77-f237-4e88-bc06-eb06c7ef958e",
          "traceId": "7ac01876",
          "type": "GENERATION",
          "name": "7ac0_psg_gen_attempt#3",
          "startTime": "2026-02-24T02:00:15.669000+00:00",
          "endTime": "2026-02-24T02:00:25.766000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10097.0,
          "promptTokens": 180,
          "completionTokens": 776,
          "costDetails": {},
          "totalTokens": 956,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-00-28-914366_chatcmpl-ef9951f9-acb7-4aed-bfb6-04e13a18951c",
          "traceId": "7ac01876",
          "type": "GENERATION",
          "name": "7ac0_psg_gen_attempt#4",
          "startTime": "2026-02-24T02:00:28.914000+00:00",
          "endTime": "2026-02-24T02:00:39.335000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10421.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-04-00-42-453432_chatcmpl-813e4dfe-c835-4c3e-ae31-86eee53580c4",
          "traceId": "7ac01876",
          "type": "GENERATION",
          "name": "7ac0_psg_gen_attempt#5",
          "startTime": "2026-02-24T02:00:42.453000+00:00",
          "endTime": "2026-02-24T02:00:52.960000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10507.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "f5aa2be9-3f95-46e0-885e-8b55f38d23e4",
          "traceId": "7ac01876",
          "type": "SPAN",
          "name": "error_7a_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T02:00:56.064000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 04:00:53.286938: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:00:53.290363: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 04:00:53.301689: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 04:00:53.319914: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 04:00:53.325415: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 04:00:53.338538: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 04:00:54.141659: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224040052_psg_phi4:latest/tmp_20260224040052_psg_phi4:latest.py\", line 73, in <module>\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T01:59:47.973Z",
      "updatedAt": "2026-02-24T02:01:01.646Z"
    },
    {
      "id": "c5160c0e",
      "timestamp": "2026-02-24T01:58:12.960000+00:00",
      "name": "c516_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 03:59:18.492551: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 03:59:18.496419: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 03:59:18.508172: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 03:59:18.527874: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 03:59:18.533614: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 03:59:18.547287: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 03:59:19.364588: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224035918_psg_phi4:latest/tmp_20260224035918_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224035918_psg_phi4:latest/tmp_20260224035918_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 13
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 68.348,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-03-58-12-961161_chatcmpl-3cda864c-507b-402e-a0ba-58bfbc5e0818",
          "traceId": "c5160c0e",
          "type": "GENERATION",
          "name": "c516_psg_gen_attempt#1",
          "startTime": "2026-02-24T01:58:12.961000+00:00",
          "endTime": "2026-02-24T01:58:23.468000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10507.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-58-26-623467_chatcmpl-48fff22c-072e-4af1-bf3f-5ddf0f92360c",
          "traceId": "c5160c0e",
          "type": "GENERATION",
          "name": "c516_psg_gen_attempt#2",
          "startTime": "2026-02-24T01:58:26.623000+00:00",
          "endTime": "2026-02-24T01:58:36.984000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10361.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-58-40-168929_chatcmpl-ebad1d25-30a1-4bbb-990a-8f3f52bec8fa",
          "traceId": "c5160c0e",
          "type": "GENERATION",
          "name": "c516_psg_gen_attempt#3",
          "startTime": "2026-02-24T01:58:40.168000+00:00",
          "endTime": "2026-02-24T01:58:50.472000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10304.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-58-53-588446_chatcmpl-becde745-9c77-4a7c-9eff-53772d16f4ca",
          "traceId": "c5160c0e",
          "type": "GENERATION",
          "name": "c516_psg_gen_attempt#4",
          "startTime": "2026-02-24T01:58:53.588000+00:00",
          "endTime": "2026-02-24T01:59:03.889000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10301.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-59-07-850435_chatcmpl-4f2d3ebf-1983-446d-b9eb-25326a0d90a0",
          "traceId": "c5160c0e",
          "type": "GENERATION",
          "name": "c516_psg_gen_attempt#5",
          "startTime": "2026-02-24T01:59:07.850000+00:00",
          "endTime": "2026-02-24T01:59:18.144000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10294.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "feed001b-5bdb-4c15-8fa0-f6c70efa13c3",
          "traceId": "c5160c0e",
          "type": "SPAN",
          "name": "error_c5_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T01:59:21.309000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 03:59:18.492551: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 03:59:18.496419: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 03:59:18.508172: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 03:59:18.527874: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 03:59:18.533614: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 03:59:18.547287: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 03:59:19.364588: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224035918_psg_phi4:latest/tmp_20260224035918_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224035918_psg_phi4:latest/tmp_20260224035918_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T01:58:13.471Z",
      "updatedAt": "2026-02-24T01:59:26.594Z"
    },
    {
      "id": "5aa97210",
      "timestamp": "2026-02-24T01:55:55.498000+00:00",
      "name": "5aa9_py_sketch_generator",
      "input": null,
      "output": {
        "status": "failed",
        "last_code": "import cv2\nimport numpy as np\nimport tensorflow as tf\n\n# Configuration parameters\nmodel_path = 'models/ssd-mobilenet_v1/detect.tflite'\nlabel_path = 'models/ssd-mobilenet_v1/labelmap.txt'\ninput_path = 'data/object_detection/sheeps.mp4'\noutput_path = 'results/object_detection/test_results/sheeps_detections.mp4'\nconfidence_threshold = 0.5\n\n# Load labels\nwith open(label_path, 'r') as f:\n    labels = [line.strip() for line in f.readlines()]\n\n# Load TFLite model and allocate tensors\ninterpreter = tf.lite.Interpreter(model_path=model_path)\ninterpreter.allocate_tensors()\n\n# Get input and output details\ninput_details = interpreter.get_input_details()\noutput_details = interpreter.get_output_details()\n\n# Open video file\ncap = cv2.VideoCapture(input_path)\nframe_width = int(cap.get(cv2.CAP_PROP_FRAME_WIDTH))\nframe_height = int(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))\nfps = cap.get(cv2.CAP_PROP_FPS)\n\n# Define the codec and create VideoWriter object\nfourcc = cv2.VideoWriter_fourcc(*'mp4v')\nout = cv2.VideoWriter(output_path, fourcc, fps, (frame_width, frame_height))\n\ndef detect_objects(frame):\n    # Preprocess the image\n    input_shape = input_details[0]['shape']\n    frame_resized = cv2.resize(frame, (input_shape[1], input_shape[2]))\n    input_data = np.expand_dims(frame_resized, axis=0).astype(np.float32)\n\n    # Set the tensor to point to the input data to be inferred\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n\n    # Run inference\n    interpreter.invoke()\n\n    # Retrieve detection results\n    boxes = interpreter.get_tensor(output_details[0]['index'])[0]  # Bounding box coordinates of detected objects\n    classes = interpreter.get_tensor(output_details[1]['index'])[0]  # Class index of detected objects\n    scores = interpreter.get_tensor(output_details[2]['index'])[0]  # Confidence of detected objects\n\n    return boxes, classes, scores\n\ndef draw_detections(frame, boxes, classes, scores):\n    for i in range(len(scores)):\n        if scores[i] > confidence_threshold:\n            ymin, xmin, ymax, xmax = boxes[i]\n            (left, right, top, bottom) = (xmin * frame.shape[1], xmax * frame.shape[1],\n                                          ymin * frame.shape[0], ymax * frame.shape[0])\n            cv2.rectangle(frame, (int(left), int(top)), (int(right), int(bottom)), (0, 255, 0), 2)\n            label = f'{labels[int(classes[i])]}: {scores[i]:.2f}'\n            cv2.putText(frame, label, (int(left), int(top) - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)\n\nwhile cap.isOpened():\n    ret, frame = cap.read()\n    if not ret:\n        break\n\n    boxes, classes, scores = detect_objects(frame)\n    draw_detections(frame, boxes, classes, scores)\n\n    out.write(frame)\n\ncap.release()\nout.release()\n\n# Note: Calculating mAP is a complex task and typically requires ground truth data for comparison.\n# This script does not include mAP calculation as it requires additional setup and data.",
        "last_error": "Max retries reached with failure. Last error from execution: 2026-02-24 03:57:43.826342: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 03:57:43.829989: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 03:57:43.843594: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 03:57:43.863612: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 03:57:43.870273: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 03:57:43.886239: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 03:57:44.752172: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224035743_psg_phi4:latest/tmp_20260224035743_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224035743_psg_phi4:latest/tmp_20260224035743_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n"
      },
      "session_id": "phi4_9bfa_psg_batch",
      "metadata": {
        "num_run": 12
      },
      "tags": [
        "benchmark",
        "phi4:latest",
        "py_sketch_generator"
      ],
      "latency": 111.25,
      "total_cost": 0.0,
      "observations": [
        {
          "id": "time-03-55-55-499524_chatcmpl-13529593-00c5-48d7-a27a-ea2943210c8d",
          "traceId": "5aa97210",
          "type": "GENERATION",
          "name": "5aa9_psg_gen_attempt#1",
          "startTime": "2026-02-24T01:55:55.499000+00:00",
          "endTime": "2026-02-24T01:56:22.041000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 26542.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-56-49-381543_chatcmpl-86b75ba0-89bc-456b-840a-ec1fcd1bc920",
          "traceId": "5aa97210",
          "type": "GENERATION",
          "name": "5aa9_psg_gen_attempt#2",
          "startTime": "2026-02-24T01:56:49.381000+00:00",
          "endTime": "2026-02-24T01:56:59.686000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10305.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-57-05-862685_chatcmpl-89febe04-4800-48cc-9a04-5c0343b7caaf",
          "traceId": "5aa97210",
          "type": "GENERATION",
          "name": "5aa9_psg_gen_attempt#3",
          "startTime": "2026-02-24T01:57:05.862000+00:00",
          "endTime": "2026-02-24T01:57:16.184000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10322.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-57-19-387386_chatcmpl-1e53efd7-aa68-4196-83b3-3bd48e5d64c1",
          "traceId": "5aa97210",
          "type": "GENERATION",
          "name": "5aa9_psg_gen_attempt#4",
          "startTime": "2026-02-24T01:57:19.387000+00:00",
          "endTime": "2026-02-24T01:57:29.687000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10300.0,
          "promptTokens": 180,
          "completionTokens": 791,
          "costDetails": {},
          "totalTokens": 971,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "time-03-57-32-824664_chatcmpl-ea8fd2ce-8ce1-40dd-b346-ebe849111e26",
          "traceId": "5aa97210",
          "type": "GENERATION",
          "name": "5aa9_psg_gen_attempt#5",
          "startTime": "2026-02-24T01:57:32.824000+00:00",
          "endTime": "2026-02-24T01:57:43.146000+00:00",
          "model": "phi4:latest",
          "modelParameters": {
            "temperature": "0.1",
            "top_p": "0.3"
          },
          "level": "DEFAULT",
          "calculatedTotalCost": 0.0,
          "latency": 10322.0,
          "promptTokens": 180,
          "completionTokens": 792,
          "costDetails": {},
          "totalTokens": 972,
          "environment": "default",
          "statusMessage": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null
        },
        {
          "id": "9f71e0be-6e17-489c-a400-e79bc7179ccd",
          "traceId": "5aa97210",
          "type": "SPAN",
          "name": "error_5a_psg_failure_signal_py_sketch_generator",
          "startTime": "2026-02-24T01:57:46.749000+00:00",
          "level": "ERROR",
          "statusMessage": "Failed. Last error: Max retries reached with failure. Last error from execution: 2026-02-24 03:57:43.826342: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 03:57:43.829989: I external/local_xla/xla/tsl/cuda/cudart_stub.cc:32] Could not find cuda drivers on your machine, GPU will not be used.\n2026-02-24 03:57:43.843594: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n2026-02-24 03:57:43.863612: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n2026-02-24 03:57:43.870273: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n2026-02-24 03:57:43.886239: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\nTo enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n2026-02-24 03:57:44.752172: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\nINFO: Created TensorFlow Lite XNNPACK delegate for CPU.\nTraceback (most recent call last):\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224035743_psg_phi4:latest/tmp_20260224035743_psg_phi4:latest.py\", line 68, in <module>\n    boxes, classes, scores = detect_objects(frame)\n  File \"/home/wuguangh/Projects/tinyml-autopilot/results/object_detection/sketches/tmp_20260224035743_psg_phi4:latest/tmp_20260224035743_psg_phi4:latest.py\", line 41, in detect_objects\n    interpreter.set_tensor(input_details[0]['index'], input_data)\n  File \"/home/wuguangh/.conda/envs/tinyml/lib/python3.10/site-packages/tensorflow/lite/python/interpreter.py\", line 732, in set_tensor\n    self._interpreter.SetTensor(tensor_index, value)\nValueError: Cannot set tensor: Got value of type FLOAT32 but expected type UINT8 for input 175, name: normalized_input_image_tensor \n",
          "calculatedTotalCost": 0.0,
          "promptTokens": 0,
          "completionTokens": 0,
          "costDetails": {},
          "totalTokens": 0,
          "environment": "default",
          "endTime": null,
          "model": null,
          "modelParameters": null,
          "calculatedInputCost": null,
          "calculatedOutputCost": null,
          "latency": null
        }
      ],
      "environment": "default",
      "createdAt": "2026-02-24T01:55:56.010Z",
      "updatedAt": "2026-02-24T01:57:52.249Z"
    }
  ],
  "meta": {
    "total_items": 30
  }
}